<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OscProb: OscProb::PremModel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OscProb
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceOscProb.html">OscProb</a></li><li class="navelem"><a class="el" href="classOscProb_1_1PremModel.html">PremModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="classOscProb_1_1PremModel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OscProb::PremModel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements an earth model with spherical shells.  
 <a href="classOscProb_1_1PremModel.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="PremModel_8h_source.html">PremModel.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OscProb::PremModel:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classOscProb_1_1PremModel.png" usemap="#OscProb::PremModel_map" alt=""/>
  <map id="OscProb::PremModel_map" name="OscProb::PremModel_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a959f8da5c78881b950bd647b67c1ef9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a959f8da5c78881b950bd647b67c1ef9b">PremModel</a> (std::string filename=&quot;&quot;)</td></tr>
<tr class="memdesc:a959f8da5c78881b950bd647b67c1ef9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a959f8da5c78881b950bd647b67c1ef9b">More...</a><br /></td></tr>
<tr class="separator:a959f8da5c78881b950bd647b67c1ef9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac484ca4e607f2b0fc6f599358cb95fb"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#aac484ca4e607f2b0fc6f599358cb95fb">~PremModel</a> ()</td></tr>
<tr class="memdesc:aac484ca4e607f2b0fc6f599358cb95fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#aac484ca4e607f2b0fc6f599358cb95fb">More...</a><br /></td></tr>
<tr class="separator:aac484ca4e607f2b0fc6f599358cb95fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69162cc5e3c8b7c1b8a85571ff2063b"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ac69162cc5e3c8b7c1b8a85571ff2063b">FillPath</a> (double cosT)</td></tr>
<tr class="memdesc:ac69162cc5e3c8b7c1b8a85571ff2063b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the path sequence in a vector.  <a href="#ac69162cc5e3c8b7c1b8a85571ff2063b">More...</a><br /></td></tr>
<tr class="separator:ac69162cc5e3c8b7c1b8a85571ff2063b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe7a5df260cba3923f5cbcb8ab2f03f"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">OscProb::NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#adbe7a5df260cba3923f5cbcb8ab2f03f">GetNuPath</a> ()</td></tr>
<tr class="memdesc:adbe7a5df260cba3923f5cbcb8ab2f03f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current neutrino path sequence.  <a href="#adbe7a5df260cba3923f5cbcb8ab2f03f">More...</a><br /></td></tr>
<tr class="separator:adbe7a5df260cba3923f5cbcb8ab2f03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b6f83f2e9b7087e8faad1f19f00ebd5"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">OscProb::NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a5b6f83f2e9b7087e8faad1f19f00ebd5">GetMergedPaths</a> (double prec=0.25)</td></tr>
<tr class="memdesc:a5b6f83f2e9b7087e8faad1f19f00ebd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get merged path sequence in a vector.  <a href="#a5b6f83f2e9b7087e8faad1f19f00ebd5">More...</a><br /></td></tr>
<tr class="separator:a5b6f83f2e9b7087e8faad1f19f00ebd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae258b41cca80631e3041f0421b25afeb"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ae258b41cca80631e3041f0421b25afeb">GetTotalL</a> (double cosT)</td></tr>
<tr class="memdesc:ae258b41cca80631e3041f0421b25afeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total baseline for a given cosTheta.  <a href="#ae258b41cca80631e3041f0421b25afeb">More...</a><br /></td></tr>
<tr class="separator:ae258b41cca80631e3041f0421b25afeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5328474bdbb703eb4c9d4df49999cda6"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a5328474bdbb703eb4c9d4df49999cda6">GetCosT</a> (double L)</td></tr>
<tr class="memdesc:a5328474bdbb703eb4c9d4df49999cda6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cosTheta for a given total baseline.  <a href="#a5328474bdbb703eb4c9d4df49999cda6">More...</a><br /></td></tr>
<tr class="separator:a5328474bdbb703eb4c9d4df49999cda6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9887d1af4b3c02925fe3228349f593d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ac9887d1af4b3c02925fe3228349f593d">SetLayerZoA</a> (int layer, double zoa)</td></tr>
<tr class="memdesc:ac9887d1af4b3c02925fe3228349f593d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Z/A of all layers of a given type.  <a href="#ac9887d1af4b3c02925fe3228349f593d">More...</a><br /></td></tr>
<tr class="separator:ac9887d1af4b3c02925fe3228349f593d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b8392d1b00560c6322bf8707c304f6"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#af1b8392d1b00560c6322bf8707c304f6">GetLayerZoA</a> (int layer)</td></tr>
<tr class="memdesc:af1b8392d1b00560c6322bf8707c304f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Z/A of all layers of a given type.  <a href="#af1b8392d1b00560c6322bf8707c304f6">More...</a><br /></td></tr>
<tr class="separator:af1b8392d1b00560c6322bf8707c304f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095bd601f6cd91926de9928e96ea7751"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a095bd601f6cd91926de9928e96ea7751">SetTopLayerSize</a> (double thick)</td></tr>
<tr class="memdesc:a095bd601f6cd91926de9928e96ea7751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the outermost layer thickness in km.  <a href="#a095bd601f6cd91926de9928e96ea7751">More...</a><br /></td></tr>
<tr class="separator:a095bd601f6cd91926de9928e96ea7751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6363a5e711dd8b0d2e684677e585b293"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a6363a5e711dd8b0d2e684677e585b293">LoadModel</a> (std::string filename)</td></tr>
<tr class="memdesc:a6363a5e711dd8b0d2e684677e585b293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load an earth model from a file.  <a href="#a6363a5e711dd8b0d2e684677e585b293">More...</a><br /></td></tr>
<tr class="separator:a6363a5e711dd8b0d2e684677e585b293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b314e97ed9b92931e08ada0c0947eb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a55b314e97ed9b92931e08ada0c0947eb">SetDetPos</a> (double pos)</td></tr>
<tr class="memdesc:a55b314e97ed9b92931e08ada0c0947eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the detector position in km.  <a href="#a55b314e97ed9b92931e08ada0c0947eb">More...</a><br /></td></tr>
<tr class="separator:a55b314e97ed9b92931e08ada0c0947eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4feeccc7027253f5c2e2493098145ca"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1PremLayer.html">OscProb::PremLayer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ae4feeccc7027253f5c2e2493098145ca">GetPremLayers</a> ()</td></tr>
<tr class="memdesc:ae4feeccc7027253f5c2e2493098145ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the set of earth layers.  <a href="#ae4feeccc7027253f5c2e2493098145ca">More...</a><br /></td></tr>
<tr class="separator:ae4feeccc7027253f5c2e2493098145ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5496d6d5bafcf7740c60838d3eee7b3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ac5496d6d5bafcf7740c60838d3eee7b3">SetRemoveSmallPaths</a> (bool rp=true)</td></tr>
<tr class="memdesc:ac5496d6d5bafcf7740c60838d3eee7b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set tag to remove small paths.  <a href="#ac5496d6d5bafcf7740c60838d3eee7b3">More...</a><br /></td></tr>
<tr class="separator:ac5496d6d5bafcf7740c60838d3eee7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aaead53a9385bda9b0219fd051d0cdd11"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#aaead53a9385bda9b0219fd051d0cdd11">ClearModel</a> ()</td></tr>
<tr class="memdesc:aaead53a9385bda9b0219fd051d0cdd11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear the earth model information.  <a href="#aaead53a9385bda9b0219fd051d0cdd11">More...</a><br /></td></tr>
<tr class="separator:aaead53a9385bda9b0219fd051d0cdd11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c337b84138adc46ee4dd002e9262d2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a08c337b84138adc46ee4dd002e9262d2">AddLayer</a> (double radius, double density, double zoa, double layer)</td></tr>
<tr class="memdesc:a08c337b84138adc46ee4dd002e9262d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a layer to the model.  <a href="#a08c337b84138adc46ee4dd002e9262d2">More...</a><br /></td></tr>
<tr class="separator:a08c337b84138adc46ee4dd002e9262d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca013f7ac5494282834048786a0e07a6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#aca013f7ac5494282834048786a0e07a6">AddPath</a> (double length, <a class="el" href="structOscProb_1_1PremLayer.html">PremLayer</a> pl)</td></tr>
<tr class="memdesc:aca013f7ac5494282834048786a0e07a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a path segment to the sequence.  <a href="#aca013f7ac5494282834048786a0e07a6">More...</a><br /></td></tr>
<tr class="separator:aca013f7ac5494282834048786a0e07a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a1d78e29217bb0dd00ae3bd96d22b69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a9a1d78e29217bb0dd00ae3bd96d22b69">ClassDef</a> (<a class="el" href="classOscProb_1_1PremModel.html">PremModel</a>, 1)</td></tr>
<tr class="separator:a9a1d78e29217bb0dd00ae3bd96d22b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a19a9a3b23ec154ad7a29f92b74aa5bc6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structOscProb_1_1PremLayer.html">OscProb::PremLayer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a></td></tr>
<tr class="memdesc:a19a9a3b23ec154ad7a29f92b74aa5bc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The layers in the earth model.  <a href="#a19a9a3b23ec154ad7a29f92b74aa5bc6">More...</a><br /></td></tr>
<tr class="separator:a19a9a3b23ec154ad7a29f92b74aa5bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3c77e35798d664853157013c90ad2b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">OscProb::NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a></td></tr>
<tr class="memdesc:aaf3c77e35798d664853157013c90ad2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current neutrino path sequence.  <a href="#aaf3c77e35798d664853157013c90ad2b">More...</a><br /></td></tr>
<tr class="separator:aaf3c77e35798d664853157013c90ad2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb68506493666349f418b893a996185"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a></td></tr>
<tr class="memdesc:a4fb68506493666349f418b893a996185"><td class="mdescLeft">&#160;</td><td class="mdescRight">The layer index of the detector.  <a href="#a4fb68506493666349f418b893a996185">More...</a><br /></td></tr>
<tr class="separator:a4fb68506493666349f418b893a996185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12ea0343cd11b9233ffd20ab5e620c7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">fDetPos</a></td></tr>
<tr class="memdesc:ab12ea0343cd11b9233ffd20ab5e620c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The radius where the detector lives.  <a href="#ab12ea0343cd11b9233ffd20ab5e620c7">More...</a><br /></td></tr>
<tr class="separator:ab12ea0343cd11b9233ffd20ab5e620c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3973df6f5f2ff219cd2f865b31aacfd2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">fRemoveSmallPaths</a></td></tr>
<tr class="memdesc:a3973df6f5f2ff219cd2f865b31aacfd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tag whether to merge small paths.  <a href="#a3973df6f5f2ff219cd2f865b31aacfd2">More...</a><br /></td></tr>
<tr class="separator:a3973df6f5f2ff219cd2f865b31aacfd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a8ad1335ebe80ee1cd1cdf59d774ab34b"><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1PremModel.html#a8ad1335ebe80ee1cd1cdf59d774ab34b">DET_TOL</a> = 0.2</td></tr>
<tr class="memdesc:a8ad1335ebe80ee1cd1cdf59d774ab34b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The detector position tolerance near boundaries.  <a href="#a8ad1335ebe80ee1cd1cdf59d774ab34b">More...</a><br /></td></tr>
<tr class="separator:a8ad1335ebe80ee1cd1cdf59d774ab34b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a spherically symmetric model of the earth using <a class="el" href="structOscProb_1_1PremLayer.html" title="A struct representing a spherical shell of matter for earth models. ">PremLayer</a>'s to store spherical shells with different properties.</p>
<p>The class is then able to produce path sequences through the different earth layers as a function of the cosine of the zenith angle with respect to the detector.</p>
<p>The detector can be positioned at any radius within the model and the path sequences will take into account the fact that some layers are above the detector.</p>
<p>By default this implements the model stored in PremTables/prem_default.txt with the detector at the bottom of the ocean layer (radius = 6368 km).</p>
<p>This class inherits from TObject and can be saved in ROOT files.</p>
<dl class="section author"><dt>Author</dt><dd>coelho@lal.in2p3.fr </dd></dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00037">37</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a959f8da5c78881b950bd647b67c1ef9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a959f8da5c78881b950bd647b67c1ef9b">&#9670;&nbsp;</a></span>PremModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PremModel::PremModel </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor.</p>
<p>By default this implements the model stored in PremTables/prem_default.txt with the detector at the bottom of the ocean layer (radius = 6368 km).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>- The txt file containing a table of earth layers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00035">35</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00064">SetDetPos()</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                    :</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a>(0), <a class="code" href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">fRemoveSmallPaths</a>(<span class="keyword">false</span>)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a55b314e97ed9b92931e08ada0c0947eb">SetDetPos</a>(6368);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a6363a5e711dd8b0d2e684677e585b293">LoadModel</a>(filename);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a3973df6f5f2ff219cd2f865b31aacfd2"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">OscProb::PremModel::fRemoveSmallPaths</a></div><div class="ttdeci">bool fRemoveSmallPaths</div><div class="ttdoc">Tag whether to merge small paths. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00082">PremModel.h:82</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a6363a5e711dd8b0d2e684677e585b293"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a6363a5e711dd8b0d2e684677e585b293">OscProb::PremModel::LoadModel</a></div><div class="ttdeci">virtual void LoadModel(std::string filename)</div><div class="ttdoc">Load an earth model from a file. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8cxx_source.html#l00125">PremModel.cxx:125</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a55b314e97ed9b92931e08ada0c0947eb"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a55b314e97ed9b92931e08ada0c0947eb">OscProb::PremModel::SetDetPos</a></div><div class="ttdeci">virtual void SetDetPos(double pos)</div><div class="ttdoc">Set the detector position in km. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8cxx_source.html#l00064">PremModel.cxx:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac484ca4e607f2b0fc6f599358cb95fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac484ca4e607f2b0fc6f599358cb95fb">&#9670;&nbsp;</a></span>~PremModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PremModel::~PremModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Nothing to clean. </p>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00048">48</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a08c337b84138adc46ee4dd002e9262d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c337b84138adc46ee4dd002e9262d2">&#9670;&nbsp;</a></span>AddLayer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::AddLayer </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>layer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a layer to the earth model.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">radius</td><td>- The outer radius of the layer in km </td></tr>
    <tr><td class="paramname">density</td><td>- The density of the layer in g/cm^3 </td></tr>
    <tr><td class="paramname">zoa</td><td>- The effective Z/A value of the layer </td></tr>
    <tr><td class="paramname">layer</td><td>- An index to identify the matter type (e.g. earth inner core) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00105">105</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.push_back( <a class="code" href="structOscProb_1_1PremLayer.html">PremLayer</a>(radius, density, zoa, layer) );</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div><div class="ttc" id="structOscProb_1_1PremLayer_html"><div class="ttname"><a href="structOscProb_1_1PremLayer.html">OscProb::PremLayer</a></div><div class="ttdoc">A struct representing a spherical shell of matter for earth models. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00083">NuPath.h:83</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca013f7ac5494282834048786a0e07a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca013f7ac5494282834048786a0e07a6">&#9670;&nbsp;</a></span>AddPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::AddPath </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1PremLayer.html">PremLayer</a>&#160;</td>
          <td class="paramname"><em>pl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a path segment to the sequence.</p>
<p>For a given <a class="el" href="structOscProb_1_1PremLayer.html" title="A struct representing a spherical shell of matter for earth models. ">PremLayer</a>, adds a path of a given length in that material</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>- The length of the path segment in km </td></tr>
    <tr><td class="paramname">pl</td><td>- The layer we are crossing </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00336">336</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="NuPath_8h_source.html#l00126">OscProb::PremLayer::density</a>, <a class="el" href="PremModel_8h_source.html#l00077">fNuPath</a>, <a class="el" href="NuPath_8h_source.html#l00128">OscProb::PremLayer::layer</a>, and <a class="el" href="NuPath_8h_source.html#l00127">OscProb::PremLayer::zoa</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00358">FillPath()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>.push_back( <a class="code" href="structOscProb_1_1NuPath.html">NuPath</a>(length, pl.<a class="code" href="structOscProb_1_1PremLayer.html#aba2536cbdab87d0db33df47f95c4f2c3">density</a>, pl.<a class="code" href="structOscProb_1_1PremLayer.html#a8687a8169d786fca79908292d11077f5">zoa</a>, pl.<a class="code" href="structOscProb_1_1PremLayer.html#aca8d7df68e6f982155b68b7e6a7ef389">layer</a>) );</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="ttc" id="structOscProb_1_1PremLayer_html_a8687a8169d786fca79908292d11077f5"><div class="ttname"><a href="structOscProb_1_1PremLayer.html#a8687a8169d786fca79908292d11077f5">OscProb::PremLayer::zoa</a></div><div class="ttdeci">double zoa</div><div class="ttdoc">The effective Z/A value of the layer. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00127">NuPath.h:127</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_aaf3c77e35798d664853157013c90ad2b"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">OscProb::PremModel::fNuPath</a></div><div class="ttdeci">std::vector&lt; OscProb::NuPath &gt; fNuPath</div><div class="ttdoc">The current neutrino path sequence. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00077">PremModel.h:77</a></div></div>
<div class="ttc" id="structOscProb_1_1NuPath_html"><div class="ttname"><a href="structOscProb_1_1NuPath.html">OscProb::NuPath</a></div><div class="ttdoc">A struct representing a neutrino path segment. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00034">NuPath.h:34</a></div></div>
<div class="ttc" id="structOscProb_1_1PremLayer_html_aca8d7df68e6f982155b68b7e6a7ef389"><div class="ttname"><a href="structOscProb_1_1PremLayer.html#aca8d7df68e6f982155b68b7e6a7ef389">OscProb::PremLayer::layer</a></div><div class="ttdeci">int layer</div><div class="ttdoc">An index to identify the matter type. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00128">NuPath.h:128</a></div></div>
<div class="ttc" id="structOscProb_1_1PremLayer_html_aba2536cbdab87d0db33df47f95c4f2c3"><div class="ttname"><a href="structOscProb_1_1PremLayer.html#aba2536cbdab87d0db33df47f95c4f2c3">OscProb::PremLayer::density</a></div><div class="ttdeci">double density</div><div class="ttdoc">The density of the layer in g/cm^3. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00126">NuPath.h:126</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a1d78e29217bb0dd00ae3bd96d22b69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a1d78e29217bb0dd00ae3bd96d22b69">&#9670;&nbsp;</a></span>ClassDef()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OscProb::PremModel::ClassDef </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOscProb_1_1PremModel.html">PremModel</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaead53a9385bda9b0219fd051d0cdd11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaead53a9385bda9b0219fd051d0cdd11">&#9670;&nbsp;</a></span>ClearModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::ClearModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clear the earth model information. </p>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00088">88</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00079">fDetLayer</a>, and <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a> = 0;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.clear();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac69162cc5e3c8b7c1b8a85571ff2063b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69162cc5e3c8b7c1b8a85571ff2063b">&#9670;&nbsp;</a></span>FillPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PremModel::FillPath </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fill the path sequence in a vector.</p>
<p>This will start at the upper-most layer and find straight paths to the boundary of the next layer down. When reaching the inner-most layer in the given direction, the paths move back to outer layers until hitting the detector.</p>
<p>The path sequence is stored as an attribute and can be retrieved with the function GetNuPath.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cosT</td><td>- The cosine of the neutrino direction </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of path segments in the sequence </dd></dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00358">358</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8cxx_source.html#l00336">AddPath()</a>, <a class="el" href="PremModel_8h_source.html#l00079">fDetLayer</a>, <a class="el" href="PremModel_8h_source.html#l00077">fNuPath</a>, and <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// Clear current path sequence</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>.clear();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// Do nothing if cosine is unphysical</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span>(fabs(cosT) &gt; 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// Define the minimum path radius</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">double</span> minR = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[<a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a>].radius * sqrt(1 - cosT*cosT);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// Set the top layer index</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">int</span> toplayer = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.size() - 1;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// Find the inner-most crossed layer</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">int</span> minlayer = 0;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">while</span>(<a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[minlayer].radius &lt; minR) minlayer++;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Compute the number of path segments needed</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordtype">int</span> nsteps = toplayer - <a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span>(cosT &lt; 0) nsteps += 2*(fDetLayer - minlayer) + 1;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// Start at the top layer and go down</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">int</span> layer = toplayer;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">int</span> dl = -1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Loop over all path segments</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nsteps; i++){</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// Get square of the path length between this layer&#39;s</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// outer radius and  inner-most radius</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">double</span> L1 = pow(<a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[layer].radius,2) - minR*minR;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// If L1 is negative, outer radius is not crossed.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// This only happens if detector is at the top layer and the</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// neutrino is coming from above.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span>(L1 &lt; 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// Get square of the path length between this layer&#39;s</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// inner radius and  inner-most radius</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">double</span> L2 = -minR*minR;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span>(layer&gt;0) L2 += pow(<a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[layer-1].radius,2);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// If L2 is negative, inner radius is not crossed,</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// so set this as the minimum layer.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">bool</span> ismin = (L2&lt;=0 &amp;&amp; cosT &lt; 0);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// Store the path segment length</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">double</span> dL;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// If it&#39;s the minimum layer, connect two outer radius</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// crossing points. If not, compute difference between</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// inner and outer radius crossings.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span>(ismin)      dL = 2 * sqrt(L1);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(L2&gt;=0) dL = sqrt(L1) - sqrt(L2);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">else</span>           dL = sqrt(L1); <span class="comment">// This should never actually happen,</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                  <span class="comment">// but protect in case L2 is slightly</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                  <span class="comment">// negative when it should be zero.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                  <span class="comment">// e.g. arriving at the detector from above.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// Add this path segment to the sequence</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classOscProb_1_1PremModel.html#aca013f7ac5494282834048786a0e07a6">AddPath</a>(dL, <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[layer]);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// If we reached the inner-most layer,</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// start moving up again.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span>(ismin) dl = 1;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Move to next layer</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    layer += dl;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// Return the number of path segments</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>.size();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_aca013f7ac5494282834048786a0e07a6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aca013f7ac5494282834048786a0e07a6">OscProb::PremModel::AddPath</a></div><div class="ttdeci">virtual void AddPath(double length, PremLayer pl)</div><div class="ttdoc">Add a path segment to the sequence. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8cxx_source.html#l00336">PremModel.cxx:336</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_aaf3c77e35798d664853157013c90ad2b"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">OscProb::PremModel::fNuPath</a></div><div class="ttdeci">std::vector&lt; OscProb::NuPath &gt; fNuPath</div><div class="ttdoc">The current neutrino path sequence. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00077">PremModel.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5328474bdbb703eb4c9d4df49999cda6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5328474bdbb703eb4c9d4df49999cda6">&#9670;&nbsp;</a></span>GetCosT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PremModel::GetCosT </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the cosTheta for a given total baseline.</p>
<p>Given a baseline, find the direction of the neutrino. This could be useful for experiments with fixed baselines for example.</p>
<p>The baseline must be within the range of possible values in this earth model. Will return vertical neutrinos otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>- The total baseline of the neutrino </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00314">314</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00079">fDetLayer</a>, and <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">double</span> rAbove = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.back().radius;     <span class="comment">// Radius above detector</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">double</span> rBelow = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[<a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a>].radius; <span class="comment">// Radius below detector</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span>(L &lt; rAbove - rBelow) <span class="keywordflow">return</span>  1;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span>(L &gt; rAbove + rBelow) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> (rAbove*rAbove - rBelow*rBelow - L*L) / (2*rBelow*L);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af1b8392d1b00560c6322bf8707c304f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1b8392d1b00560c6322bf8707c304f6">&#9670;&nbsp;</a></span>GetLayerZoA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PremModel::GetLayerZoA </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the effective Z/A value for all layers of a given type, e.g. all outer-core layers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>- The index of the layer type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00220">220</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">int</span> nlayers = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.size();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// This check assumes the layer types are in increasing order</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span>(layer &gt; <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.back().layer){</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;ERROR: Not that many layer types&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Returning 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nlayers; i++){</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[i].layer != layer) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[i].zoa;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// End of vector reached without finding input type</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;ERROR: layer type not found&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;Returning 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b6f83f2e9b7087e8faad1f19f00ebd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b6f83f2e9b7087e8faad1f19f00ebd5">&#9670;&nbsp;</a></span>GetMergedPaths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt; PremModel::GetMergedPaths </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prec</em> = <code>0.25</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Merge similar paths to reduce number of steps</p>
<p>This method will merge consecutive paths and take their averages until it finds a large enough gap to start a new merged path.</p>
<p>The merged paths will be returned, and the original detailed path will not be changed and will stay stored as an attribute.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prec</td><td>- The precision to merge paths in g/cm^3 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The vector of merged path segments </dd></dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00449">449</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="NuPath_8cxx_source.html#l00027">OscProb::AvgPath()</a>, <a class="el" href="NuPath_8h_source.html#l00077">OscProb::NuPath::density</a>, <a class="el" href="PremModel_8h_source.html#l00077">fNuPath</a>, <a class="el" href="PremModel_8h_source.html#l00082">fRemoveSmallPaths</a>, <a class="el" href="NuPath_8cxx_source.html#l00088">OscProb::MergePaths()</a>, and <a class="el" href="NuPath_8h_source.html#l00078">OscProb::NuPath::zoa</a>.</p>
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                   {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// The output vector</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  vector&lt;NuPath&gt; mergedPath;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// Start with the first path</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="structOscProb_1_1NuPath.html">OscProb::NuPath</a> path = <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[0];</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// Track the total length</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordtype">double</span> totL = 0;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// Loop over all paths starting from second</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;<a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>.size(); i++){</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// If this path electron density is beyond the tolerance</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span>( fabs(path.<a class="code" href="structOscProb_1_1NuPath.html#a54ddd451db69bc54434de3cf18a117ca">density</a>*path.<a class="code" href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">zoa</a> - <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[i].density*<a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[i].zoa) &gt; prec*path.<a class="code" href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">zoa</a> ){</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">// Add merged path to vector</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      mergedPath.push_back(path);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">// Set this path as new merged path</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      path = <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[i];</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// If path is within tolerance</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="comment">// Merge the path with current merged path</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      path = <a class="code" href="namespaceOscProb.html#a999a7944bad8bc72d7ee9f56f81a210e">OscProb::AvgPath</a>(path, <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[i]);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Increment total length</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    totL += <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>[i].length;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }<span class="comment">// End of loop over paths</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// Add the final merged path to vector</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  mergedPath.push_back(path);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// If tag is true, remove small paths</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">fRemoveSmallPaths</a>){</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// Start at first path</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">int</span> k = 0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// While not at the end of vector</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">while</span>(k + 1 &lt; mergedPath.size()){</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">// If length is less than 1% of total</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span>(mergedPath[k].length &lt; 0.01*totL){</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// Merge path with following path</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        mergedPath = <a class="code" href="namespaceOscProb.html#a7c203d8583a34acf2ae90185ba45f866">MergePaths</a>(mergedPath, k, k+1);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">// If path is long enough skip it</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">else</span> k++;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }<span class="comment">// End of while loop</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }<span class="comment">// End of if statement</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// return the merged vector</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">return</span> mergedPath;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a3973df6f5f2ff219cd2f865b31aacfd2"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">OscProb::PremModel::fRemoveSmallPaths</a></div><div class="ttdeci">bool fRemoveSmallPaths</div><div class="ttdoc">Tag whether to merge small paths. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00082">PremModel.h:82</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_aaf3c77e35798d664853157013c90ad2b"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">OscProb::PremModel::fNuPath</a></div><div class="ttdeci">std::vector&lt; OscProb::NuPath &gt; fNuPath</div><div class="ttdoc">The current neutrino path sequence. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00077">PremModel.h:77</a></div></div>
<div class="ttc" id="structOscProb_1_1NuPath_html"><div class="ttname"><a href="structOscProb_1_1NuPath.html">OscProb::NuPath</a></div><div class="ttdoc">A struct representing a neutrino path segment. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00034">NuPath.h:34</a></div></div>
<div class="ttc" id="namespaceOscProb_html_a7c203d8583a34acf2ae90185ba45f866"><div class="ttname"><a href="namespaceOscProb.html#a7c203d8583a34acf2ae90185ba45f866">OscProb::MergePaths</a></div><div class="ttdeci">std::vector&lt; OscProb::NuPath &gt; MergePaths(std::vector&lt; OscProb::NuPath &gt; &amp;inputPath, int j, int k)</div><div class="ttdoc">Merge paths j and k in vector. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8cxx_source.html#l00088">NuPath.cxx:88</a></div></div>
<div class="ttc" id="structOscProb_1_1NuPath_html_af3213f3691ba83c6bc05f4a3490f6b31"><div class="ttname"><a href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">OscProb::NuPath::zoa</a></div><div class="ttdeci">double zoa</div><div class="ttdoc">The effective Z/A value of the path segment. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00078">NuPath.h:78</a></div></div>
<div class="ttc" id="structOscProb_1_1NuPath_html_a54ddd451db69bc54434de3cf18a117ca"><div class="ttname"><a href="structOscProb_1_1NuPath.html#a54ddd451db69bc54434de3cf18a117ca">OscProb::NuPath::density</a></div><div class="ttdeci">double density</div><div class="ttdoc">The density of the path segment in g/cm^3. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00077">NuPath.h:77</a></div></div>
<div class="ttc" id="namespaceOscProb_html_a999a7944bad8bc72d7ee9f56f81a210e"><div class="ttname"><a href="namespaceOscProb.html#a999a7944bad8bc72d7ee9f56f81a210e">OscProb::AvgPath</a></div><div class="ttdeci">OscProb::NuPath AvgPath(OscProb::NuPath &amp;p1, OscProb::NuPath &amp;p2)</div><div class="ttdoc">Get the average of two paths. </div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8cxx_source.html#l00027">NuPath.cxx:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe7a5df260cba3923f5cbcb8ab2f03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe7a5df260cba3923f5cbcb8ab2f03f">&#9670;&nbsp;</a></span>GetNuPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt; PremModel::GetNuPath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the current neutrino path sequence</p>
<p>The path needs to be filled for a given cosTheta before calling this function. </p>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00073">73</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00077">fNuPath</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">fNuPath</a>; }</div><div class="ttc" id="classOscProb_1_1PremModel_html_aaf3c77e35798d664853157013c90ad2b"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aaf3c77e35798d664853157013c90ad2b">OscProb::PremModel::fNuPath</a></div><div class="ttdeci">std::vector&lt; OscProb::NuPath &gt; fNuPath</div><div class="ttdoc">The current neutrino path sequence. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00077">PremModel.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4feeccc7027253f5c2e2493098145ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4feeccc7027253f5c2e2493098145ca">&#9670;&nbsp;</a></span>GetPremLayers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1PremLayer.html">PremLayer</a> &gt; PremModel::GetPremLayers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the set of earth layers</p>
<p>This returns the set of <a class="el" href="structOscProb_1_1PremLayer.html" title="A struct representing a spherical shell of matter for earth models. ">PremLayer</a>'s for this earth model and detector position. </p>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00082">82</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>; }</div><div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae258b41cca80631e3041f0421b25afeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae258b41cca80631e3041f0421b25afeb">&#9670;&nbsp;</a></span>GetTotalL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PremModel::GetTotalL </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the total baseline for a given cosTheta.</p>
<p>The total baseline contains both from above and below the detector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cosT</td><td>- The cosine of the neutrino direction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00288">288</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00079">fDetLayer</a>, and <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span>(fabs(cosT) &gt; 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">double</span> rAbove = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.back().radius;     <span class="comment">// Radius above detector</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordtype">double</span> rBelow = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[<a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a>].radius; <span class="comment">// Radius below detector</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">double</span> sinsqrT = 1 - cosT*cosT;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> -rBelow*cosT + sqrt(rAbove*rAbove - rBelow*rBelow*sinsqrT);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6363a5e711dd8b0d2e684677e585b293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6363a5e711dd8b0d2e684677e585b293">&#9670;&nbsp;</a></span>LoadModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::LoadModel </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Load an earth model from a file.</p>
<p>By default it loads the model stored in PremTables/prem_default.txt</p>
<p>The decision of whether to create a layer for the detector position is made in this function, so the detector position must be set before calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>- The txt file containing a table of earth layers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00125">125</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8cxx_source.html#l00105">AddLayer()</a>, <a class="el" href="PremModel_8cxx_source.html#l00088">ClearModel()</a>, <a class="el" href="PremModel_8h_source.html#l00084">DET_TOL</a>, <a class="el" href="PremModel_8h_source.html#l00079">fDetLayer</a>, <a class="el" href="PremModel_8h_source.html#l00080">fDetPos</a>, and <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00035">PremModel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Clear the current model</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#aaead53a9385bda9b0219fd051d0cdd11">ClearModel</a>();</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Use default if no file provided</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span>(filename == <span class="stringliteral">&quot;&quot;</span>){</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    filename = PREM_DEFAULT;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// Open the file</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  ifstream fin;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  fin.open(filename.c_str());</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span>(!fin){</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;ERROR: File &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// Variables for storing table rows</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordtype">float</span> radius, density, zoa, layer;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// Flag to mark we&#39;ve passed the detector</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">bool</span> crossed_det = <span class="keyword">false</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// Keep track of previous radius</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">double</span> rprev = 0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Loop over table rows</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">while</span>(fin &gt;&gt; radius &gt;&gt; density &gt;&gt; zoa &gt;&gt; layer){</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Radii must be ordered in model file</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span>(radius &lt;= rprev){</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;ERROR: Radii are not sorted in increasing order in the model file&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="classOscProb_1_1PremModel.html#aaead53a9385bda9b0219fd051d0cdd11">ClearModel</a>();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// See if we passed the detector and decide whether</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// to create a special layer for it</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span>(radius &gt; <a class="code" href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">fDetPos</a> - <a class="code" href="classOscProb_1_1PremModel.html#a8ad1335ebe80ee1cd1cdf59d774ab34b">DET_TOL</a> &amp;&amp; !crossed_det){</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      crossed_det = <span class="keyword">true</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">fDetLayer</a> = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.size();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// If detector is not near boundary, add a special layer</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">if</span>(radius &gt; <a class="code" href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">fDetPos</a> + <a class="code" href="classOscProb_1_1PremModel.html#a8ad1335ebe80ee1cd1cdf59d774ab34b">DET_TOL</a>){</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="classOscProb_1_1PremModel.html#a08c337b84138adc46ee4dd002e9262d2">AddLayer</a>(<a class="code" href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">fDetPos</a>, density, zoa, layer);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Add this layer to the model</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classOscProb_1_1PremModel.html#a08c337b84138adc46ee4dd002e9262d2">AddLayer</a>(radius, density, zoa, layer);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a8ad1335ebe80ee1cd1cdf59d774ab34b"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a8ad1335ebe80ee1cd1cdf59d774ab34b">OscProb::PremModel::DET_TOL</a></div><div class="ttdeci">static const double DET_TOL</div><div class="ttdoc">The detector position tolerance near boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00084">PremModel.h:84</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a4fb68506493666349f418b893a996185"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a4fb68506493666349f418b893a996185">OscProb::PremModel::fDetLayer</a></div><div class="ttdeci">int fDetLayer</div><div class="ttdoc">The layer index of the detector. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00079">PremModel.h:79</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_ab12ea0343cd11b9233ffd20ab5e620c7"><div class="ttname"><a href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">OscProb::PremModel::fDetPos</a></div><div class="ttdeci">double fDetPos</div><div class="ttdoc">The radius where the detector lives. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00080">PremModel.h:80</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_a08c337b84138adc46ee4dd002e9262d2"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a08c337b84138adc46ee4dd002e9262d2">OscProb::PremModel::AddLayer</a></div><div class="ttdeci">virtual void AddLayer(double radius, double density, double zoa, double layer)</div><div class="ttdoc">Add a layer to the model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8cxx_source.html#l00105">PremModel.cxx:105</a></div></div>
<div class="ttc" id="classOscProb_1_1PremModel_html_aaead53a9385bda9b0219fd051d0cdd11"><div class="ttname"><a href="classOscProb_1_1PremModel.html#aaead53a9385bda9b0219fd051d0cdd11">OscProb::PremModel::ClearModel</a></div><div class="ttdeci">virtual void ClearModel()</div><div class="ttdoc">Clear the earth model information. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8cxx_source.html#l00088">PremModel.cxx:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55b314e97ed9b92931e08ada0c0947eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55b314e97ed9b92931e08ada0c0947eb">&#9670;&nbsp;</a></span>SetDetPos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::SetDetPos </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the detector position in km.</p>
<p>If the position is within 200m of a layer boundary, the detector is considered to be on the boundary. If not, an extra boundary is inserted in the detector position to distinguish what parts of the earth are above and below the detector.</p>
<p>This must be done before loading the earth model file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>- The radius where the detector is in km </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00064">64</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00080">fDetPos</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00035">PremModel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{ <a class="code" href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">fDetPos</a> = pos; }</div><div class="ttc" id="classOscProb_1_1PremModel_html_ab12ea0343cd11b9233ffd20ab5e620c7"><div class="ttname"><a href="classOscProb_1_1PremModel.html#ab12ea0343cd11b9233ffd20ab5e620c7">OscProb::PremModel::fDetPos</a></div><div class="ttdeci">double fDetPos</div><div class="ttdoc">The radius where the detector lives. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00080">PremModel.h:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9887d1af4b3c02925fe3228349f593d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9887d1af4b3c02925fe3228349f593d">&#9670;&nbsp;</a></span>SetLayerZoA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::SetLayerZoA </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the effective Z/A value for all layers of a given type.</p>
<p>Use this to change the Z/A of indexed layer, e.g. all outer-core layers</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>- The index of the layer type </td></tr>
    <tr><td class="paramname">zoa</td><td>- The effective Z/A value to use </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00196">196</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">int</span> nlayers = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.size();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Loop over all layers and change the ones</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// with the given index</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nlayers; i++){</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[i].layer != layer) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[i].zoa = zoa;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5496d6d5bafcf7740c60838d3eee7b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5496d6d5bafcf7740c60838d3eee7b3">&#9670;&nbsp;</a></span>SetRemoveSmallPaths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::SetRemoveSmallPaths </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rp</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the boolean to tag whether to remove small paths when merging</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rp</td><td>- Boolean value to set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00523">523</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00082">fRemoveSmallPaths</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{ <a class="code" href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">fRemoveSmallPaths</a> = rp; }</div><div class="ttc" id="classOscProb_1_1PremModel_html_a3973df6f5f2ff219cd2f865b31aacfd2"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a3973df6f5f2ff219cd2f865b31aacfd2">OscProb::PremModel::fRemoveSmallPaths</a></div><div class="ttdeci">bool fRemoveSmallPaths</div><div class="ttdoc">Tag whether to merge small paths. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00082">PremModel.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a095bd601f6cd91926de9928e96ea7751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095bd601f6cd91926de9928e96ea7751">&#9670;&nbsp;</a></span>SetTopLayerSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PremModel::SetTopLayerSize </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thick</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the radius of the outermost layer of the model.</p>
<p>This usually corresponds to the atmosphere and is useful for computing oscillations with variable neutrino production height.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thick</td><td>- The thickness of the outer layer in km </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PremModel_8cxx_source.html#l00255">255</a> of file <a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a>.</p>

<p class="reference">References <a class="el" href="PremModel_8h_source.html#l00075">fPremLayers</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span>(thick &lt;= 0){</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Layer thickness should be positive. Do nothing.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">int</span> nlayers = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>.size();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span>(nlayers &lt; 1){</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;PremModel has no layers. Do nothing.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> bottomRadius;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span>(nlayers&gt;1) bottomRadius = <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[nlayers-2].radius;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">else</span>          bottomRadius = 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">double</span> topRadius = bottomRadius + thick;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">fPremLayers</a>[nlayers-1].radius = topRadius;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="ttc" id="classOscProb_1_1PremModel_html_a19a9a3b23ec154ad7a29f92b74aa5bc6"><div class="ttname"><a href="classOscProb_1_1PremModel.html#a19a9a3b23ec154ad7a29f92b74aa5bc6">OscProb::PremModel::fPremLayers</a></div><div class="ttdeci">std::vector&lt; OscProb::PremLayer &gt; fPremLayers</div><div class="ttdoc">The layers in the earth model. </div><div class="ttdef"><b>Definition:</b> <a href="PremModel_8h_source.html#l00075">PremModel.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8ad1335ebe80ee1cd1cdf59d774ab34b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ad1335ebe80ee1cd1cdf59d774ab34b">&#9670;&nbsp;</a></span>DET_TOL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double PremModel::DET_TOL = 0.2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Define the tolerance of the detector around a boundary when considering whether to add a new layer for the detector position. </p>

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00084">84</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>.</p>

</div>
</div>
<a id="a4fb68506493666349f418b893a996185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb68506493666349f418b893a996185">&#9670;&nbsp;</a></span>fDetLayer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::PremModel::fDetLayer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00079">79</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00088">ClearModel()</a>, <a class="el" href="PremModel_8cxx_source.html#l00358">FillPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00314">GetCosT()</a>, <a class="el" href="PremModel_8cxx_source.html#l00288">GetTotalL()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>.</p>

</div>
</div>
<a id="ab12ea0343cd11b9233ffd20ab5e620c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab12ea0343cd11b9233ffd20ab5e620c7">&#9670;&nbsp;</a></span>fDetPos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::PremModel::fDetPos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00080">80</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00064">SetDetPos()</a>.</p>

</div>
</div>
<a id="aaf3c77e35798d664853157013c90ad2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3c77e35798d664853157013c90ad2b">&#9670;&nbsp;</a></span>fNuPath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structOscProb_1_1NuPath.html">OscProb::NuPath</a>&gt; OscProb::PremModel::fNuPath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00077">77</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00336">AddPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00358">FillPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00449">GetMergedPaths()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00073">GetNuPath()</a>.</p>

</div>
</div>
<a id="a19a9a3b23ec154ad7a29f92b74aa5bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a9a3b23ec154ad7a29f92b74aa5bc6">&#9670;&nbsp;</a></span>fPremLayers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structOscProb_1_1PremLayer.html">OscProb::PremLayer</a>&gt; OscProb::PremModel::fPremLayers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00075">75</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00105">AddLayer()</a>, <a class="el" href="PremModel_8cxx_source.html#l00088">ClearModel()</a>, <a class="el" href="PremModel_8cxx_source.html#l00358">FillPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00314">GetCosT()</a>, <a class="el" href="PremModel_8cxx_source.html#l00220">GetLayerZoA()</a>, <a class="el" href="PremModel_8cxx_source.html#l00082">GetPremLayers()</a>, <a class="el" href="PremModel_8cxx_source.html#l00288">GetTotalL()</a>, <a class="el" href="PremModel_8cxx_source.html#l00125">LoadModel()</a>, <a class="el" href="PremModel_8cxx_source.html#l00196">SetLayerZoA()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00255">SetTopLayerSize()</a>.</p>

</div>
</div>
<a id="a3973df6f5f2ff219cd2f865b31aacfd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3973df6f5f2ff219cd2f865b31aacfd2">&#9670;&nbsp;</a></span>fRemoveSmallPaths</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool OscProb::PremModel::fRemoveSmallPaths</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PremModel_8h_source.html#l00082">82</a> of file <a class="el" href="PremModel_8h_source.html">PremModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00449">GetMergedPaths()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00523">SetRemoveSmallPaths()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/jcoelho/testOscProb/<a class="el" href="PremModel_8h_source.html">PremModel.h</a></li>
<li>/home/jcoelho/testOscProb/<a class="el" href="PremModel_8cxx_source.html">PremModel.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
