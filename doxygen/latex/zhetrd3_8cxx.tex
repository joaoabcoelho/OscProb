\hypertarget{zhetrd3_8cxx}{}\section{/home/jcoelho/test\+Osc\+Prob/\+Matrix\+Decomp/zhetrd3.cxx File Reference}
\label{zhetrd3_8cxx}\index{/home/jcoelho/test\+Osc\+Prob/\+Matrix\+Decomp/zhetrd3.\+cxx@{/home/jcoelho/test\+Osc\+Prob/\+Matrix\+Decomp/zhetrd3.\+cxx}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$complex$>$}\newline
{\ttfamily \#include \char`\"{}zhetrd3.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(x)~((x)$\ast$(x))
\item 
\#define \hyperlink{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{S\+Q\+R\+\_\+\+A\+BS}(x)~(\hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(real(x)) + \hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(imag(x)))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{zhetrd3_8cxx_a85715cc89e71719fe52cf16892aa1a1d}{zhetrd3} (std\+::complex$<$ double $>$ A\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, std\+::complex$<$ double $>$ Q\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, double d\mbox{[}3\mbox{]}, double e\mbox{[}2\mbox{]})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}\label{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}} 
\index{zhetrd3.\+cxx@{zhetrd3.\+cxx}!S\+QR@{S\+QR}}
\index{S\+QR@{S\+QR}!zhetrd3.\+cxx@{zhetrd3.\+cxx}}
\subsubsection{\texorpdfstring{S\+QR}{SQR}}
{\footnotesize\ttfamily \#define S\+QR(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~((x)$\ast$(x))}



Definition at line 25 of file zhetrd3.\+cxx.

\mbox{\Hypertarget{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}\label{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}} 
\index{zhetrd3.\+cxx@{zhetrd3.\+cxx}!S\+Q\+R\+\_\+\+A\+BS@{S\+Q\+R\+\_\+\+A\+BS}}
\index{S\+Q\+R\+\_\+\+A\+BS@{S\+Q\+R\+\_\+\+A\+BS}!zhetrd3.\+cxx@{zhetrd3.\+cxx}}
\subsubsection{\texorpdfstring{S\+Q\+R\+\_\+\+A\+BS}{SQR\_ABS}}
{\footnotesize\ttfamily \#define S\+Q\+R\+\_\+\+A\+BS(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(\hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(real(x)) + \hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(imag(x)))}



Definition at line 26 of file zhetrd3.\+cxx.



Referenced by zhetrd3().



\subsection{Function Documentation}
\mbox{\Hypertarget{zhetrd3_8cxx_a85715cc89e71719fe52cf16892aa1a1d}\label{zhetrd3_8cxx_a85715cc89e71719fe52cf16892aa1a1d}} 
\index{zhetrd3.\+cxx@{zhetrd3.\+cxx}!zhetrd3@{zhetrd3}}
\index{zhetrd3@{zhetrd3}!zhetrd3.\+cxx@{zhetrd3.\+cxx}}
\subsubsection{\texorpdfstring{zhetrd3()}{zhetrd3()}}
{\footnotesize\ttfamily void zhetrd3 (\begin{DoxyParamCaption}\item[{std\+::complex$<$ double $>$}]{A\mbox{[}3\mbox{]}\mbox{[}3\mbox{]},  }\item[{std\+::complex$<$ double $>$}]{Q\mbox{[}3\mbox{]}\mbox{[}3\mbox{]},  }\item[{double}]{d\mbox{[}3\mbox{]},  }\item[{double}]{e\mbox{[}2\mbox{]} }\end{DoxyParamCaption})}



Definition at line 30 of file zhetrd3.\+cxx.



References S\+Q\+R\+\_\+\+A\+BS.



Referenced by zheevq3().


\begin{DoxyCode}
41 \{
42   \textcolor{keyword}{const} \textcolor{keywordtype}{int} n = 3;
43   std::complex<double> u[n], q[n];
44   std::complex<double> omega, f;
45   \textcolor{keywordtype}{double} K, h, g;
46   
47   \textcolor{comment}{// Initialize Q to the identitity matrix}
48 \textcolor{preprocessor}{#ifndef EVALS\_ONLY}
49   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i < n; i++)
50   \{
51     Q[i][i] = 1.0;
52     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j < i; j++)
53       Q[i][j] = Q[j][i] = 0.0;
54   \}
55 \textcolor{preprocessor}{#endif}
56 
57   \textcolor{comment}{// Bring first row and column to the desired form }
58   h = \hyperlink{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(A[0][1]) + \hyperlink{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(A[0][2]);
59   \textcolor{keywordflow}{if} (real(A[0][1]) > 0)
60     g = -sqrt(h);
61   \textcolor{keywordflow}{else}
62     g = sqrt(h);
63   e[0] = g;
64   f    = g * A[0][1];
65   u[1] = conj(A[0][1]) - g;
66   u[2] = conj(A[0][2]);
67   
68   omega = h - f;
69   \textcolor{keywordflow}{if} (real(omega) > 0.0)
70   \{
71     omega = 0.5 * (1.0 + conj(omega)/omega) / real(omega);
72     K = 0.0;
73     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i < n; i++)
74     \{
75       f    = conj(A[1][i]) * u[1] + A[i][2] * u[2];
76       q[i] = omega * f;                  \textcolor{comment}{// p}
77       K   += real(conj(u[i]) * f);      \textcolor{comment}{// u* A u}
78     \}
79     K *= 0.5 * \hyperlink{zhetrd3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(omega);
80 
81     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i < n; i++)
82       q[i] = q[i] - K * u[i];
83     
84     d[0] = real(A[0][0]);
85     d[1] = real(A[1][1]) - 2.0*real(q[1]*conj(u[1]));
86     d[2] = real(A[2][2]) - 2.0*real(q[2]*conj(u[2]));
87     
88     \textcolor{comment}{// Store inverse Householder transformation in Q}
89 \textcolor{preprocessor}{#ifndef EVALS\_ONLY}
90     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=1; j < n; j++)
91     \{
92       f = omega * conj(u[j]);
93       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i < n; i++)
94         Q[i][j] = Q[i][j] - f*u[i];
95     \}
96 \textcolor{preprocessor}{#endif}
97 
98     \textcolor{comment}{// Calculate updated A[1][2] and store it in f}
99     f = A[1][2] - q[1]*conj(u[2]) - u[1]*conj(q[2]);
100   \}
101   \textcolor{keywordflow}{else}
102   \{
103     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i < n; i++)
104       d[i] = real(A[i][i]);
105     f = A[1][2];
106   \}
107 
108   \textcolor{comment}{// Make (23) element real}
109   e[1] = abs(f);
110 \textcolor{preprocessor}{#ifndef EVALS\_ONLY}
111   \textcolor{keywordflow}{if} (e[1] != 0.0)
112   \{
113     f = conj(f) / e[1];
114     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i < n; i++)
115       Q[i][n-1] = Q[i][n-1] * f;
116   \}
117 \textcolor{preprocessor}{#endif}
118 \}
\end{DoxyCode}
