\hypertarget{classOscProb_1_1PremModel}{}\section{Osc\+Prob\+:\+:Prem\+Model Class Reference}
\label{classOscProb_1_1PremModel}\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}


Implements an earth model with spherical shells.  




{\ttfamily \#include $<$Prem\+Model.\+h$>$}

Inheritance diagram for Osc\+Prob\+:\+:Prem\+Model\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classOscProb_1_1PremModel}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classOscProb_1_1PremModel_a959f8da5c78881b950bd647b67c1ef9b}{Prem\+Model} (std\+::string filename=\char`\"{}\char`\"{})
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classOscProb_1_1PremModel_aac484ca4e607f2b0fc6f599358cb95fb}{$\sim$\+Prem\+Model} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
virtual int \hyperlink{classOscProb_1_1PremModel_ac69162cc5e3c8b7c1b8a85571ff2063b}{Fill\+Path} (double cosT)
\begin{DoxyCompactList}\small\item\em Fill the path sequence in a vector. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PremModel_adbe7a5df260cba3923f5cbcb8ab2f03f}{Get\+Nu\+Path} ()
\begin{DoxyCompactList}\small\item\em Get the current neutrino path sequence. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PremModel_a5b6f83f2e9b7087e8faad1f19f00ebd5}{Get\+Merged\+Paths} (double prec=0.\+25)
\begin{DoxyCompactList}\small\item\em Get merged path sequence in a vector. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PremModel_ae258b41cca80631e3041f0421b25afeb}{Get\+TotalL} (double cosT)
\begin{DoxyCompactList}\small\item\em Get the total baseline for a given cos\+Theta. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PremModel_a5328474bdbb703eb4c9d4df49999cda6}{Get\+CosT} (double L)
\begin{DoxyCompactList}\small\item\em Get the cos\+Theta for a given total baseline. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_ac9887d1af4b3c02925fe3228349f593d}{Set\+Layer\+ZoA} (int layer, double zoa)
\begin{DoxyCompactList}\small\item\em Set Z/A of all layers of a given type. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PremModel_af1b8392d1b00560c6322bf8707c304f6}{Get\+Layer\+ZoA} (int layer)
\begin{DoxyCompactList}\small\item\em Get Z/A of all layers of a given type. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_a095bd601f6cd91926de9928e96ea7751}{Set\+Top\+Layer\+Size} (double thick)
\begin{DoxyCompactList}\small\item\em Set the outermost layer thickness in km. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_a6363a5e711dd8b0d2e684677e585b293}{Load\+Model} (std\+::string filename)
\begin{DoxyCompactList}\small\item\em Load an earth model from a file. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_a55b314e97ed9b92931e08ada0c0947eb}{Set\+Det\+Pos} (double pos)
\begin{DoxyCompactList}\small\item\em Set the detector position in km. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1PremLayer}{Osc\+Prob\+::\+Prem\+Layer} $>$ \hyperlink{classOscProb_1_1PremModel_ae4feeccc7027253f5c2e2493098145ca}{Get\+Prem\+Layers} ()
\begin{DoxyCompactList}\small\item\em Get the set of earth layers. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_ac5496d6d5bafcf7740c60838d3eee7b3}{Set\+Remove\+Small\+Paths} (bool rp=true)
\begin{DoxyCompactList}\small\item\em Set tag to remove small paths. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classOscProb_1_1PremModel_aaead53a9385bda9b0219fd051d0cdd11}{Clear\+Model} ()
\begin{DoxyCompactList}\small\item\em Clear the earth model information. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_a08c337b84138adc46ee4dd002e9262d2}{Add\+Layer} (double radius, double density, double zoa, double layer)
\begin{DoxyCompactList}\small\item\em Add a layer to the model. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PremModel_aca013f7ac5494282834048786a0e07a6}{Add\+Path} (double length, \hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer} pl)
\begin{DoxyCompactList}\small\item\em Add a path segment to the sequence. \end{DoxyCompactList}\item 
\hyperlink{classOscProb_1_1PremModel_a9a1d78e29217bb0dd00ae3bd96d22b69}{Class\+Def} (\hyperlink{classOscProb_1_1PremModel}{Prem\+Model}, 1)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ \hyperlink{structOscProb_1_1PremLayer}{Osc\+Prob\+::\+Prem\+Layer} $>$ \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{f\+Prem\+Layers}
\begin{DoxyCompactList}\small\item\em The layers in the earth model. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{f\+Nu\+Path}
\begin{DoxyCompactList}\small\item\em The current neutrino path sequence. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{f\+Det\+Layer}
\begin{DoxyCompactList}\small\item\em The layer index of the detector. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}{f\+Det\+Pos}
\begin{DoxyCompactList}\small\item\em The radius where the detector lives. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}{f\+Remove\+Small\+Paths}
\begin{DoxyCompactList}\small\item\em Tag whether to merge small paths. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{classOscProb_1_1PremModel_a8ad1335ebe80ee1cd1cdf59d774ab34b}{D\+E\+T\+\_\+\+T\+OL} = 0.\+2
\begin{DoxyCompactList}\small\item\em The detector position tolerance near boundaries. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class implements a spherically symmetric model of the earth using \hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer}\textquotesingle{}s to store spherical shells with different properties.

The class is then able to produce path sequences through the different earth layers as a function of the cosine of the zenith angle with respect to the detector.

The detector can be positioned at any radius within the model and the path sequences will take into account the fact that some layers are above the detector.

By default this implements the model stored in Prem\+Tables/prem\+\_\+default.\+txt with the detector at the bottom of the ocean layer (radius = 6368 km).

This class inherits from T\+Object and can be saved in R\+O\+OT files.

\begin{DoxyAuthor}{Author}
coelho@lal.\+in2p3.\+fr 
\end{DoxyAuthor}


Definition at line 37 of file Prem\+Model.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a959f8da5c78881b950bd647b67c1ef9b}\label{classOscProb_1_1PremModel_a959f8da5c78881b950bd647b67c1ef9b}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Prem\+Model@{Prem\+Model}}
\index{Prem\+Model@{Prem\+Model}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Prem\+Model()}{PremModel()}}
{\footnotesize\ttfamily Prem\+Model\+::\+Prem\+Model (\begin{DoxyParamCaption}\item[{std\+::string}]{filename = {\ttfamily \char`\"{}\char`\"{}} }\end{DoxyParamCaption})}

Constructor.

By default this implements the model stored in Prem\+Tables/prem\+\_\+default.\+txt with the detector at the bottom of the ocean layer (radius = 6368 km).


\begin{DoxyParams}{Parameters}
{\em filename} & -\/ The txt file containing a table of earth layers \\
\hline
\end{DoxyParams}


Definition at line 35 of file Prem\+Model.\+cxx.



References Load\+Model(), and Set\+Det\+Pos().


\begin{DoxyCode}
35                                     :
36 \hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer}(0), \hyperlink{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}{fRemoveSmallPaths}(\textcolor{keyword}{false})
37 \{
38 
39   \hyperlink{classOscProb_1_1PremModel_a55b314e97ed9b92931e08ada0c0947eb}{SetDetPos}(6368);
40   \hyperlink{classOscProb_1_1PremModel_a6363a5e711dd8b0d2e684677e585b293}{LoadModel}(filename);
41 
42 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_aac484ca4e607f2b0fc6f599358cb95fb}\label{classOscProb_1_1PremModel_aac484ca4e607f2b0fc6f599358cb95fb}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!````~Prem\+Model@{$\sim$\+Prem\+Model}}
\index{````~Prem\+Model@{$\sim$\+Prem\+Model}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{$\sim$\+Prem\+Model()}{~PremModel()}}
{\footnotesize\ttfamily Prem\+Model\+::$\sim$\+Prem\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Nothing to clean. 

Definition at line 48 of file Prem\+Model.\+cxx.


\begin{DoxyCode}
48 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a08c337b84138adc46ee4dd002e9262d2}\label{classOscProb_1_1PremModel_a08c337b84138adc46ee4dd002e9262d2}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Add\+Layer@{Add\+Layer}}
\index{Add\+Layer@{Add\+Layer}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Add\+Layer()}{AddLayer()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Add\+Layer (\begin{DoxyParamCaption}\item[{double}]{radius,  }\item[{double}]{density,  }\item[{double}]{zoa,  }\item[{double}]{layer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Add a layer to the earth model.


\begin{DoxyParams}{Parameters}
{\em radius} & -\/ The outer radius of the layer in km \\
\hline
{\em density} & -\/ The density of the layer in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A value of the layer \\
\hline
{\em layer} & -\/ An index to identify the matter type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 105 of file Prem\+Model.\+cxx.



References f\+Prem\+Layers.



Referenced by Load\+Model().


\begin{DoxyCode}
107 \{
108 
109   \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.push\_back( \hyperlink{structOscProb_1_1PremLayer}{PremLayer}(radius, density, zoa, layer) );
110 
111 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_aca013f7ac5494282834048786a0e07a6}\label{classOscProb_1_1PremModel_aca013f7ac5494282834048786a0e07a6}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{\hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer}}]{pl }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Add a path segment to the sequence.

For a given \hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer}, adds a path of a given length in that material


\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em pl} & -\/ The layer we are crossing \\
\hline
\end{DoxyParams}


Definition at line 336 of file Prem\+Model.\+cxx.



References Osc\+Prob\+::\+Prem\+Layer\+::density, f\+Nu\+Path, Osc\+Prob\+::\+Prem\+Layer\+::layer, and Osc\+Prob\+::\+Prem\+Layer\+::zoa.



Referenced by Fill\+Path().


\begin{DoxyCode}
337 \{
338 
339   \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}.push\_back( \hyperlink{structOscProb_1_1NuPath}{NuPath}(length, pl.\hyperlink{structOscProb_1_1PremLayer_aba2536cbdab87d0db33df47f95c4f2c3}{density}, pl.\hyperlink{structOscProb_1_1PremLayer_a8687a8169d786fca79908292d11077f5}{zoa}, pl.
      \hyperlink{structOscProb_1_1PremLayer_aca8d7df68e6f982155b68b7e6a7ef389}{layer}) );
340 
341 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a9a1d78e29217bb0dd00ae3bd96d22b69}\label{classOscProb_1_1PremModel_a9a1d78e29217bb0dd00ae3bd96d22b69}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Class\+Def@{Class\+Def}}
\index{Class\+Def@{Class\+Def}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Class\+Def()}{ClassDef()}}
{\footnotesize\ttfamily Osc\+Prob\+::\+Prem\+Model\+::\+Class\+Def (\begin{DoxyParamCaption}\item[{\hyperlink{classOscProb_1_1PremModel}{Prem\+Model}}]{,  }\item[{1}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{classOscProb_1_1PremModel_aaead53a9385bda9b0219fd051d0cdd11}\label{classOscProb_1_1PremModel_aaead53a9385bda9b0219fd051d0cdd11}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Clear\+Model@{Clear\+Model}}
\index{Clear\+Model@{Clear\+Model}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Clear\+Model()}{ClearModel()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Clear\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Clear the earth model information. 

Definition at line 88 of file Prem\+Model.\+cxx.



References f\+Det\+Layer, and f\+Prem\+Layers.



Referenced by Load\+Model().


\begin{DoxyCode}
89 \{
90 
91   \hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer} = 0;
92   \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.clear();
93 
94 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_ac69162cc5e3c8b7c1b8a85571ff2063b}\label{classOscProb_1_1PremModel_ac69162cc5e3c8b7c1b8a85571ff2063b}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Fill\+Path@{Fill\+Path}}
\index{Fill\+Path@{Fill\+Path}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Fill\+Path()}{FillPath()}}
{\footnotesize\ttfamily int Prem\+Model\+::\+Fill\+Path (\begin{DoxyParamCaption}\item[{double}]{cosT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Fill the path sequence in a vector.

This will start at the upper-\/most layer and find straight paths to the boundary of the next layer down. When reaching the inner-\/most layer in the given direction, the paths move back to outer layers until hitting the detector.

The path sequence is stored as an attribute and can be retrieved with the function Get\+Nu\+Path.


\begin{DoxyParams}{Parameters}
{\em cosT} & -\/ The cosine of the neutrino direction \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of path segments in the sequence 
\end{DoxyReturn}


Definition at line 358 of file Prem\+Model.\+cxx.



References Add\+Path(), f\+Det\+Layer, f\+Nu\+Path, and f\+Prem\+Layers.


\begin{DoxyCode}
359 \{
360 
361   \textcolor{comment}{// Clear current path sequence}
362   \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}.clear();
363 
364   \textcolor{comment}{// Do nothing if cosine is unphysical}
365   \textcolor{keywordflow}{if}(fabs(cosT) > 1) \textcolor{keywordflow}{return} 0;
366 
367   \textcolor{comment}{// Define the minimum path radius}
368   \textcolor{keywordtype}{double} minR = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[\hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer}].radius * sqrt(1 - cosT*cosT);
369 
370   \textcolor{comment}{// Set the top layer index}
371   \textcolor{keywordtype}{int} toplayer = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.size() - 1;
372 
373   \textcolor{comment}{// Find the inner-most crossed layer}
374   \textcolor{keywordtype}{int} minlayer = 0;
375   \textcolor{keywordflow}{while}(\hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[minlayer].radius < minR) minlayer++;
376 
377   \textcolor{comment}{// Compute the number of path segments needed}
378   \textcolor{keywordtype}{int} nsteps = toplayer - \hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer};
379   \textcolor{keywordflow}{if}(cosT < 0) nsteps += 2*(fDetLayer - minlayer) + 1;
380 
381   \textcolor{comment}{// Start at the top layer and go down}
382   \textcolor{keywordtype}{int} layer = toplayer;
383   \textcolor{keywordtype}{int} dl = -1;
384 
385   \textcolor{comment}{// Loop over all path segments}
386   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nsteps; i++)\{
387 
388     \textcolor{comment}{// Get square of the path length between this layer's}
389     \textcolor{comment}{// outer radius and  inner-most radius}
390     \textcolor{keywordtype}{double} L1 = pow(\hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[layer].radius,2) - minR*minR;
391 
392     \textcolor{comment}{// If L1 is negative, outer radius is not crossed.}
393     \textcolor{comment}{// This only happens if detector is at the top layer and the}
394     \textcolor{comment}{// neutrino is coming from above.}
395     \textcolor{keywordflow}{if}(L1 < 0) \textcolor{keywordflow}{return} \textcolor{keyword}{true};
396 
397     \textcolor{comment}{// Get square of the path length between this layer's}
398     \textcolor{comment}{// inner radius and  inner-most radius}
399     \textcolor{keywordtype}{double} L2 = -minR*minR;
400     \textcolor{keywordflow}{if}(layer>0) L2 += pow(\hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[layer-1].radius,2);
401 
402     \textcolor{comment}{// If L2 is negative, inner radius is not crossed,}
403     \textcolor{comment}{// so set this as the minimum layer.}
404     \textcolor{keywordtype}{bool} ismin = (L2<=0 && cosT < 0);
405 
406     \textcolor{comment}{// Store the path segment length}
407     \textcolor{keywordtype}{double} dL;
408 
409     \textcolor{comment}{// If it's the minimum layer, connect two outer radius}
410     \textcolor{comment}{// crossing points. If not, compute difference between}
411     \textcolor{comment}{// inner and outer radius crossings.}
412     \textcolor{keywordflow}{if}(ismin)      dL = 2 * sqrt(L1);
413     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(L2>=0) dL = sqrt(L1) - sqrt(L2);
414     \textcolor{keywordflow}{else}           dL = sqrt(L1); \textcolor{comment}{// This should never actually happen,}
415                                   \textcolor{comment}{// but protect in case L2 is slightly}
416                                   \textcolor{comment}{// negative when it should be zero.}
417                                   \textcolor{comment}{// e.g. arriving at the detector from above.}
418 
419     \textcolor{comment}{// Add this path segment to the sequence}
420     \hyperlink{classOscProb_1_1PremModel_aca013f7ac5494282834048786a0e07a6}{AddPath}(dL, \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[layer]);
421 
422     \textcolor{comment}{// If we reached the inner-most layer,}
423     \textcolor{comment}{// start moving up again.}
424     \textcolor{keywordflow}{if}(ismin) dl = 1;
425 
426     \textcolor{comment}{// Move to next layer}
427     layer += dl;
428 
429   \}
430 
431   \textcolor{comment}{// Return the number of path segments}
432   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}.size();
433 
434 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a5328474bdbb703eb4c9d4df49999cda6}\label{classOscProb_1_1PremModel_a5328474bdbb703eb4c9d4df49999cda6}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+CosT@{Get\+CosT}}
\index{Get\+CosT@{Get\+CosT}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Cos\+T()}{GetCosT()}}
{\footnotesize\ttfamily double Prem\+Model\+::\+Get\+CosT (\begin{DoxyParamCaption}\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the cos\+Theta for a given total baseline.

Given a baseline, find the direction of the neutrino. This could be useful for experiments with fixed baselines for example.

The baseline must be within the range of possible values in this earth model. Will return vertical neutrinos otherwise.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The total baseline of the neutrino \\
\hline
\end{DoxyParams}


Definition at line 314 of file Prem\+Model.\+cxx.



References f\+Det\+Layer, and f\+Prem\+Layers.


\begin{DoxyCode}
315 \{
316 
317   \textcolor{keywordtype}{double} rAbove = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.back().radius;     \textcolor{comment}{// Radius above detector}
318   \textcolor{keywordtype}{double} rBelow = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[\hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer}].radius; \textcolor{comment}{// Radius below detector}
319 
320   \textcolor{keywordflow}{if}(L < rAbove - rBelow) \textcolor{keywordflow}{return}  1;
321   \textcolor{keywordflow}{if}(L > rAbove + rBelow) \textcolor{keywordflow}{return} -1;
322 
323   \textcolor{keywordflow}{return} (rAbove*rAbove - rBelow*rBelow - L*L) / (2*rBelow*L);
324 
325 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_af1b8392d1b00560c6322bf8707c304f6}\label{classOscProb_1_1PremModel_af1b8392d1b00560c6322bf8707c304f6}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+Layer\+ZoA@{Get\+Layer\+ZoA}}
\index{Get\+Layer\+ZoA@{Get\+Layer\+ZoA}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Layer\+Zo\+A()}{GetLayerZoA()}}
{\footnotesize\ttfamily double Prem\+Model\+::\+Get\+Layer\+ZoA (\begin{DoxyParamCaption}\item[{int}]{layer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the effective Z/A value for all layers of a given type, e.\+g. all outer-\/core layers.


\begin{DoxyParams}{Parameters}
{\em layer} & -\/ The index of the layer type \\
\hline
\end{DoxyParams}


Definition at line 220 of file Prem\+Model.\+cxx.



References f\+Prem\+Layers.


\begin{DoxyCode}
221 \{
222 
223   \textcolor{keywordtype}{int} nlayers = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.size();
224 
225   \textcolor{comment}{// This check assumes the layer types are in increasing order}
226   \textcolor{keywordflow}{if}(layer > \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.back().layer)\{
227     cout << \textcolor{stringliteral}{"ERROR: Not that many layer types"} << endl;
228     cout << \textcolor{stringliteral}{"Returning 0"} << endl;
229     \textcolor{keywordflow}{return} 0;
230   \}
231 
232   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nlayers; i++)\{
233 
234     \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[i].layer != layer) \textcolor{keywordflow}{continue};
235 
236     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[i].zoa;
237 
238   \}
239 
240   \textcolor{comment}{// End of vector reached without finding input type}
241   cout << \textcolor{stringliteral}{"ERROR: layer type not found"} << endl;
242   cout << \textcolor{stringliteral}{"Returning 0"} << endl;
243   \textcolor{keywordflow}{return} 0;
244 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a5b6f83f2e9b7087e8faad1f19f00ebd5}\label{classOscProb_1_1PremModel_a5b6f83f2e9b7087e8faad1f19f00ebd5}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+Merged\+Paths@{Get\+Merged\+Paths}}
\index{Get\+Merged\+Paths@{Get\+Merged\+Paths}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Merged\+Paths()}{GetMergedPaths()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1NuPath}{Nu\+Path} $>$ Prem\+Model\+::\+Get\+Merged\+Paths (\begin{DoxyParamCaption}\item[{double}]{prec = {\ttfamily 0.25} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Merge similar paths to reduce number of steps

This method will merge consecutive paths and take their averages until it finds a large enough gap to start a new merged path.

The merged paths will be returned, and the original detailed path will not be changed and will stay stored as an attribute.


\begin{DoxyParams}{Parameters}
{\em prec} & -\/ The precision to merge paths in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The vector of merged path segments 
\end{DoxyReturn}


Definition at line 449 of file Prem\+Model.\+cxx.



References Osc\+Prob\+::\+Avg\+Path(), Osc\+Prob\+::\+Nu\+Path\+::density, f\+Nu\+Path, f\+Remove\+Small\+Paths, Osc\+Prob\+::\+Merge\+Paths(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
449                                                    \{
450 
451   \textcolor{comment}{// The output vector}
452   vector<NuPath> mergedPath;
453 
454   \textcolor{comment}{// Start with the first path}
455   \hyperlink{structOscProb_1_1NuPath}{OscProb::NuPath} path = \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[0];
456 
457   \textcolor{comment}{// Track the total length}
458   \textcolor{keywordtype}{double} totL = 0;
459 
460   \textcolor{comment}{// Loop over all paths starting from second}
461   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=1; i<\hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}.size(); i++)\{
462 
463     \textcolor{comment}{// If this path electron density is beyond the tolerance}
464     \textcolor{keywordflow}{if}( fabs(path.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density}*path.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa} - \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[i].density*\hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[i].zoa) > prec*path
      .\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa} )\{
465 
466       \textcolor{comment}{// Add merged path to vector}
467       mergedPath.push\_back(path);
468 
469       \textcolor{comment}{// Set this path as new merged path}
470       path = \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[i];
471 
472     \}
473     \textcolor{comment}{// If path is within tolerance}
474     \textcolor{keywordflow}{else}\{
475 
476       \textcolor{comment}{// Merge the path with current merged path}
477       path = \hyperlink{namespaceOscProb_a999a7944bad8bc72d7ee9f56f81a210e}{OscProb::AvgPath}(path, \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[i]);
478 
479     \}
480 
481     \textcolor{comment}{// Increment total length}
482     totL += \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}[i].length;
483 
484   \}\textcolor{comment}{// End of loop over paths}
485 
486   \textcolor{comment}{// Add the final merged path to vector}
487   mergedPath.push\_back(path);
488 
489   \textcolor{comment}{// If tag is true, remove small paths}
490   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}{fRemoveSmallPaths})\{
491 
492     \textcolor{comment}{// Start at first path}
493     \textcolor{keywordtype}{int} k = 0;
494 
495     \textcolor{comment}{// While not at the end of vector}
496     \textcolor{keywordflow}{while}(k + 1 < mergedPath.size())\{
497 
498       \textcolor{comment}{// If length is less than 1% of total}
499       \textcolor{keywordflow}{if}(mergedPath[k].length < 0.01*totL)\{
500 
501         \textcolor{comment}{// Merge path with following path}
502         mergedPath = \hyperlink{namespaceOscProb_a7c203d8583a34acf2ae90185ba45f866}{MergePaths}(mergedPath, k, k+1);
503 
504       \}
505       \textcolor{comment}{// If path is long enough skip it}
506       \textcolor{keywordflow}{else} k++;
507 
508     \}\textcolor{comment}{// End of while loop}
509 
510   \}\textcolor{comment}{// End of if statement}
511 
512   \textcolor{comment}{// return the merged vector}
513   \textcolor{keywordflow}{return} mergedPath;
514 
515 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_adbe7a5df260cba3923f5cbcb8ab2f03f}\label{classOscProb_1_1PremModel_adbe7a5df260cba3923f5cbcb8ab2f03f}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+Nu\+Path@{Get\+Nu\+Path}}
\index{Get\+Nu\+Path@{Get\+Nu\+Path}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Nu\+Path()}{GetNuPath()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1NuPath}{Nu\+Path} $>$ Prem\+Model\+::\+Get\+Nu\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the current neutrino path sequence

The path needs to be filled for a given cos\+Theta before calling this function. 

Definition at line 73 of file Prem\+Model.\+cxx.



References f\+Nu\+Path.


\begin{DoxyCode}
73 \{ \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}{fNuPath}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_ae4feeccc7027253f5c2e2493098145ca}\label{classOscProb_1_1PremModel_ae4feeccc7027253f5c2e2493098145ca}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+Prem\+Layers@{Get\+Prem\+Layers}}
\index{Get\+Prem\+Layers@{Get\+Prem\+Layers}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Prem\+Layers()}{GetPremLayers()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer} $>$ Prem\+Model\+::\+Get\+Prem\+Layers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the set of earth layers

This returns the set of \hyperlink{structOscProb_1_1PremLayer}{Prem\+Layer}\textquotesingle{}s for this earth model and detector position. 

Definition at line 82 of file Prem\+Model.\+cxx.



References f\+Prem\+Layers.


\begin{DoxyCode}
82 \{ \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_ae258b41cca80631e3041f0421b25afeb}\label{classOscProb_1_1PremModel_ae258b41cca80631e3041f0421b25afeb}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Get\+TotalL@{Get\+TotalL}}
\index{Get\+TotalL@{Get\+TotalL}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Get\+Total\+L()}{GetTotalL()}}
{\footnotesize\ttfamily double Prem\+Model\+::\+Get\+TotalL (\begin{DoxyParamCaption}\item[{double}]{cosT }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the total baseline for a given cos\+Theta.

The total baseline contains both from above and below the detector.


\begin{DoxyParams}{Parameters}
{\em cosT} & -\/ The cosine of the neutrino direction \\
\hline
\end{DoxyParams}


Definition at line 288 of file Prem\+Model.\+cxx.



References f\+Det\+Layer, and f\+Prem\+Layers.


\begin{DoxyCode}
289 \{
290 
291   \textcolor{keywordflow}{if}(fabs(cosT) > 1) \textcolor{keywordflow}{return} 0;
292 
293   \textcolor{keywordtype}{double} rAbove = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.back().radius;     \textcolor{comment}{// Radius above detector}
294   \textcolor{keywordtype}{double} rBelow = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[\hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer}].radius; \textcolor{comment}{// Radius below detector}
295 
296   \textcolor{keywordtype}{double} sinsqrT = 1 - cosT*cosT;
297 
298   \textcolor{keywordflow}{return} -rBelow*cosT + sqrt(rAbove*rAbove - rBelow*rBelow*sinsqrT);
299 
300 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a6363a5e711dd8b0d2e684677e585b293}\label{classOscProb_1_1PremModel_a6363a5e711dd8b0d2e684677e585b293}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Load\+Model@{Load\+Model}}
\index{Load\+Model@{Load\+Model}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Load\+Model()}{LoadModel()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Load\+Model (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Load an earth model from a file.

By default it loads the model stored in Prem\+Tables/prem\+\_\+default.\+txt

The decision of whether to create a layer for the detector position is made in this function, so the detector position must be set before calling this function.


\begin{DoxyParams}{Parameters}
{\em filename} & -\/ The txt file containing a table of earth layers \\
\hline
\end{DoxyParams}


Definition at line 125 of file Prem\+Model.\+cxx.



References Add\+Layer(), Clear\+Model(), D\+E\+T\+\_\+\+T\+OL, f\+Det\+Layer, f\+Det\+Pos, and f\+Prem\+Layers.



Referenced by Prem\+Model().


\begin{DoxyCode}
126 \{
127 
128   \textcolor{comment}{// Clear the current model}
129   \hyperlink{classOscProb_1_1PremModel_aaead53a9385bda9b0219fd051d0cdd11}{ClearModel}();
130 
131   \textcolor{comment}{// Use default if no file provided}
132   \textcolor{keywordflow}{if}(filename == \textcolor{stringliteral}{""})\{
133     filename = PREM\_DEFAULT;
134   \}
135 
136   \textcolor{comment}{// Open the file}
137   ifstream fin;
138   fin.open(filename.c\_str());
139 
140   \textcolor{keywordflow}{if}(!fin)\{
141     cout << \textcolor{stringliteral}{"ERROR: File "} << filename << \textcolor{stringliteral}{" not found!"} << endl;
142     \textcolor{keywordflow}{return};
143   \}
144 
145   \textcolor{comment}{// Variables for storing table rows}
146   \textcolor{keywordtype}{float} radius, density, zoa, layer;
147 
148   \textcolor{comment}{// Flag to mark we've passed the detector}
149   \textcolor{keywordtype}{bool} crossed\_det = \textcolor{keyword}{false};
150 
151   \textcolor{comment}{// Keep track of previous radius}
152   \textcolor{keywordtype}{double} rprev = 0;
153 
154   \textcolor{comment}{// Loop over table rows}
155   \textcolor{keywordflow}{while}(fin >> radius >> density >> zoa >> layer)\{
156 
157     \textcolor{comment}{// Radii must be ordered in model file}
158     \textcolor{keywordflow}{if}(radius <= rprev)\{
159       cout << \textcolor{stringliteral}{"ERROR: Radii are not sorted in increasing order in the model file"} << endl;
160       \hyperlink{classOscProb_1_1PremModel_aaead53a9385bda9b0219fd051d0cdd11}{ClearModel}();
161       \textcolor{keywordflow}{return};
162     \}
163 
164     \textcolor{comment}{// See if we passed the detector and decide whether}
165     \textcolor{comment}{// to create a special layer for it}
166     \textcolor{keywordflow}{if}(radius > \hyperlink{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}{fDetPos} - \hyperlink{classOscProb_1_1PremModel_a8ad1335ebe80ee1cd1cdf59d774ab34b}{DET\_TOL} && !crossed\_det)\{
167 
168       crossed\_det = \textcolor{keyword}{true};
169 
170       \hyperlink{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}{fDetLayer} = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.size();
171 
172       \textcolor{comment}{// If detector is not near boundary, add a special layer}
173       \textcolor{keywordflow}{if}(radius > \hyperlink{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}{fDetPos} + \hyperlink{classOscProb_1_1PremModel_a8ad1335ebe80ee1cd1cdf59d774ab34b}{DET\_TOL})\{
174         \hyperlink{classOscProb_1_1PremModel_a08c337b84138adc46ee4dd002e9262d2}{AddLayer}(\hyperlink{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}{fDetPos}, density, zoa, layer);
175       \}
176 
177     \}
178 
179     \textcolor{comment}{// Add this layer to the model}
180     \hyperlink{classOscProb_1_1PremModel_a08c337b84138adc46ee4dd002e9262d2}{AddLayer}(radius, density, zoa, layer);
181 
182   \}
183 
184 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a55b314e97ed9b92931e08ada0c0947eb}\label{classOscProb_1_1PremModel_a55b314e97ed9b92931e08ada0c0947eb}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Set\+Det\+Pos@{Set\+Det\+Pos}}
\index{Set\+Det\+Pos@{Set\+Det\+Pos}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Set\+Det\+Pos()}{SetDetPos()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Set\+Det\+Pos (\begin{DoxyParamCaption}\item[{double}]{pos }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the detector position in km.

If the position is within 200m of a layer boundary, the detector is considered to be on the boundary. If not, an extra boundary is inserted in the detector position to distinguish what parts of the earth are above and below the detector.

This must be done before loading the earth model file.


\begin{DoxyParams}{Parameters}
{\em pos} & -\/ The radius where the detector is in km \\
\hline
\end{DoxyParams}


Definition at line 64 of file Prem\+Model.\+cxx.



References f\+Det\+Pos.



Referenced by Prem\+Model().


\begin{DoxyCode}
64 \{ \hyperlink{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}{fDetPos} = pos; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_ac9887d1af4b3c02925fe3228349f593d}\label{classOscProb_1_1PremModel_ac9887d1af4b3c02925fe3228349f593d}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Set\+Layer\+ZoA@{Set\+Layer\+ZoA}}
\index{Set\+Layer\+ZoA@{Set\+Layer\+ZoA}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Set\+Layer\+Zo\+A()}{SetLayerZoA()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Set\+Layer\+ZoA (\begin{DoxyParamCaption}\item[{int}]{layer,  }\item[{double}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the effective Z/A value for all layers of a given type.

Use this to change the Z/A of indexed layer, e.\+g. all outer-\/core layers


\begin{DoxyParams}{Parameters}
{\em layer} & -\/ The index of the layer type \\
\hline
{\em zoa} & -\/ The effective Z/A value to use \\
\hline
\end{DoxyParams}


Definition at line 196 of file Prem\+Model.\+cxx.



References f\+Prem\+Layers.


\begin{DoxyCode}
197 \{
198 
199   \textcolor{keywordtype}{int} nlayers = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.size();
200 
201   \textcolor{comment}{// Loop over all layers and change the ones}
202   \textcolor{comment}{// with the given index}
203   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nlayers; i++)\{
204 
205     \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[i].layer != layer) \textcolor{keywordflow}{continue};
206 
207     \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[i].zoa = zoa;
208 
209   \}
210 
211 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_ac5496d6d5bafcf7740c60838d3eee7b3}\label{classOscProb_1_1PremModel_ac5496d6d5bafcf7740c60838d3eee7b3}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Set\+Remove\+Small\+Paths@{Set\+Remove\+Small\+Paths}}
\index{Set\+Remove\+Small\+Paths@{Set\+Remove\+Small\+Paths}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Set\+Remove\+Small\+Paths()}{SetRemoveSmallPaths()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Set\+Remove\+Small\+Paths (\begin{DoxyParamCaption}\item[{bool}]{rp = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the boolean to tag whether to remove small paths when merging


\begin{DoxyParams}{Parameters}
{\em rp} & -\/ Boolean value to set \\
\hline
\end{DoxyParams}


Definition at line 523 of file Prem\+Model.\+cxx.



References f\+Remove\+Small\+Paths.


\begin{DoxyCode}
523 \{ \hyperlink{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}{fRemoveSmallPaths} = rp; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a095bd601f6cd91926de9928e96ea7751}\label{classOscProb_1_1PremModel_a095bd601f6cd91926de9928e96ea7751}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!Set\+Top\+Layer\+Size@{Set\+Top\+Layer\+Size}}
\index{Set\+Top\+Layer\+Size@{Set\+Top\+Layer\+Size}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{Set\+Top\+Layer\+Size()}{SetTopLayerSize()}}
{\footnotesize\ttfamily void Prem\+Model\+::\+Set\+Top\+Layer\+Size (\begin{DoxyParamCaption}\item[{double}]{thick }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the radius of the outermost layer of the model.

This usually corresponds to the atmosphere and is useful for computing oscillations with variable neutrino production height.


\begin{DoxyParams}{Parameters}
{\em thick} & -\/ The thickness of the outer layer in km \\
\hline
\end{DoxyParams}


Definition at line 255 of file Prem\+Model.\+cxx.



References f\+Prem\+Layers.


\begin{DoxyCode}
256 \{
257 
258   \textcolor{keywordflow}{if}(thick <= 0)\{
259     cout << \textcolor{stringliteral}{"Layer thickness should be positive. Do nothing."} << endl;
260     \textcolor{keywordflow}{return};
261   \}
262 
263   \textcolor{keywordtype}{int} nlayers = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}.size();
264 
265   \textcolor{keywordflow}{if}(nlayers < 1)\{
266     cout << \textcolor{stringliteral}{"PremModel has no layers. Do nothing."} << endl;
267     \textcolor{keywordflow}{return};
268   \}
269 
270   \textcolor{keywordtype}{double} bottomRadius;
271   \textcolor{keywordflow}{if}(nlayers>1) bottomRadius = \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[nlayers-2].radius;
272   \textcolor{keywordflow}{else}          bottomRadius = 0;
273 
274   \textcolor{keywordtype}{double} topRadius = bottomRadius + thick;
275 
276   \hyperlink{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}{fPremLayers}[nlayers-1].radius = topRadius;
277 
278 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classOscProb_1_1PremModel_a8ad1335ebe80ee1cd1cdf59d774ab34b}\label{classOscProb_1_1PremModel_a8ad1335ebe80ee1cd1cdf59d774ab34b}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!D\+E\+T\+\_\+\+T\+OL@{D\+E\+T\+\_\+\+T\+OL}}
\index{D\+E\+T\+\_\+\+T\+OL@{D\+E\+T\+\_\+\+T\+OL}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{D\+E\+T\+\_\+\+T\+OL}{DET\_TOL}}
{\footnotesize\ttfamily const double Prem\+Model\+::\+D\+E\+T\+\_\+\+T\+OL = 0.\+2\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}

Define the tolerance of the detector around a boundary when considering whether to add a new layer for the detector position. 

Definition at line 84 of file Prem\+Model.\+h.



Referenced by Load\+Model().

\mbox{\Hypertarget{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}\label{classOscProb_1_1PremModel_a4fb68506493666349f418b893a996185}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!f\+Det\+Layer@{f\+Det\+Layer}}
\index{f\+Det\+Layer@{f\+Det\+Layer}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{f\+Det\+Layer}{fDetLayer}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+Prem\+Model\+::f\+Det\+Layer\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 79 of file Prem\+Model.\+h.



Referenced by Clear\+Model(), Fill\+Path(), Get\+Cos\+T(), Get\+Total\+L(), and Load\+Model().

\mbox{\Hypertarget{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}\label{classOscProb_1_1PremModel_ab12ea0343cd11b9233ffd20ab5e620c7}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!f\+Det\+Pos@{f\+Det\+Pos}}
\index{f\+Det\+Pos@{f\+Det\+Pos}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{f\+Det\+Pos}{fDetPos}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+Prem\+Model\+::f\+Det\+Pos\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 80 of file Prem\+Model.\+h.



Referenced by Load\+Model(), and Set\+Det\+Pos().

\mbox{\Hypertarget{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}\label{classOscProb_1_1PremModel_aaf3c77e35798d664853157013c90ad2b}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!f\+Nu\+Path@{f\+Nu\+Path}}
\index{f\+Nu\+Path@{f\+Nu\+Path}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{f\+Nu\+Path}{fNuPath}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}$>$ Osc\+Prob\+::\+Prem\+Model\+::f\+Nu\+Path\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 77 of file Prem\+Model.\+h.



Referenced by Add\+Path(), Fill\+Path(), Get\+Merged\+Paths(), and Get\+Nu\+Path().

\mbox{\Hypertarget{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}\label{classOscProb_1_1PremModel_a19a9a3b23ec154ad7a29f92b74aa5bc6}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!f\+Prem\+Layers@{f\+Prem\+Layers}}
\index{f\+Prem\+Layers@{f\+Prem\+Layers}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{f\+Prem\+Layers}{fPremLayers}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{structOscProb_1_1PremLayer}{Osc\+Prob\+::\+Prem\+Layer}$>$ Osc\+Prob\+::\+Prem\+Model\+::f\+Prem\+Layers\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 75 of file Prem\+Model.\+h.



Referenced by Add\+Layer(), Clear\+Model(), Fill\+Path(), Get\+Cos\+T(), Get\+Layer\+Zo\+A(), Get\+Prem\+Layers(), Get\+Total\+L(), Load\+Model(), Set\+Layer\+Zo\+A(), and Set\+Top\+Layer\+Size().

\mbox{\Hypertarget{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}\label{classOscProb_1_1PremModel_a3973df6f5f2ff219cd2f865b31aacfd2}} 
\index{Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}!f\+Remove\+Small\+Paths@{f\+Remove\+Small\+Paths}}
\index{f\+Remove\+Small\+Paths@{f\+Remove\+Small\+Paths}!Osc\+Prob\+::\+Prem\+Model@{Osc\+Prob\+::\+Prem\+Model}}
\subsubsection{\texorpdfstring{f\+Remove\+Small\+Paths}{fRemoveSmallPaths}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+Prem\+Model\+::f\+Remove\+Small\+Paths\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 82 of file Prem\+Model.\+h.



Referenced by Get\+Merged\+Paths(), and Set\+Remove\+Small\+Paths().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/jcoelho/test\+Osc\+Prob/\hyperlink{PremModel_8h}{Prem\+Model.\+h}\item 
/home/jcoelho/test\+Osc\+Prob/\hyperlink{PremModel_8cxx}{Prem\+Model.\+cxx}\end{DoxyCompactItemize}
