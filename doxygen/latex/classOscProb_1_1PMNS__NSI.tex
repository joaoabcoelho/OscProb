\hypertarget{classOscProb_1_1PMNS__NSI}{}\section{Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+N\+SI Class Reference}
\label{classOscProb_1_1PMNS__NSI}\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}


Implementation of oscillations of neutrinos in matter in a three-\/neutrino framework with N\+SI.  




{\ttfamily \#include $<$P\+M\+N\+S\+\_\+\+N\+S\+I.\+h$>$}

Inheritance diagram for Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+N\+SI\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classOscProb_1_1PMNS__NSI}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classOscProb_1_1PMNS__NSI_ab41e79fb427c7a5662443acad31ce7e9}{P\+M\+N\+S\+\_\+\+N\+SI} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classOscProb_1_1PMNS__NSI_aad1035cb0fb26994029c25b475ec3bde}{$\sim$\+P\+M\+N\+S\+\_\+\+N\+SI} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{Set\+Eps} (int flvi, int flvj, double val, double phase)
\begin{DoxyCompactList}\small\item\em Set any given N\+SI parameter. \end{DoxyCompactList}\item 
virtual \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__NSI_a70f1c7d3d0dea3abf8ac40f856fc18ab}{Get\+Eps} (int flvi, int flvj)
\begin{DoxyCompactList}\small\item\em Get any given N\+SI parameter. \end{DoxyCompactList}\item 
void \hyperlink{classOscProb_1_1PMNS__NSI_ae8829af10bc4051e8c74c8b1bc81c88c}{Set\+N\+SI} (double eps\+\_\+ee, double eps\+\_\+emu, double eps\+\_\+etau, double eps\+\_\+mumu, double eps\+\_\+mutau, double eps\+\_\+tautau, double delta\+\_\+emu=0, double delta\+\_\+etau=0, double delta\+\_\+mutau=0)
\begin{DoxyCompactList}\small\item\em Set the N\+SI parameters all at once. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a13ecb89c4d43924d23833a9e930f50e0}{Set\+Eps\+\_\+ee} (double a)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+ee parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_abf049db9904c745f04346d0d1dedf998}{Set\+Eps\+\_\+mumu} (double a)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+mumu parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a5736f3cd792a621dfa844c3fa314cd17}{Set\+Eps\+\_\+tautau} (double a)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+tautau parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_ad5fccd151aea7c673c516b8686f8253c}{Set\+Eps\+\_\+emu} (double a, double phi)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+emu parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a73d43e6d267975d1545af922f8e81bb3}{Set\+Eps\+\_\+etau} (double a, double phi)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+etau parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_acfb9893697e04fcc25915ffaf8ed137f}{Set\+Eps\+\_\+mutau} (double a, double phi)
\begin{DoxyCompactList}\small\item\em Set eps\+\_\+mutau parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a8e07f5fe44e9ed471efa8e683584e2c7}{Set\+Elec\+Coup} (double e)
\begin{DoxyCompactList}\small\item\em Set electron coupling. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a27ecfa2a97c67e6bfb399eeba956f74f}{Set\+Up\+Coup} (double u)
\begin{DoxyCompactList}\small\item\em Set u-\/quark couling. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_abcc85b0662bd6d08fc5a0bc713657129}{Set\+Down\+Coup} (double d)
\begin{DoxyCompactList}\small\item\em Set d-\/quark couling. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a78983619968493630c48080bea9af05e}{Set\+Ferm\+Coup} (double e, double u, double d)
\begin{DoxyCompactList}\small\item\em Set all fermion couplings. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}{Set\+Coup\+By\+Index} (double c, int i)
\begin{DoxyCompactList}\small\item\em Set a given fermion coupling. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__NSI_adbee38997ab80f8d1a9750d3eae0afea}{Get\+Elec\+Coup} ()
\begin{DoxyCompactList}\small\item\em Get electron coupling. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__NSI_a5fbeeb25bd00fbda7c484dbdb6748a58}{Get\+Up\+Coup} ()
\begin{DoxyCompactList}\small\item\em Get u-\/quark couling. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__NSI_a4f5306674397d6183214d53bf2f110f7}{Get\+Down\+Coup} ()
\begin{DoxyCompactList}\small\item\em Get d-\/quark couling. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__NSI_a42b2db6f2f42dbca7545a10d101a7950}{Get\+Zo\+A\+Coup} ()
\begin{DoxyCompactList}\small\item\em Get effective Z/A coupling. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}{Set\+Mix} (double th12, double th23, double th13, double deltacp)
\begin{DoxyCompactList}\small\item\em Set the all mixing parameters at once. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}{Set\+Delta\+Msqrs} (double dm21, double dm32)
\begin{DoxyCompactList}\small\item\em Set both mass-\/splittings at once. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob} (std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ nu\+\_\+in, int flvf)
\begin{DoxyCompactList}\small\item\em Compute the probability of nu\+\_\+in going to flvf. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a0190a79284289aacf682c78d7cef9a81}{Prob} (std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ nu\+\_\+in, int flvf, double E)
\begin{DoxyCompactList}\small\item\em Compute the probability of nu\+\_\+in going to flvf for energy E. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a01fba31729345376705e02408e835f67}{Prob} (std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ nu\+\_\+in, int flvf, double E, double L)
\begin{DoxyCompactList}\small\item\em Compute the probability of nu\+\_\+in going to flvf for energy E and distance L. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob} (int flvi, int flvf)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}{Prob} (int flvi, int flvf, double E)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}{Prob} (int flvi, int flvf, double E, double L)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E and distance L. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a89e54c80ae8a31effbab7b2b970606bb}{Avg\+Prob} (std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ nu\+\_\+in, int flvf, double E, double dE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of energy. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}{Avg\+Prob} (int flvi, int flvf, double E, double dE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of energy. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a19f160c045a01e5083506e925fb37d44}{Avg\+Prob\+LoE} (std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ nu\+\_\+in, int flvf, double LoE, double d\+LoE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of L/E. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}{Avg\+Prob\+LoE} (int flvi, int flvf, double LoE, double d\+LoE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of L/E. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a5092561dd8579d390c649eb60803ea98}{Get\+Mass\+Eigenstate} (int mi)
\begin{DoxyCompactList}\small\item\em Get a neutrino mass eigenstate. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{Set\+Angle} (int i, int j, double th)
\begin{DoxyCompactList}\small\item\em Set the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}{Set\+Delta} (int i, int j, double delta)
\begin{DoxyCompactList}\small\item\em Set the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{Set\+Dm} (int j, double dm)
\begin{DoxyCompactList}\small\item\em Set the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}{Get\+Angle} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}{Get\+Delta} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}{Get\+Dm} (int j)
\begin{DoxyCompactList}\small\item\em Get the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}{Get\+Dm\+Eff} (int j)
\begin{DoxyCompactList}\small\item\em Get the effective mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}{Set\+Std\+Pars} ()
\begin{DoxyCompactList}\small\item\em Set P\+DG 3-\/flavor parameters. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{Set\+Energy} (double E)
\begin{DoxyCompactList}\small\item\em Set the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}{Set\+Is\+Nu\+Bar} (bool is\+Nu\+Bar)
\begin{DoxyCompactList}\small\item\em Set the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}{Get\+Energy} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}{Get\+Is\+Nu\+Bar} ()
\begin{DoxyCompactList}\small\item\em Get the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{Set\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}{Set\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}{Set\+Path} (std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ paths)
\begin{DoxyCompactList}\small\item\em Set a path sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{Add\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}{Add\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{Clear\+Path} ()
\begin{DoxyCompactList}\small\item\em Clear the path vector. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{Set\+Length} (double L)
\begin{DoxyCompactList}\small\item\em Set a single path lentgh in km. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}{Set\+Length} (std\+::vector$<$ double $>$ L)
\begin{DoxyCompactList}\small\item\em Set multiple path lengths. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}{Set\+Density} (double rho)
\begin{DoxyCompactList}\small\item\em Set single path density in g/cm$^\wedge$3. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}{Set\+Density} (std\+::vector$<$ double $>$ rho)
\begin{DoxyCompactList}\small\item\em Set multiple path densities. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}{Set\+ZoA} (double zoa)
\begin{DoxyCompactList}\small\item\em Set Z/A value for single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}{Set\+ZoA} (std\+::vector$<$ double $>$ zoa)
\begin{DoxyCompactList}\small\item\em Set multiple path Z/A values. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}{Set\+Layers} (std\+::vector$<$ int $>$ lay)
\begin{DoxyCompactList}\small\item\em Set multiple path layer indices. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{Set\+Std\+Path} ()
\begin{DoxyCompactList}\small\item\em Set standard neutrino path. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}{Get\+Path} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino path sequence. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{Get\+Sample\+Points} (double LoE, double d\+LoE)
\begin{DoxyCompactList}\small\item\em Compute the sample points for a bin of L/E with width d\+LoE. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}{Set\+Use\+Cache} (bool u=true)
\begin{DoxyCompactList}\small\item\em Set caching on/off. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{Clear\+Cache} ()
\begin{DoxyCompactList}\small\item\em Clear the cache. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}{Set\+Max\+Cache} (int mc=1e6)
\begin{DoxyCompactList}\small\item\em Set max cache size. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classOscProb_1_1PMNS__NSI_ab5c4f4644fbedb8835f6336c553805ce}{Update\+Ham} ()
\begin{DoxyCompactList}\small\item\em Build the full Hamiltonian. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}{Solve\+Ham} ()
\begin{DoxyCompactList}\small\item\em Solve the full Hamiltonian for eigenvectors and eigenvalues. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}{Set\+Vacuum\+Eigensystem} ()
\begin{DoxyCompactList}\small\item\em Set the eigensystem to the analytic solution of the vacuum Hamiltonian. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}{Initialize\+Vectors} ()
\begin{DoxyCompactList}\small\item\em Initialize all member vectors with zeros. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}{Try\+Cache} ()
\begin{DoxyCompactList}\small\item\em Try to find a cached eigensystem. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}{Fill\+Cache} ()
\begin{DoxyCompactList}\small\item\em Cache the current eigensystem. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{Set\+Cur\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set the path currently in use by the class. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{Set\+Att} (double att, int idx)
\begin{DoxyCompactList}\small\item\em Set one of the path attributes. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}{Set\+Att} (std\+::vector$<$ double $>$ att, int idx)
\begin{DoxyCompactList}\small\item\em Set all values of a path attribute. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH} (int i, int j)
\begin{DoxyCompactList}\small\item\em Rotate the Hamiltonian by theta\+\_\+ij and delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ae52554477ad3250daa5adb8c32cab0b4}{Rotate\+State} (int i, int j)
\begin{DoxyCompactList}\small\item\em Rotate the neutrino state by theta\+\_\+ij and delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{Build\+Hms} ()
\begin{DoxyCompactList}\small\item\em Build the matrix of masses squared. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{Reset\+To\+Flavour} (int flv)
\begin{DoxyCompactList}\small\item\em Reset neutrino state to pure flavour flv. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{Propagate\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Propagate neutrino through a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate} ()
\begin{DoxyCompactList}\small\item\em Propagate neutrino through full path. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{P} (int flv)
\begin{DoxyCompactList}\small\item\em Return the probability of final state in flavour flv. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{f\+Eps} \mbox{[}3\mbox{]}\mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em Stores each N\+SI parameter. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{f\+N\+S\+Icoup} \mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em Relative N\+SI couplings. \end{DoxyCompactList}\item 
\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{f\+Ham} \mbox{[}3\mbox{]}\mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em The full hamiltonian. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{f\+Num\+Nus}
\begin{DoxyCompactList}\small\item\em Number of neutrino flavours. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{f\+Dm}
\begin{DoxyCompactList}\small\item\em m$^\wedge$2\+\_\+i -\/ m$^\wedge$2\+\_\+1 in vacuum \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{f\+Theta}
\begin{DoxyCompactList}\small\item\em theta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} mixing angle \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{f\+Delta}
\begin{DoxyCompactList}\small\item\em delta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} CP violating phase \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{f\+Nu\+State}
\begin{DoxyCompactList}\small\item\em The neutrino current state. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{f\+Hms}
\begin{DoxyCompactList}\small\item\em matrix H$\ast$2E in e\+V$^\wedge$2 \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{f\+Phases}
\begin{DoxyCompactList}\small\item\em Buffer for oscillation phases. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{f\+Buffer}
\begin{DoxyCompactList}\small\item\em Buffer for neutrino state tranformations. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{f\+Eval}
\begin{DoxyCompactList}\small\item\em Eigenvalues of the Hamiltonian. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{f\+Evec}
\begin{DoxyCompactList}\small\item\em Eigenvectors of the Hamiltonian. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{f\+Energy}
\begin{DoxyCompactList}\small\item\em Neutrino energy. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{f\+Is\+Nu\+Bar}
\begin{DoxyCompactList}\small\item\em Anti-\/neutrino flag. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{f\+Nu\+Paths}
\begin{DoxyCompactList}\small\item\em Vector of neutrino paths. \end{DoxyCompactList}\item 
\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{f\+Path}
\begin{DoxyCompactList}\small\item\em Current neutrino path. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{f\+Built\+Hms}
\begin{DoxyCompactList}\small\item\em Tag to avoid rebuilding Hms. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{f\+Got\+ES}
\begin{DoxyCompactList}\small\item\em Tag to avoid recalculating eigensystem. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{f\+Use\+Cache}
\begin{DoxyCompactList}\small\item\em Flag for whether to use caching. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}{f\+Cache\+Prec}
\begin{DoxyCompactList}\small\item\em Precision of cache matching. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{f\+Max\+Cache}
\begin{DoxyCompactList}\small\item\em Maximum cache size. \end{DoxyCompactList}\item 
std\+::set$<$ \hyperlink{structOscProb_1_1EigenPoint}{Osc\+Prob\+::\+Eigen\+Point} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{f\+Mix\+Cache}
\begin{DoxyCompactList}\small\item\em Caching set of eigensystems. \end{DoxyCompactList}\item 
\hyperlink{structOscProb_1_1EigenPoint}{Eigen\+Point} \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{f\+Probe}
\begin{DoxyCompactList}\small\item\em Eigenp\+Point to try. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}
\begin{DoxyCompactList}\small\item\em zero in complex \end{DoxyCompactList}\item 
static const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}{one}
\begin{DoxyCompactList}\small\item\em one in complex \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{k\+Km2eV} = 1.\+0 / 1.\+973269788e-\/10
\begin{DoxyCompactList}\small\item\em km to e\+V$^\wedge$-\/1 \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{k\+K2} = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)
\begin{DoxyCompactList}\small\item\em mol/\+Ge\+V$^\wedge$2/cm$^\wedge$3 to eV \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{k\+Ge\+V2eV} = 1.\+0e+09
\begin{DoxyCompactList}\small\item\em GeV to eV. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}{k\+NA} = 6.\+022140857e23
\begin{DoxyCompactList}\small\item\em Avogadro constant. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{k\+Gf} = 1.\+1663787e-\/05
\begin{DoxyCompactList}\small\item\em G\+\_\+F in units of Ge\+V$^\wedge$-\/2. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class expands the \hyperlink{classOscProb_1_1PMNS__Fast}{P\+M\+N\+S\+\_\+\+Fast} class including a general matter potential matrix describing Non-\/\+Standard Interactions (N\+SI).

The matter potential is parametrized by dimensionless quantities epsilon which quantify the intensity of the N\+SI with respect to the standard matter effects from coherent forward scattering with electrons.

\begin{DoxySeeAlso}{See also}
\hyperlink{classOscProb_1_1PMNS__Fast}{P\+M\+N\+S\+\_\+\+Fast}
\end{DoxySeeAlso}
\begin{DoxyAuthor}{Author}
coelho@lal.\+in2p3.\+fr 
\end{DoxyAuthor}


Definition at line 25 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_ab41e79fb427c7a5662443acad31ce7e9}\label{classOscProb_1_1PMNS__NSI_ab41e79fb427c7a5662443acad31ce7e9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!P\+M\+N\+S\+\_\+\+N\+SI@{P\+M\+N\+S\+\_\+\+N\+SI}}
\index{P\+M\+N\+S\+\_\+\+N\+SI@{P\+M\+N\+S\+\_\+\+N\+SI}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{P\+M\+N\+S\+\_\+\+N\+S\+I()}{PMNS\_NSI()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+P\+M\+N\+S\+\_\+\+N\+SI (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Constructor. \begin{DoxySeeAlso}{See also}
\hyperlink{classOscProb_1_1PMNS__Base_aa53e83b03a9cf4bdfa0a07136bd17a79}{P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base}
\end{DoxySeeAlso}
This class is restricted to 3 neutrino flavours. 

Definition at line 29 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Ferm\+Coup(), Set\+N\+S\+I(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().


\begin{DoxyCode}
29                    : \hyperlink{classOscProb_1_1PMNS__Fast_a2bbac744bf63753105d766a860af7c0d}{PMNS\_Fast}(), \hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{fEps}()
30 \{
31   \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
32   \hyperlink{classOscProb_1_1PMNS__NSI_ae8829af10bc4051e8c74c8b1bc81c88c}{SetNSI}(0.,0.,0.,0.,0.,0.,0.,0.,0.);
33   \hyperlink{classOscProb_1_1PMNS__NSI_a78983619968493630c48080bea9af05e}{SetFermCoup}(1,0,0);
34 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_aad1035cb0fb26994029c25b475ec3bde}\label{classOscProb_1_1PMNS__NSI_aad1035cb0fb26994029c25b475ec3bde}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!````~P\+M\+N\+S\+\_\+\+N\+SI@{$\sim$\+P\+M\+N\+S\+\_\+\+N\+SI}}
\index{````~P\+M\+N\+S\+\_\+\+N\+SI@{$\sim$\+P\+M\+N\+S\+\_\+\+N\+SI}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{$\sim$\+P\+M\+N\+S\+\_\+\+N\+S\+I()}{~PMNS\_NSI()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+N\+S\+I\+::$\sim$\+P\+M\+N\+S\+\_\+\+N\+SI (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Nothing to clean. 

Definition at line 40 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.


\begin{DoxyCode}
40 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}\label{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence. 
\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 351 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
351                                \{
352 
353   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.push\_back(p);
354 
355 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}\label{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence defining attributes directly. 
\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 365 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path().


\begin{DoxyCode}
365                                                                            \{
366 
367   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
368 
369 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a89e54c80ae8a31effbab7b2b970606bb}\label{classOscProb_1_1PMNS__Base_a89e54c80ae8a31effbab7b2b970606bb}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Avg\+Prob@{Avg\+Prob}}
\index{Avg\+Prob@{Avg\+Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Avg\+Prob()}{AvgProb()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$}]{nu\+\_\+in,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{dE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of nu\+\_\+in going to flvf over a bin of energy E with width dE.

This gets transformed into L/E, since the oscillation terms have arguments linear in L/E and not E.

This function works best for single paths. In multiple paths the accuracy may be somewhat worse. If needed, average over smaller energy ranges.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em nu\+\_\+in} & -\/ The neutrino initial state in flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in the bin center in GeV \\
\hline
{\em dE} & -\/ The energy bin width in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1385 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Avg\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob().


\begin{DoxyCode}
1386 \{
1387 
1388   \textcolor{comment}{// Do nothing if energy is not positive}
1389   \textcolor{keywordflow}{if}(E<=0) \textcolor{keywordflow}{return} 0;
1390 
1391   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1392 
1393   \textcolor{comment}{// Don't average zero width}
1394   \textcolor{keywordflow}{if}(dE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(nu\_in, flvf, E);
1395 
1396   \textcolor{comment}{// Make sure fPath is set}
1397   \textcolor{comment}{// Use average if multiple paths}
1398   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{namespaceOscProb_a999a7944bad8bc72d7ee9f56f81a210e}{AvgPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}));
1399 
1400   \textcolor{comment}{// Define L/E variables}
1401   \textcolor{keywordtype}{double} LoE = 0;
1402   \textcolor{keywordtype}{double} dLoE = 0;
1403 
1404   \textcolor{comment}{// Set a minimum energy}
1405   \textcolor{keywordtype}{double} minE = 0.1 * E;
1406 
1407   \textcolor{comment}{// Transform range to L/E}
1408   \textcolor{comment}{// Full range if low edge > minE}
1409   \textcolor{keywordflow}{if}(E-dE/2 > minE)\{
1410     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1411     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1412   \}
1413   \textcolor{comment}{// Else start at minE}
1414   \textcolor{keywordflow}{else}\{
1415     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1416     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1417   \}
1418 
1419   \textcolor{comment}{// Compute average in LoE}
1420   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a19f160c045a01e5083506e925fb37d44}{AvgProbLoE}(nu\_in, flvf, LoE, dLoE);
1421 
1422 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}\label{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Avg\+Prob@{Avg\+Prob}}
\index{Avg\+Prob@{Avg\+Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Avg\+Prob()}{AvgProb()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{dE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of energy E with width dE.

This gets transformed into L/E, since the oscillation terms have arguments linear in L/E and not E.

This function works best for single paths. In multiple paths the accuracy may be somewhat worse. If needed, average over smaller energy ranges.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in the bin center in GeV \\
\hline
{\em dE} & -\/ The energy bin width in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1352 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().


\begin{DoxyCode}
1353 \{
1354 
1355   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(flvi);
1356 
1357   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a89e54c80ae8a31effbab7b2b970606bb}{AvgProb}(\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}, flvf, E, dE);
1358 
1359 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a19f160c045a01e5083506e925fb37d44}\label{classOscProb_1_1PMNS__Base_a19f160c045a01e5083506e925fb37d44}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Avg\+Prob\+LoE@{Avg\+Prob\+LoE}}
\index{Avg\+Prob\+LoE@{Avg\+Prob\+LoE}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Avg\+Prob\+Lo\+E()}{AvgProbLoE()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+LoE (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$}]{nu\+\_\+in,  }\item[{int}]{flvf,  }\item[{double}]{LoE,  }\item[{double}]{d\+LoE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of nu\+\_\+in going to flvf over a bin of L/E with width d\+LoE.

The probabilities are weighted by (L/E)$^\wedge$-\/2 so that event density is flat in energy. This avoids giving too much weight to low energies. Better approximations would be achieved if we used an interpolated event density.

This function works best for single paths. In multiple paths the accuracy may be somewhat worse. If needed, average over smaller L/E ranges.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em nu\+\_\+in} & -\/ The neutrino intial state in flavour basis. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1485 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Avg\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E().


\begin{DoxyCode}
1486 \{
1487 
1488   \textcolor{comment}{// Do nothing if L/E is not positive}
1489   \textcolor{keywordflow}{if}(LoE<=0) \textcolor{keywordflow}{return} 0;
1490 
1491   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1492 
1493   \textcolor{comment}{// Make sure fPath is set}
1494   \textcolor{comment}{// Use average if multiple paths}
1495   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{namespaceOscProb_a999a7944bad8bc72d7ee9f56f81a210e}{AvgPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}));
1496 
1497   \textcolor{comment}{// Set the energy at bin center}
1498   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/LoE);
1499 
1500   \textcolor{comment}{// Don't average zero width}
1501   \textcolor{keywordflow}{if}(dLoE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(nu\_in, flvf);
1502 
1503   \textcolor{comment}{// Get sample points for this bin}
1504   vector<double> samples = \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{GetSamplePoints}(LoE, dLoE);
1505 
1506   \textcolor{comment}{// Variables to fill sample}
1507   \textcolor{comment}{// probabilities and weights}
1508   \textcolor{keywordtype}{double} sumw = 0;
1509   \textcolor{keywordtype}{double} prob = 0;
1510   \textcolor{keywordtype}{double} length = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length};
1511 
1512   \textcolor{comment}{// Loop over all sample points}
1513   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(samples.size()); j++)\{
1514 
1515     \textcolor{comment}{// Set (L/E)^-2 weights}
1516     \textcolor{keywordtype}{double} w = 1./pow(samples[j],2);
1517 
1518     \textcolor{comment}{// Add weighted probability}
1519     prob += w * \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(nu\_in, flvf, length / samples[j]);
1520 
1521     \textcolor{comment}{// Increment sum of weights}
1522     sumw += w;
1523 
1524   \}
1525 
1526   \textcolor{comment}{// Return weighted average of probabilities}
1527   \textcolor{keywordflow}{return} prob / sumw;
1528 
1529 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}\label{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Avg\+Prob\+LoE@{Avg\+Prob\+LoE}}
\index{Avg\+Prob\+LoE@{Avg\+Prob\+LoE}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Avg\+Prob\+Lo\+E()}{AvgProbLoE()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+LoE (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{LoE,  }\item[{double}]{d\+LoE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of L/E with width d\+LoE.

The probabilities are weighted by (L/E)$^\wedge$-\/2 so that event density is flat in energy. This avoids giving too much weight to low energies. Better approximations would be achieved if we used an interpolated event density.

This function works best for single paths. In multiple paths the accuracy may be somewhat worse. If needed, average over smaller L/E ranges.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1450 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().


\begin{DoxyCode}
1451 \{
1452 
1453   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(flvi);
1454 
1455   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a19f160c045a01e5083506e925fb37d44}{AvgProbLoE}(\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}, flvf, LoE, dLoE);
1456 
1457 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}\label{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Build\+Hms@{Build\+Hms}}
\index{Build\+Hms@{Build\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Build\+Hms()}{BuildHms()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Build Hms = H$\ast$2E, where H is the Hamiltonian in vacuum on flavour basis and E is the neutrino energy in eV. Hms is effectively the matrix of masses squared.

This is a hermitian matrix, so only the upper triangular part needs to be filled

The construction of the Hamiltonian avoids computing terms that are simply zero. This has a big impact in the computation time. 

Definition at line 1044 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
1045 \{
1046 
1047   \textcolor{comment}{// Check if anything changed}
1048   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms}) \textcolor{keywordflow}{return};
1049   
1050   \textcolor{comment}{// Tag to recompute eigensystem}
1051   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{false};
1052 
1053   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
1054     \textcolor{comment}{// Set mass splitting}
1055     \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j];
1056     \textcolor{comment}{// Reset off-diagonal elements}
1057     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
1058       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = 0;
1059     \}
1060     \textcolor{comment}{// Rotate j neutrinos}
1061     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
1062       \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH}(i,j);
1063     \}
1064   \}
1065 
1066   \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{ClearCache}();
1067 
1068   \textcolor{comment}{// Tag as built}
1069   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} = \textcolor{keyword}{true};
1070 
1071 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}\label{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Clear\+Cache@{Clear\+Cache}}
\index{Clear\+Cache@{Clear\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Clear\+Cache()}{ClearCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Clear the cache 

Definition at line 115 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Set\+Coup\+By\+Index(), and Set\+Eps().


\begin{DoxyCode}
116 \{
117   \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.clear();
118 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}\label{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Clear\+Path@{Clear\+Path}}
\index{Clear\+Path@{Clear\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Clear\+Path()}{ClearPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Clear the path vector. 

Definition at line 319 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
319                          \{
320 
321   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.clear();
322 
323 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}\label{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Fill\+Cache@{Fill\+Cache}}
\index{Fill\+Cache@{Fill\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Fill\+Cache()}{FillCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

If using caching, save the eigensystem in memory 

Definition at line 166 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Eigen\+Point\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+Eigen\+Point\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
167 \{
168 
169   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache})\{
170     \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.size()>\hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{fMaxCache})\{
171       \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.erase(\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.begin());
172       \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.erase(--\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.end());
173     \}
174     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
175       \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_a5c5e729d82e3aca1964c1777f4882f9d}{fEval}[i] = \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i];
176       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
177         \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_adf3ccb3d88ea1ae6ef3635fea8748e09}{fEvec}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j];
178       \}
179     \}
180     \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.insert(\hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe});
181   \}
182 
183 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}\label{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Angle@{Get\+Angle}}
\index{Get\+Angle@{Get\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Angle()}{GetAngle()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 658 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.


\begin{DoxyCode}
659 \{
660 
661   \textcolor{keywordflow}{if}(i>j)\{
662     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
663     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
664     \textcolor{keywordtype}{int} temp = i;
665     i = j;
666     j = temp;
667   \}
668   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
669     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
670     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
671     \textcolor{keywordflow}{return} 0;
672   \}
673 
674   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1];
675 
676 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}\label{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Delta@{Get\+Delta}}
\index{Get\+Delta@{Get\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Delta()}{GetDelta()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 728 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
729 \{
730 
731   \textcolor{keywordflow}{if}(i>j)\{
732     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
733     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
734     \textcolor{keywordtype}{int} temp = i;
735     i = j;
736     j = temp;
737   \}
738   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
739     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
740     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
741     \textcolor{keywordflow}{return} 0;
742   \}
743   \textcolor{keywordflow}{if}(i+1==j)\{
744     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Returning zero."} << endl;
745     \textcolor{keywordflow}{return} 0;
746   \}
747 
748   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1];
749 
750 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}\label{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Dm@{Get\+Dm}}
\index{Get\+Dm@{Get\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Dm()}{GetDm()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm (\begin{DoxyParamCaption}\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 788 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
789 \{
790 
791   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
792     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
793     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
794     \textcolor{keywordflow}{return} 0;
795   \}
796 
797   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1];
798 
799 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}\label{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Dm\+Eff@{Get\+Dm\+Eff}}
\index{Get\+Dm\+Eff@{Get\+Dm\+Eff}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Dm\+Eff()}{GetDmEff()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff (\begin{DoxyParamCaption}\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the effective mass-\/splitting dm\+\_\+j1 in matter in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 809 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().


\begin{DoxyCode}
810 \{
811 
812   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
813     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
814     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
815     \textcolor{keywordflow}{return} 0;
816   \}
817 
818   \textcolor{comment}{// Solve the Hamiltonian to update eigenvalues}
819   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
820   
821   \textcolor{comment}{// Sort eigenvalues in same order as vacuum Dm^2}
822   vector<int> TrueIdx(fNumNus, 0);
823   vector<double> TrueVals(fNumNus, 0);
824   vector<int> EffIdx(fNumNus, 0);
825   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
826     TrueIdx[i] = i;
827     EffIdx[i] = i;
828   \}
829   sort(TrueIdx.begin(), TrueIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}));
830   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++) TrueVals[i] = TrueIdx[i];
831   sort(TrueIdx.begin(), TrueIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(TrueVals));
832   sort(EffIdx.begin(), EffIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}));
833 
834   \textcolor{comment}{// Return eigenvalues * 2E}
835   \textcolor{keywordflow}{return} (\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[EffIdx[TrueIdx[j-1]]] - \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[EffIdx[TrueIdx[0]]]) * 
      \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} * 2e9;
836 
837 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a4f5306674397d6183214d53bf2f110f7}\label{classOscProb_1_1PMNS__NSI_a4f5306674397d6183214d53bf2f110f7}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Down\+Coup@{Get\+Down\+Coup}}
\index{Get\+Down\+Coup@{Get\+Down\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Down\+Coup()}{GetDownCoup()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Down\+Coup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the N\+SI relative coupling to d-\/quarks. 

Definition at line 340 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References f\+N\+S\+Icoup.


\begin{DoxyCode}
340 \{ \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[2]; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_adbee38997ab80f8d1a9750d3eae0afea}\label{classOscProb_1_1PMNS__NSI_adbee38997ab80f8d1a9750d3eae0afea}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Elec\+Coup@{Get\+Elec\+Coup}}
\index{Get\+Elec\+Coup@{Get\+Elec\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Elec\+Coup()}{GetElecCoup()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Elec\+Coup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the N\+SI relative coupling to electrons. 

Definition at line 328 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References f\+N\+S\+Icoup.


\begin{DoxyCode}
328 \{ \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[0]; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}\label{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Energy@{Get\+Energy}}
\index{Get\+Energy@{Get\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Energy()}{GetEnergy()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the neutrino energy in GeV. 

Definition at line 277 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy.


\begin{DoxyCode}
277                             \{
278 
279   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};
280 
281 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a70f1c7d3d0dea3abf8ac40f856fc18ab}\label{classOscProb_1_1PMNS__NSI_a70f1c7d3d0dea3abf8ac40f856fc18ab}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Eps@{Get\+Eps}}
\index{Get\+Eps@{Get\+Eps}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Eps()}{GetEps()}}
{\footnotesize\ttfamily \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Eps (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvj }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get any given N\+SI parameter.

Flavours are\+:~\newline

\begin{DoxyItemize}
\item 0 = nue, 1 = numu, 2 = nutau
\end{DoxyItemize}

Requires that flvi $<$ flvj. Will notify you if input is wrong. If flvi $>$ flvj, will assume reverse order and swap flvi and flvj.


\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The first flavour index \\
\hline
{\em flvj} & -\/ The second flavour index \\
\hline
\end{DoxyParams}


Definition at line 134 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References f\+Eps, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.


\begin{DoxyCode}
134                                            \{
135 
136   \textcolor{keywordflow}{if}(flvi > flvj)\{
137     cout << \textcolor{stringliteral}{"First argument should be smaller or equal to second argument"} << endl;
138     cout << \textcolor{stringliteral}{"Setting reverse order (Eps\_"} << flvj << flvi << \textcolor{stringliteral}{"). "} << endl;
139     \textcolor{keywordtype}{int} temp = flvi;
140     flvi = flvj;
141     flvj = temp;
142   \}
143   \textcolor{keywordflow}{if}(flvi<0 || flvi>2 || flvj < flvi || flvj > 2)\{
144     cout << \textcolor{stringliteral}{"Eps\_"} << flvi << flvj << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
145     cout << \textcolor{stringliteral}{" neutrinos. Returning 0."} << endl;
146     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero};
147   \}
148 
149   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{fEps}[flvi][flvj];
150 
151 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}\label{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}}
\index{Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Is\+Nu\+Bar()}{GetIsNuBar()}}
{\footnotesize\ttfamily bool P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the anti-\/neutrino flag. 

Definition at line 287 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.


\begin{DoxyCode}
287                            \{
288 
289   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar};
290 
291 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a5092561dd8579d390c649eb60803ea98}\label{classOscProb_1_1PMNS__Base_a5092561dd8579d390c649eb60803ea98}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Mass\+Eigenstate@{Get\+Mass\+Eigenstate}}
\index{Get\+Mass\+Eigenstate@{Get\+Mass\+Eigenstate}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Mass\+Eigenstate()}{GetMassEigenstate()}}
{\footnotesize\ttfamily std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Mass\+Eigenstate (\begin{DoxyParamCaption}\item[{int}]{mi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the neutrino mass eigenstate in vacuum

States are\+: 
\begin{DoxyPre}
  0 = m\_1, 1 = m\_2, 2 = m\_3, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em mi} & -\/ the mass eigenstate index\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mass eigenstate 
\end{DoxyReturn}


Definition at line 882 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+State().


\begin{DoxyCode}
882                                                       \{
883 
884   vector<complexD> oldState = \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState};
885 
886   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(mi);
887   
888   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
889   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
890     \hyperlink{classOscProb_1_1PMNS__Base_ae52554477ad3250daa5adb8c32cab0b4}{RotateState}(i,j);
891   \}\}
892 
893   vector<complexD> newState = \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState};
894   \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState} = oldState;
895   
896   \textcolor{keywordflow}{return} newState;
897   
898 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}\label{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Path@{Get\+Path}}
\index{Get\+Path@{Get\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Path()}{GetPath()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1NuPath}{Nu\+Path} $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the vector of neutrino paths. 

Definition at line 340 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
340                                  \{
341 
342   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths};
343 
344 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}\label{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Sample\+Points@{Get\+Sample\+Points}}
\index{Get\+Sample\+Points@{Get\+Sample\+Points}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Sample\+Points()}{GetSamplePoints()}}
{\footnotesize\ttfamily vector$<$ double $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points (\begin{DoxyParamCaption}\item[{double}]{LoE,  }\item[{double}]{d\+LoE }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the sample points for a bin of L/E with width d\+LoE

This is used for averaging the probability over a bin of L/E. It should be a private function, but I\textquotesingle{}m keeping it public for now for debugging purposes. The number of sample points seems too high for most purposes. The number of subdivisions needs to be optimized.


\begin{DoxyParams}{Parameters}
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV \\
\hline
\end{DoxyParams}


Definition at line 1544 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E().


\begin{DoxyCode}
1545 \{
1546 
1547   \textcolor{comment}{// Solve Hamiltonian to get eigenvalues}
1548   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
1549 
1550   \textcolor{comment}{// Define conversion factor [km/GeV -> 1/(4 eV^2)]}
1551   \textcolor{keyword}{const} \textcolor{keywordtype}{double} k1267 = \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} / (4 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV});
1552 
1553   \textcolor{comment}{// Get list of all effective Dm^2}
1554   vector<double> effDm;
1555 
1556   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1; i++)\{
1557     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=i+1; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
1558       effDm.push\_back( 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV} * \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} * fabs(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[j] - 
      \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i]) );
1559     \}
1560   \}
1561 
1562   \textcolor{keywordtype}{int} numDm = effDm.size();
1563 
1564   \textcolor{comment}{// Sort the effective Dm^2 list}
1565   sort(effDm.begin(), effDm.end());
1566 
1567   \textcolor{comment}{// Set a number of sub-divisions to achieve "good" accuracy}
1568   \textcolor{comment}{// This needs to be studied better}
1569   \textcolor{keywordtype}{int} n\_div = ceil( 20 * pow(dLoE/LoE,0.8) );
1570   \textcolor{comment}{//int n\_div = 1;}
1571 
1572   \textcolor{comment}{// A vector to store sample points}
1573   vector<double> allSamples;
1574 
1575   \textcolor{comment}{// Loop over sub-divisions}
1576   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<n\_div; k++)\{
1577 
1578     \textcolor{comment}{// Define sub-division center and width}
1579     \textcolor{keywordtype}{double} bctr = LoE - dLoE/2 + (k+0.5)*dLoE/n\_div;
1580     \textcolor{keywordtype}{double} bwdt = dLoE/n\_div;
1581 
1582     \textcolor{comment}{// Make a vector of L/E sample values}
1583     \textcolor{comment}{// Initialized in the sub-division center}
1584     vector<double> samples;
1585     samples.push\_back(bctr);
1586 
1587     \textcolor{comment}{// Loop over all Dm^2 to average each frequency}
1588     \textcolor{comment}{// This will recursively sample points in smaller}
1589     \textcolor{comment}{// bins so that all relevant frequencies are used}
1590     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<numDm; i++)\{
1591 
1592       \textcolor{comment}{// Copy the list of sample L/E values}
1593       vector<double> prev = samples;
1594 
1595       \textcolor{comment}{// Redefine bin width to lie within full sub-division}
1596       \textcolor{keywordtype}{double} Width = 2*min(prev[0] - (bctr - bwdt/2), (bctr + bwdt/2) - prev[0]);
1597 
1598       \textcolor{comment}{// Compute oscillation argument sorted from lowest  to highest}
1599       \textcolor{keyword}{const} \textcolor{keywordtype}{double} arg = k1267 * effDm[i] * Width;
1600 
1601       \textcolor{comment}{// Skip small oscillation values.}
1602       \textcolor{comment}{// If it's the last one, lower the tolerance}
1603       \textcolor{keywordflow}{if}(i < numDm-1)\{
1604         \textcolor{keywordflow}{if}(arg<0.9) \textcolor{keywordflow}{continue};
1605       \}
1606       \textcolor{keywordflow}{else}\{
1607         \textcolor{keywordflow}{if}(arg<0.1) \textcolor{keywordflow}{continue};
1608       \}
1609 
1610       \textcolor{comment}{// Reset samples to redefine them}
1611       samples.clear();
1612 
1613       \textcolor{comment}{// Loop over previous samples}
1614       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(prev.size()); j++)\{
1615 
1616         \textcolor{comment}{// Compute new sample points around old samples}
1617         \textcolor{comment}{// This is based on a oscillatory quadrature rule}
1618         \textcolor{keywordtype}{double} sample = (1/sqrt(3)) * (Width/2);
1619         \textcolor{keywordflow}{if}(arg!=0) sample = acos(sin(arg)/arg)/arg * (Width/2);
1620 
1621         \textcolor{comment}{// Add samples above and below center}
1622         samples.push\_back(prev[j]-sample);
1623         samples.push\_back(prev[j]+sample);
1624 
1625       \}
1626 
1627     \}\textcolor{comment}{// End of loop over Dm^2}
1628 
1629     \textcolor{comment}{// Add sub-division samples to the end of allSamples vector}
1630     allSamples.insert(allSamples.end(), samples.begin(), samples.end());
1631 
1632   \}\textcolor{comment}{// End of loop over sub-divisions}
1633 
1634   \textcolor{comment}{// Return all sample points}
1635   \textcolor{keywordflow}{return} allSamples;
1636 
1637 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a5fbeeb25bd00fbda7c484dbdb6748a58}\label{classOscProb_1_1PMNS__NSI_a5fbeeb25bd00fbda7c484dbdb6748a58}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Up\+Coup@{Get\+Up\+Coup}}
\index{Get\+Up\+Coup@{Get\+Up\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Up\+Coup()}{GetUpCoup()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Up\+Coup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the N\+SI relative coupling to u-\/quarks. 

Definition at line 334 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References f\+N\+S\+Icoup.


\begin{DoxyCode}
334 \{ \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[1]; \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a42b2db6f2f42dbca7545a10d101a7950}\label{classOscProb_1_1PMNS__NSI_a42b2db6f2f42dbca7545a10d101a7950}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Get\+Zo\+A\+Coup@{Get\+Zo\+A\+Coup}}
\index{Get\+Zo\+A\+Coup@{Get\+Zo\+A\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Get\+Zo\+A\+Coup()}{GetZoACoup()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Zo\+A\+Coup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the effective N\+SI Z/A dependence. 

Definition at line 346 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References f\+N\+S\+Icoup, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Update\+Ham().


\begin{DoxyCode}
347 \{
348 
349   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[0] * \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}        \textcolor{comment}{// electrons: Z}
350        + \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[1] * (1 + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa})  \textcolor{comment}{// u-quarks:  A + Z}
351        + \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[2] * (2 - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}); \textcolor{comment}{// d-quarks: 2A - Z }
352 
353 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}\label{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Initialize\+Vectors@{Initialize\+Vectors}}
\index{Initialize\+Vectors@{Initialize\+Vectors}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Initialize\+Vectors()}{InitializeVectors()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector sizes and initialize elements to zero. 

Definition at line 78 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Buffer, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Phases, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
79 \{
80 
81   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}    = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
82   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
83   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
84 
85   \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
86   \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}     = vector< vector<complexD> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complexD>(
      \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},\hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}));
87 
88   \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{fPhases} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
89   \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
90 
91   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval} = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
92   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec} = vector< vector<complexD> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complexD>(
      \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},\hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}));
93 
94 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}\label{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!P@{P}}
\index{P@{P}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{P()}{P()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::P (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute oscillation probability of flavour flv from current state

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_aa81f47ea36207b90a5feb9849060032d}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 1159 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1160 \{
1161   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
1162   \textcolor{keywordflow}{return} norm(\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[flv]);
1163 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}\label{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [1/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$}]{nu\+\_\+in,  }\item[{int}]{flvf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of nu\+\_\+in going to flvf.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em nu\+\_\+in} & -\/ The neutrino initial state in flavour basis. \\
\hline
{\em flvf} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1202 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1203 \{
1204 
1205   assert(nu\_in.size() == \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
1206   assert(flvf >= 0 && flvf < \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
1207 
1208   \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState} = nu\_in;
1209 
1210   \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate}();
1211 
1212   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{P}(flvf);
1213 
1214 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0190a79284289aacf682c78d7cef9a81}\label{classOscProb_1_1PMNS__Base_a0190a79284289aacf682c78d7cef9a81}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [2/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$}]{nu\+\_\+in,  }\item[{int}]{flvf,  }\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of nu\+\_\+in going to flvf for a given energy in GeV.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em nu\+\_\+in} & -\/ The neutrino initial state in flavour basis. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1231 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().


\begin{DoxyCode}
1232 \{
1233 
1234   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1235 
1236   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(nu\_in, flvf);
1237 
1238 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a01fba31729345376705e02408e835f67}\label{classOscProb_1_1PMNS__Base_a01fba31729345376705e02408e835f67}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [3/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$}]{nu\+\_\+in,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of nu\+\_\+in going to flvf for a given energy in GeV and distance in km in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost.

Don\textquotesingle{}t use this if you want to propagate over multiple path segments.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em nu\+\_\+in} & -\/ The neutrino initial state in flavour basis. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV \\
\hline
{\em L} & -\/ The neutrino path length in km\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1286 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length().


\begin{DoxyCode}
1287 \{
1288 
1289   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1290   \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{SetLength}(L);
1291 
1292   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(nu\_in, flvf);
1293 
1294 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}\label{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [4/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1179 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().


\begin{DoxyCode}
1180 \{
1181 
1182   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(flvi);
1183 
1184   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}, flvf);
1185 
1186 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}\label{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [5/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1255 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().


\begin{DoxyCode}
1256 \{
1257 
1258   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1259 
1260   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(flvi, flvf);
1261 
1262 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}\label{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [6/6]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV and distance in km in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost.

Don\textquotesingle{}t use this if you want to propagate over multiple path segments.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV \\
\hline
{\em L} & -\/ The neutrino path length in km\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1318 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length().


\begin{DoxyCode}
1319 \{
1320 
1321   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1322   \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{SetLength}(L);
1323 
1324   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aa2e10704d2d205a1ec8988de14b1a66f}{Prob}(flvi, flvf);
1325 
1326 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}\label{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Propagate@{Propagate}}
\index{Propagate@{Propagate}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Propagate()}{Propagate()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Propagate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Propagate neutrino state through full path 

Definition at line 1115 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1116 \{
1117 
1118   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<int(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size()); i++)\{
1119 
1120     \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{PropagatePath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i]);
1121 
1122   \}
1123 
1124 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}\label{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Propagate\+Path@{Propagate\+Path}}
\index{Propagate\+Path@{Propagate\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Propagate\+Path()}{PropagatePath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Propagate the current neutrino state through a given path 
\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_aa75341a3608bb12d7792a14e67ef2d5e}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 1078 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Buffer, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Phases, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate().


\begin{DoxyCode}
1079 \{
1080 
1081   \textcolor{comment}{// Set the neutrino path}
1082   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(p);
1083 
1084   \textcolor{comment}{// Solve for eigensystem}
1085   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
1086 
1087   \textcolor{keywordtype}{double} LengthIneV = \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} * p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length};
1088   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
1089     \textcolor{keywordtype}{double} arg = \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] * LengthIneV;
1090     \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{fPhases}[i] = \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(cos(arg), -sin(arg));
1091   \}
1092   
1093   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
1094     \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer}[i] = 0;
1095     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
1096       \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer}[i] += conj(\hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[j][i]) * \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[j];
1097     \}
1098     \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer}[i] *= \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{fPhases}[i];
1099   \}
1100 
1101   \textcolor{comment}{// Propagate neutrino state}
1102   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
1103     \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] = 0;
1104     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
1105       \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] +=  \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j] * \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer}[j];
1106     \}
1107   \}
1108 
1109 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}\label{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Reset\+To\+Flavour@{Reset\+To\+Flavour}}
\index{Reset\+To\+Flavour@{Reset\+To\+Flavour}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Reset\+To\+Flavour()}{ResetToFlavour()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Reset the neutrino state back to a pure flavour where it starts

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino starting flavour. \\
\hline
\end{DoxyParams}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_a393940f176614e3ffebeea40cfe78a62}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 1137 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::one, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Mass\+Eigenstate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1138 \{
1139   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
1140   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; ++i)\{
1141     \textcolor{keywordflow}{if} (i==flv) \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] = \hyperlink{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}{one};
1142     \textcolor{keywordflow}{else}        \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] = \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero};
1143   \}
1144 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}\label{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!RotateH@{RotateH}}
\index{RotateH@{RotateH}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Rotate\+H()}{RotateH()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+RotateH (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Rotate the Hamiltonian by the angle theta\+\_\+ij and phase delta\+\_\+ij.

The rotations assume all off-\/diagonal elements with i $>$ j are zero. This is correct if the order of rotations is chosen appropriately and it speeds up computation by skipping null terms


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of the rotation ij \\
\hline
\end{DoxyParams}


Definition at line 910 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms().


\begin{DoxyCode}
910                                   \{
911 
912   \textcolor{comment}{// Do nothing if angle is zero}
913   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]==0) \textcolor{keywordflow}{return};
914 
915   \textcolor{keywordtype}{double} fSinBuffer = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
916   \textcolor{keywordtype}{double} fCosBuffer = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
917 
918   \textcolor{keywordtype}{double}  fHmsBufferD;
919   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fHmsBufferC;
920 
921   \textcolor{comment}{// With Delta}
922   \textcolor{keywordflow}{if}(i+1<j)\{
923     \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fExpBuffer = \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(cos(\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]), -sin(
      \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]));
924 
925     \textcolor{comment}{// General case}
926     \textcolor{keywordflow}{if}(i>0)\{
927       \textcolor{comment}{// Top columns}
928       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
929         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i];
930 
931         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] *= fCosBuffer;
932         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] * fSinBuffer * conj(fExpBuffer);
933 
934         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
935         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= fHmsBufferC * fSinBuffer * fExpBuffer;
936       \}
937 
938       \textcolor{comment}{// Middle row and column}
939       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
940         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j];
941 
942         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
943         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
944 
945         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] *= fCosBuffer;
946         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] += fSinBuffer * fExpBuffer * conj(fHmsBufferC);
947       \}
948 
949       \textcolor{comment}{// Nodes ij}
950       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i];
951       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j]);
952 
953       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
954       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer));
955       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] * fSinBuffer;
956 
957       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
958       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
959       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer));
960 
961       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer)) * fSinBuffer * fExpBuffer;
962       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC) * fExpBuffer;
963 
964     \}
965     \textcolor{comment}{// First rotation on j (No top columns)}
966     \textcolor{keywordflow}{else}\{
967       \textcolor{comment}{// Middle rows and columns}
968       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
969         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] = -conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
970 
971         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] *= fCosBuffer;
972       \}
973 
974       \textcolor{comment}{// Nodes ij}
975       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i]);
976 
977       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = fSinBuffer * fCosBuffer * (\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] - fHmsBufferD) * fExpBuffer;
978 
979       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
980       fHms[i][i] += fSinBuffer * fHms[j][j] * fSinBuffer;
981 
982       fHms[j][j] *= fCosBuffer * fCosBuffer;
983       fHms[j][j] += fSinBuffer * fHmsBufferD * fSinBuffer;
984     \}
985 
986   \}
987   \textcolor{comment}{// Without Delta (No middle rows or columns: j = i+1)}
988   \textcolor{keywordflow}{else}\{
989     \textcolor{comment}{// General case}
990     \textcolor{keywordflow}{if}(i>0)\{
991       \textcolor{comment}{// Top columns}
992       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
993         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i];
994 
995         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] *= fCosBuffer;
996         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] * fSinBuffer;
997 
998         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
999         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= fHmsBufferC * fSinBuffer;
1000       \}
1001 
1002       \textcolor{comment}{// Nodes ij}
1003       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i];
1004       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j]);
1005 
1006       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
1007       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]);
1008       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] * fSinBuffer;
1009 
1010       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
1011       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
1012       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]);
1013 
1014       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]) * fSinBuffer;
1015       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC);
1016 
1017     \}
1018     \textcolor{comment}{// First rotation (theta12)}
1019     \textcolor{keywordflow}{else}\{
1020 
1021       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = fSinBuffer * fCosBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j];
1022 
1023       fHms[i][i] = fSinBuffer * fHms[j][j] * fSinBuffer;
1024 
1025       fHms[j][j] *= fCosBuffer * fCosBuffer;
1026 
1027     \}
1028   \}
1029 
1030 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ae52554477ad3250daa5adb8c32cab0b4}\label{classOscProb_1_1PMNS__Base_ae52554477ad3250daa5adb8c32cab0b4}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Rotate\+State@{Rotate\+State}}
\index{Rotate\+State@{Rotate\+State}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Rotate\+State()}{RotateState()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+State (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Rotate the neutrino state by the angle theta\+\_\+ij and phase delta\+\_\+ij.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of the rotation ij \\
\hline
\end{DoxyParams}


Definition at line 846 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Mass\+Eigenstate().


\begin{DoxyCode}
846                                        \{
847 
848   \textcolor{comment}{// Do nothing if angle is zero}
849   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]==0) \textcolor{keywordflow}{return};
850   
851   \textcolor{keywordtype}{double} sij = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
852   \textcolor{keywordtype}{double} cij = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
853   
854   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} buffer;
855   
856   \textcolor{keywordflow}{if}(i+1==j || \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]==0)\{
857     buffer      = cij*\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] + sij*\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[j];
858     fNuState[j] = cij*fNuState[j] - sij*fNuState[i];
859   \}
860   \textcolor{keywordflow}{else} \{
861     \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} eij = \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(cos(\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]), -sin(\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]));
862     buffer      = cij*\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] + sij*eij*\hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[j];
863     fNuState[j] = cij*fNuState[j] - sij*conj(eij)*fNuState[i];
864   \}
865 
866   \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState}[i] = buffer;
867   
868 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}\label{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Angle@{Set\+Angle}}
\index{Set\+Angle@{Set\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Angle()}{SetAngle()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{th }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
{\em th} & -\/ the value of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 626 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
627 \{
628 
629   \textcolor{keywordflow}{if}(i>j)\{
630     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
631     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
632     \textcolor{keywordtype}{int} temp = i;
633     i = j;
634     j = temp;
635   \}
636   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
637     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
638     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
639     \textcolor{keywordflow}{return};
640   \}
641 
642   \textcolor{comment}{// Check if value is actually changing}
643   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] == th);
644 
645   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] = th;
646 
647 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}\label{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{double}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set some single path attribute.

An auxiliary function to set individual attributes in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The value of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 415 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Zo\+A().


\begin{DoxyCode}
415                                          \{
416 
417   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() != 1)\{
418 
419     cout << \textcolor{stringliteral}{"Warning: Clearing path vector and starting new single path."} << endl;
420     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
421 
422     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
423 
424   \}
425 
426   \textcolor{keywordflow}{switch}(idx)\{
427     \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].length  = att; \textcolor{keywordflow}{break};
428     \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].density = att; \textcolor{keywordflow}{break};
429     \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].zoa     = att; \textcolor{keywordflow}{break};
430     \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].layer   = att; \textcolor{keywordflow}{break};
431   \}
432 
433 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}\label{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set all values of a path attribute.

An auxiliary function to set individual attributes in a path sequence.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The values of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 492 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
492                                                     \{
493 
494   \textcolor{comment}{// Get the sizes of the attribute and}
495   \textcolor{comment}{// path sequence vectors}
496   \textcolor{keywordtype}{int} nA = att.size();
497   \textcolor{keywordtype}{int} nP = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size();
498 
499   \textcolor{comment}{// If the vector sizes are equal, update this attribute}
500   \textcolor{keywordflow}{if}(nA == nP)\{
501 
502     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nP; i++)\{
503 
504       \textcolor{keywordflow}{switch}(idx)\{
505         \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].length  = att[i]; \textcolor{keywordflow}{break};
506         \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].density = att[i]; \textcolor{keywordflow}{break};
507         \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].zoa     = att[i]; \textcolor{keywordflow}{break};
508         \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].layer   = att[i]; \textcolor{keywordflow}{break};
509       \}
510 
511     \}
512 
513   \}
514   \textcolor{comment}{// If the vector sizes differ, create a new path sequence}
515   \textcolor{comment}{// and set value for this attribute. Other attributes will}
516   \textcolor{comment}{// be taken from default single path.}
517   \textcolor{keywordflow}{else}\{
518 
519     cout << \textcolor{stringliteral}{"Warning: New vector size. Starting new path vector."} << endl;
520     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
521 
522     \textcolor{comment}{// Start a new standard path just}
523     \textcolor{comment}{// to set default values}
524     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
525 
526     \textcolor{comment}{// Create a path segment with default values}
527     \hyperlink{structOscProb_1_1NuPath}{NuPath} p = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0];
528 
529     \textcolor{comment}{// Clear the path sequence}
530     \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
531 
532     \textcolor{comment}{// Set this particular attribute's value}
533     \textcolor{comment}{// and add the path segment to the sequence}
534     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nA; i++)\{
535 
536       \textcolor{keywordflow}{switch}(idx)\{
537         \textcolor{keywordflow}{case} 0: p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = att[i]; \textcolor{keywordflow}{break};
538         \textcolor{keywordflow}{case} 1: p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = att[i]; \textcolor{keywordflow}{break};
539         \textcolor{keywordflow}{case} 2: p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = att[i]; \textcolor{keywordflow}{break};
540         \textcolor{keywordflow}{case} 3: p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = att[i]; \textcolor{keywordflow}{break};
541       \}
542 
543       \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
544 
545     \}
546 
547   \}
548 
549 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}\label{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Coup\+By\+Index@{Set\+Coup\+By\+Index}}
\index{Set\+Coup\+By\+Index@{Set\+Coup\+By\+Index}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Coup\+By\+Index()}{SetCoupByIndex()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Coup\+By\+Index (\begin{DoxyParamCaption}\item[{double}]{c,  }\item[{int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the N\+SI relative coupling to a given fermion. This factor represents what fraction of the fermion are seen by the interaction.


\begin{DoxyParams}{Parameters}
{\em c} & -\/ fermion coupling strength \\
\hline
{\em i} & -\/ fermion index (0,1,2) -\/$>$ (e,u,d) \\
\hline
\end{DoxyParams}


Definition at line 263 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, and f\+N\+S\+Icoup.



Referenced by Set\+Down\+Coup(), Set\+Elec\+Coup(), and Set\+Up\+Coup().


\begin{DoxyCode}
263                                             \{
264 
265   \textcolor{keywordtype}{bool} isSame = (\hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[i] == c);
266 
267   \textcolor{keywordflow}{if}(!isSame) \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{ClearCache}();
268 
269   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= isSame;
270 
271   \hyperlink{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}{fNSIcoup}[i] = c;
272   
273 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}\label{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Cur\+Path@{Set\+Cur\+Path}}
\index{Set\+Cur\+Path@{Set\+Cur\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Cur\+Path()}{SetCurPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the path currentlyin use by the class.

This will be used to know what path to propagate through next.

It will also check if values are changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 304 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().


\begin{DoxyCode}
305 \{
306 
307   \textcolor{comment}{// Check if relevant value are actually changing}
308   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} == p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density});
309   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa} == p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa});
310 
311   \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath} = p;
312 
313 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}\label{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Delta@{Set\+Delta}}
\index{Set\+Delta@{Set\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Delta()}{SetDelta()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
{\em delta} & -\/ the value of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 692 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix().


\begin{DoxyCode}
693 \{
694 
695   \textcolor{keywordflow}{if}(i>j)\{
696     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
697     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
698     \textcolor{keywordtype}{int} temp = i;
699     i = j;
700     j = temp;
701   \}
702   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
703     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
704     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
705     \textcolor{keywordflow}{return};
706   \}
707   \textcolor{keywordflow}{if}(i+1==j)\{
708     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Doing nothing."} << endl;
709     \textcolor{keywordflow}{return};
710   \}
711 
712   \textcolor{comment}{// Check if value is actually changing}
713   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] == delta);
714 
715   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] = delta;
716 
717 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}\label{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Delta\+Msqrs@{Set\+Delta\+Msqrs}}
\index{Set\+Delta\+Msqrs@{Set\+Delta\+Msqrs}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Delta\+Msqrs()}{SetDeltaMsqrs()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Delta\+Msqrs (\begin{DoxyParamCaption}\item[{double}]{dm21,  }\item[{double}]{dm32 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set both mass-\/splittings at once.

These are Dm\+\_\+21 and Dm\+\_\+32 in e\+V$^\wedge$2.~\newline
The corresponding Dm\+\_\+31 is set in the class attributes.


\begin{DoxyParams}{Parameters}
{\em dm21} & -\/ The solar mass-\/splitting Dm\+\_\+21 \\
\hline
{\em dm32} & -\/ The atmospheric mass-\/splitting Dm\+\_\+32 \\
\hline
\end{DoxyParams}


Definition at line 60 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().


\begin{DoxyCode}
61 \{
62 
63   \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, dm21);
64   \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(3, dm32 + dm21);
65 
66 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}\label{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{double}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path density.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 459 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
459                                     \{
460 
461   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
462 
463 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}\label{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path densities.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The densities of the path segments in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 575 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
575                                                \{
576 
577   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
578 
579 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}\label{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Dm@{Set\+Dm}}
\index{Set\+Dm@{Set\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Dm()}{SetDm()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{double}]{dm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
{\em dm} & -\/ the value of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 764 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Delta\+Msqrs(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
765 \{
766 
767   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
768     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
769     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
770     \textcolor{keywordflow}{return};
771   \}
772 
773   \textcolor{comment}{// Check if value is actually changing}
774   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] == dm);
775 
776   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] = dm;
777 
778 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_abcc85b0662bd6d08fc5a0bc713657129}\label{classOscProb_1_1PMNS__NSI_abcc85b0662bd6d08fc5a0bc713657129}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Down\+Coup@{Set\+Down\+Coup}}
\index{Set\+Down\+Coup@{Set\+Down\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Down\+Coup()}{SetDownCoup()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Down\+Coup (\begin{DoxyParamCaption}\item[{double}]{d }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the N\+SI relative coupling to d-\/quarks. This factor represents what fraction of the d-\/quarks are seen by the interaction.


\begin{DoxyParams}{Parameters}
{\em d} & -\/ d-\/quark coupling strength \\
\hline
\end{DoxyParams}


Definition at line 303 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Coup\+By\+Index().



Referenced by Set\+Ferm\+Coup().


\begin{DoxyCode}
303 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}{SetCoupByIndex}(d, 2); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a8e07f5fe44e9ed471efa8e683584e2c7}\label{classOscProb_1_1PMNS__NSI_a8e07f5fe44e9ed471efa8e683584e2c7}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Elec\+Coup@{Set\+Elec\+Coup}}
\index{Set\+Elec\+Coup@{Set\+Elec\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Elec\+Coup()}{SetElecCoup()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Elec\+Coup (\begin{DoxyParamCaption}\item[{double}]{e }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the N\+SI relative coupling to electrons. This factor represents what fraction of the electrons are seen by the interaction.


\begin{DoxyParams}{Parameters}
{\em e} & -\/ electron coupling strength \\
\hline
\end{DoxyParams}


Definition at line 283 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Coup\+By\+Index().



Referenced by Set\+Ferm\+Coup().


\begin{DoxyCode}
283 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}{SetCoupByIndex}(e, 0); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}\label{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Energy@{Set\+Energy}}
\index{Set\+Energy@{Set\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Energy()}{SetEnergy()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy (\begin{DoxyParamCaption}\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set neutrino energy in GeV.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em E} & -\/ The neutrino energy in GeV \\
\hline
\end{DoxyParams}


Definition at line 244 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
245 \{
246 
247   \textcolor{comment}{// Check if value is actually changing}
248   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} == E);
249 
250   \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} = E;
251 
252 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}\label{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps@{Set\+Eps}}
\index{Set\+Eps@{Set\+Eps}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps()}{SetEps()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvj,  }\item[{double}]{val,  }\item[{double}]{phase }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set any given N\+SI parameter.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.

Flavours are\+:~\newline

\begin{DoxyItemize}
\item 0 = nue, 1 = numu, 2 = nutau
\end{DoxyItemize}

Requires that flvi $<$ flvj. Will notify you if input is wrong. If flvi $>$ flvj, will assume reverse order and swap flvi and flvj.


\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The first flavour index \\
\hline
{\em flvj} & -\/ The second flavour index \\
\hline
{\em val} & -\/ The absolute value of the parameter \\
\hline
{\em phase} & -\/ The complex phase of the parameter in radians \\
\hline
\end{DoxyParams}


Definition at line 92 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), f\+Eps, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Set\+Eps\+\_\+ee(), Set\+Eps\+\_\+emu(), Set\+Eps\+\_\+etau(), Set\+Eps\+\_\+mumu(), Set\+Eps\+\_\+mutau(), Set\+Eps\+\_\+tautau(), and Set\+N\+S\+I().


\begin{DoxyCode}
92                                                                  \{
93 
94   \textcolor{keywordflow}{if}(flvi > flvj)\{
95     cout << \textcolor{stringliteral}{"First argument should be smaller or equal to second argument"} << endl;
96     cout << \textcolor{stringliteral}{"Setting reverse order (Eps\_"} << flvj << flvi << \textcolor{stringliteral}{"). "} << endl;
97     \textcolor{keywordtype}{int} temp = flvi;
98     flvi = flvj;
99     flvj = temp;
100   \}
101   \textcolor{keywordflow}{if}(flvi<0 || flvi>2 || flvj < flvi || flvj > 2)\{
102     cout << \textcolor{stringliteral}{"Eps\_"} << flvi << flvj << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
103     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
104     \textcolor{keywordflow}{return};
105   \}
106 
107   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} h = val;  
108 
109   \textcolor{keywordflow}{if}(flvi != flvj) h *= \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(cos(phase), sin(phase)); 
110 
111   \textcolor{keywordtype}{bool} isSame = (\hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{fEps}[flvi][flvj] == h);
112   
113   \textcolor{keywordflow}{if}(!isSame) \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{ClearCache}();
114 
115   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= isSame;
116   
117   \hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{fEps}[flvi][flvj] = h;
118   
119 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a13ecb89c4d43924d23833a9e930f50e0}\label{classOscProb_1_1PMNS__NSI_a13ecb89c4d43924d23833a9e930f50e0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+ee@{Set\+Eps\+\_\+ee}}
\index{Set\+Eps\+\_\+ee@{Set\+Eps\+\_\+ee}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+ee()}{SetEps\_ee()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+ee (\begin{DoxyParamCaption}\item[{double}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+ee parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The value of the real parameter eps\+\_\+ee \\
\hline
\end{DoxyParams}


Definition at line 162 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
162 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,0, a, 0); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_ad5fccd151aea7c673c516b8686f8253c}\label{classOscProb_1_1PMNS__NSI_ad5fccd151aea7c673c516b8686f8253c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+emu@{Set\+Eps\+\_\+emu}}
\index{Set\+Eps\+\_\+emu@{Set\+Eps\+\_\+emu}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+emu()}{SetEps\_emu()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+emu (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{phi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+emu parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The absolute value of the parameter eps\+\_\+emu \\
\hline
{\em phi} & -\/ The phase of the complex parameter eps\+\_\+emu in radians \\
\hline
\end{DoxyParams}


Definition at line 196 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
196 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,1, a, phi); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a73d43e6d267975d1545af922f8e81bb3}\label{classOscProb_1_1PMNS__NSI_a73d43e6d267975d1545af922f8e81bb3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+etau@{Set\+Eps\+\_\+etau}}
\index{Set\+Eps\+\_\+etau@{Set\+Eps\+\_\+etau}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+etau()}{SetEps\_etau()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+etau (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{phi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+etau parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The absolute value of the parameter eps\+\_\+etau \\
\hline
{\em phi} & -\/ The phase of the complex parameter eps\+\_\+etau in radians \\
\hline
\end{DoxyParams}


Definition at line 208 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
208 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,2, a, phi); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_abf049db9904c745f04346d0d1dedf998}\label{classOscProb_1_1PMNS__NSI_abf049db9904c745f04346d0d1dedf998}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+mumu@{Set\+Eps\+\_\+mumu}}
\index{Set\+Eps\+\_\+mumu@{Set\+Eps\+\_\+mumu}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+mumu()}{SetEps\_mumu()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+mumu (\begin{DoxyParamCaption}\item[{double}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+mumu parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The value of the real parameter eps\+\_\+mumu \\
\hline
\end{DoxyParams}


Definition at line 173 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
173 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(1,1, a, 0); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_acfb9893697e04fcc25915ffaf8ed137f}\label{classOscProb_1_1PMNS__NSI_acfb9893697e04fcc25915ffaf8ed137f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+mutau@{Set\+Eps\+\_\+mutau}}
\index{Set\+Eps\+\_\+mutau@{Set\+Eps\+\_\+mutau}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+mutau()}{SetEps\_mutau()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+mutau (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{phi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+mutau parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The absolute value of the parameter eps\+\_\+mutau \\
\hline
{\em phi} & -\/ The phase of the complex parameter eps\+\_\+mutau in radians \\
\hline
\end{DoxyParams}


Definition at line 220 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
220 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(1,2, a, phi); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a5736f3cd792a621dfa844c3fa314cd17}\label{classOscProb_1_1PMNS__NSI_a5736f3cd792a621dfa844c3fa314cd17}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Eps\+\_\+tautau@{Set\+Eps\+\_\+tautau}}
\index{Set\+Eps\+\_\+tautau@{Set\+Eps\+\_\+tautau}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Eps\+\_\+tautau()}{SetEps\_tautau()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps\+\_\+tautau (\begin{DoxyParamCaption}\item[{double}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set eps\+\_\+tautau parameter

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em a} & -\/ The value of the real parameter eps\+\_\+tautau \\
\hline
\end{DoxyParams}


Definition at line 184 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().


\begin{DoxyCode}
184 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(2,2, a, 0); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a78983619968493630c48080bea9af05e}\label{classOscProb_1_1PMNS__NSI_a78983619968493630c48080bea9af05e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Ferm\+Coup@{Set\+Ferm\+Coup}}
\index{Set\+Ferm\+Coup@{Set\+Ferm\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Ferm\+Coup()}{SetFermCoup()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Ferm\+Coup (\begin{DoxyParamCaption}\item[{double}]{e,  }\item[{double}]{u,  }\item[{double}]{d }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the N\+SI relative couplings to each fermion. These factors represent what fraction of each fermion are seen by the interaction.


\begin{DoxyParams}{Parameters}
{\em e} & -\/ electron coupling strength \\
\hline
{\em u} & -\/ u-\/quark coupling strength \\
\hline
{\em d} & -\/ d-\/quark coupling strength \\
\hline
\end{DoxyParams}


Definition at line 315 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Down\+Coup(), Set\+Elec\+Coup(), and Set\+Up\+Coup().



Referenced by P\+M\+N\+S\+\_\+\+N\+S\+I().


\begin{DoxyCode}
316 \{
317 
318   \hyperlink{classOscProb_1_1PMNS__NSI_a8e07f5fe44e9ed471efa8e683584e2c7}{SetElecCoup}(e); \textcolor{comment}{// electron coupling}
319   \hyperlink{classOscProb_1_1PMNS__NSI_a27ecfa2a97c67e6bfb399eeba956f74f}{SetUpCoup}(u);   \textcolor{comment}{// u-quark coupling}
320   \hyperlink{classOscProb_1_1PMNS__NSI_abcc85b0662bd6d08fc5a0bc713657129}{SetDownCoup}(d); \textcolor{comment}{// d-quark coupling}
321   
322 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}\label{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}}
\index{Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Is\+Nu\+Bar()}{SetIsNuBar()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar (\begin{DoxyParamCaption}\item[{bool}]{is\+Nu\+Bar }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set anti-\/neutrino flag.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em is\+Nu\+Bar} & -\/ Set to true for anti-\/neutrino and false for neutrino. \\
\hline
\end{DoxyParams}


Definition at line 263 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
264 \{
265 
266   \textcolor{comment}{// Check if value is actually changing}
267   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} == isNuBar);
268 
269   \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} = isNuBar;
270 
271 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}\label{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Layers@{Set\+Layers}}
\index{Set\+Layers@{Set\+Layers}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Layers()}{SetLayers()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$}]{lay }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path layer indices.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em lay} & -\/ Indices to identify the layer types (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 605 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
605                                            \{
606 
607   vector<double> lay\_double(lay.begin(), lay.end());
608 
609   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(lay\_double, 3);
610 
611 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}\label{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the length for a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The length of the path segment in km \\
\hline
\end{DoxyParams}


Definition at line 444 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
444                                  \{
445 
446   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
447 
448 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}\label{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path lengths.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The lengths of the path segments in km \\
\hline
\end{DoxyParams}


Definition at line 560 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
560                                             \{
561 
562   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
563 
564 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}\label{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Max\+Cache@{Set\+Max\+Cache}}
\index{Set\+Max\+Cache@{Set\+Max\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Max\+Cache()}{SetMaxCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Max\+Cache (\begin{DoxyParamCaption}\item[{int}]{mc = {\ttfamily 1e6} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set maximum number of cached eigensystems. Finding eigensystems can become slow and take up memory. This protects the cache from becoming too large.


\begin{DoxyParams}{Parameters}
{\em mc} & -\/ Max cache size (default\+: 1e6) \\
\hline
\end{DoxyParams}


Definition at line 128 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache.


\begin{DoxyCode}
129 \{
130   \hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{fMaxCache} = mc;
131 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}\label{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Mix@{Set\+Mix}}
\index{Set\+Mix@{Set\+Mix}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Mix()}{SetMix()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix (\begin{DoxyParamCaption}\item[{double}]{th12,  }\item[{double}]{th23,  }\item[{double}]{th13,  }\item[{double}]{deltacp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set all mixing parameters at once. 
\begin{DoxyParams}{Parameters}
{\em th12} & -\/ The value of the mixing angle theta\+\_\+12 \\
\hline
{\em th23} & -\/ The value of the mixing angle theta\+\_\+23 \\
\hline
{\em th13} & -\/ The value of the mixing angle theta\+\_\+13 \\
\hline
{\em deltacp} & -\/ The value of the CP phase delta\+\_\+13 \\
\hline
\end{DoxyParams}


Definition at line 40 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta().


\begin{DoxyCode}
41 \{
42 
43   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, th12);
44   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,3, th13);
45   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(2,3, th23);
46   \hyperlink{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}{SetDelta}(1,3, deltacp);
47 
48 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_ae8829af10bc4051e8c74c8b1bc81c88c}\label{classOscProb_1_1PMNS__NSI_ae8829af10bc4051e8c74c8b1bc81c88c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+N\+SI@{Set\+N\+SI}}
\index{Set\+N\+SI@{Set\+N\+SI}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+N\+S\+I()}{SetNSI()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+N\+SI (\begin{DoxyParamCaption}\item[{double}]{eps\+\_\+ee,  }\item[{double}]{eps\+\_\+emu,  }\item[{double}]{eps\+\_\+etau,  }\item[{double}]{eps\+\_\+mumu,  }\item[{double}]{eps\+\_\+mutau,  }\item[{double}]{eps\+\_\+tautau,  }\item[{double}]{delta\+\_\+emu = {\ttfamily 0},  }\item[{double}]{delta\+\_\+etau = {\ttfamily 0},  }\item[{double}]{delta\+\_\+mutau = {\ttfamily 0} }\end{DoxyParamCaption})}

Set all N\+SI parameters at once.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em eps\+\_\+ee} & -\/ The real parameter eps\+\_\+ee \\
\hline
{\em eps\+\_\+emu} & -\/ The absolute value of the complex parameter eps\+\_\+emu \\
\hline
{\em eps\+\_\+etau} & -\/ The absolute value of the complex parameter eps\+\_\+etau \\
\hline
{\em eps\+\_\+mumu} & -\/ The real parameter eps\+\_\+mumu \\
\hline
{\em eps\+\_\+mutau} & -\/ The absolute value of the complex parameter eps\+\_\+mutau \\
\hline
{\em eps\+\_\+tautau} & -\/ The real parameter eps\+\_\+tautau \\
\hline
{\em delta\+\_\+emu} & -\/ The phase of the complex parameter eps\+\_\+emu in radians \\
\hline
{\em delta\+\_\+etau} & -\/ The phase of the complex parameter eps\+\_\+etau in radians \\
\hline
{\em delta\+\_\+mutau} & -\/ The phase of the complex parameter eps\+\_\+mutau in radians \\
\hline
\end{DoxyParams}


Definition at line 59 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Eps().



Referenced by P\+M\+N\+S\+\_\+\+N\+S\+I().


\begin{DoxyCode}
62 \{
63 
64   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,0, eps\_ee,     0);
65   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(1,1, eps\_mumu,   0);
66   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(2,2, eps\_tautau, 0);
67 
68   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,1, eps\_emu,   delta\_emu);
69   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(0,2, eps\_etau,  delta\_etau);
70   \hyperlink{classOscProb_1_1PMNS__NSI_a87c508149ea36b6de493a6817247a0ea}{SetEps}(1,2, eps\_mutau, delta\_mutau);
71 
72 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}\label{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 379 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().


\begin{DoxyCode}
379                                \{
380 
381   \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
382   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
383 
384 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}\label{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path defining attributes directly.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 397 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
397                                                                            \{
398 
399   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
400 
401 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}\label{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$}]{paths }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector of neutrino paths. 
\begin{DoxyParams}{Parameters}
{\em paths} & -\/ A sequence of neutrino paths \\
\hline
\end{DoxyParams}


Definition at line 330 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
330                                               \{
331 
332   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}=paths;
333 
334 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}\label{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Std\+Pars@{Set\+Std\+Pars}}
\index{Set\+Std\+Pars@{Set\+Std\+Pars}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Std\+Pars()}{SetStdPars()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard oscillation parameters from P\+DG 2015.

For two neutrinos, Dm is set to the muon disappearance effective mass-\/splitting and mixing angle. 

Definition at line 192 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
193 \{
194 
195   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}>2)\{
196     \textcolor{comment}{// PDG values for 3 neutrinos}
197     \textcolor{comment}{// Also applicable for 3+N neutrinos}
198     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, asin(sqrt(0.304)));
199     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,3, asin(sqrt(0.0219)));
200     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(2,3, asin(sqrt(0.514)));
201     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 7.53e-5);
202     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(3, 2.52e-3);
203   \}
204   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}==2)\{
205     \textcolor{comment}{// Effective muon disappearance values}
206     \textcolor{comment}{// for two-flavour approximation}
207     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, 0.788);
208     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 2.47e-3);
209   \}
210 
211 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}\label{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Std\+Path@{Set\+Std\+Path}}
\index{Set\+Std\+Path@{Set\+Std\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Std\+Path()}{SetStdPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard single path.

Length is 1000 km, so $\sim$2 GeV peak energy.

Density is approximate from C\+R\+U\+S\+T2.\+0 ($\sim$2.8 g/cm$^\wedge$3). Z/A is set to a round 0.\+5. 

Definition at line 222 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+P\+M\+N\+S\+\_\+\+Deco(), P\+M\+N\+S\+\_\+\+N\+S\+I(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
222                           \{
223 
224   \hyperlink{structOscProb_1_1NuPath}{NuPath} p;
225 
226   p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = 1000; \textcolor{comment}{// 1000 km default}
227   p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = 2.8;  \textcolor{comment}{// Crust density}
228   p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = 0.5;  \textcolor{comment}{// Crust Z/A}
229   p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = 0;    \textcolor{comment}{// Single layer}
230 
231   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(p);
232 
233 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a27ecfa2a97c67e6bfb399eeba956f74f}\label{classOscProb_1_1PMNS__NSI_a27ecfa2a97c67e6bfb399eeba956f74f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Up\+Coup@{Set\+Up\+Coup}}
\index{Set\+Up\+Coup@{Set\+Up\+Coup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Up\+Coup()}{SetUpCoup()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Up\+Coup (\begin{DoxyParamCaption}\item[{double}]{u }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the N\+SI relative coupling to u-\/quarks. This factor represents what fraction of the u-\/quarks are seen by the interaction.


\begin{DoxyParams}{Parameters}
{\em u} & -\/ u-\/quark coupling strength \\
\hline
\end{DoxyParams}


Definition at line 293 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Set\+Coup\+By\+Index().



Referenced by Set\+Ferm\+Coup().


\begin{DoxyCode}
293 \{ \hyperlink{classOscProb_1_1PMNS__NSI_a276d475bbebcdf24502a5555ee65b136}{SetCoupByIndex}(u, 1); \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}\label{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Use\+Cache@{Set\+Use\+Cache}}
\index{Set\+Use\+Cache@{Set\+Use\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Use\+Cache()}{SetUseCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Use\+Cache (\begin{DoxyParamCaption}\item[{bool}]{u = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Turn on/off caching of eigensystems. This can save a lot of C\+PU time by avoiding recomputing eigensystems if we\textquotesingle{}ve already seen them recently. Especially useful when running over multiple earth layers and even more if multiple baselines will be computed, e.\+g. for atmospheric neutrinos.


\begin{DoxyParams}{Parameters}
{\em u} & -\/ flag to set caching on (default\+: true) \\
\hline
\end{DoxyParams}


Definition at line 106 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
107 \{
108   \hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache} = u; 
109 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}\label{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+Vacuum\+Eigensystem@{Set\+Vacuum\+Eigensystem}}
\index{Set\+Vacuum\+Eigensystem@{Set\+Vacuum\+Eigensystem}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Vacuum\+Eigensystem()}{SetVacuumEigensystem()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the eigensystem to the analytic solution in vacuum.

We know the vacuum eigensystem, so just write it explicitly 

Definition at line 152 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
153 \{
154 
155   \textcolor{keywordtype}{double}  s12, s23, s13, c12, c23, c13;
156   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} idelta(0.0, \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[0][2]);
157   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) idelta = conj(idelta);
158 
159   s12 = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][1]);  s23 = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[1][2]);  s13 = sin(
      \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][2]);
160   c12 = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][1]);  c23 = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[1][2]);  c13 = cos(
      \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][2]);
161 
162   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][0] =  c12*c13;
163   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][1] =  s12*c13;
164   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][2] =  s13*exp(-idelta);
165 
166   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][0] = -s12*c23-c12*s23*s13*exp(idelta);
167   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][1] =  c12*c23-s12*s23*s13*exp(idelta);
168   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][2] =  s23*c13;
169 
170   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][0] =  s12*s23-c12*c23*s13*exp(idelta);
171   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][1] = -c12*s23-s12*c23*s13*exp(idelta);
172   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][2] =  c23*c13;
173 
174   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[0] = 0;
175   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[1] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[1] / (2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy});
176   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[2] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[2] / (2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy});
177 
178 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}\label{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{double}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path Z/A.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
\end{DoxyParams}


Definition at line 474 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
474                                 \{
475 
476   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
477 
478 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}\label{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path Z/A values.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segments \\
\hline
\end{DoxyParams}


Definition at line 590 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
590                                            \{
591 
592   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
593 
594 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}\label{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Solve\+Ham@{Solve\+Ham}}
\index{Solve\+Ham@{Solve\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Solve\+Ham()}{SolveHam()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Solve the full Hamiltonian for eigenvectors and eigenvalues.

This is using a method from the G\+Lo\+B\+ES software available at \href{http://www.mpi-hd.mpg.de/personalhomes/globes/3x3/}{\tt http\+://www.\+mpi-\/hd.\+mpg.\+de/personalhomes/globes/3x3/} ~\newline
We should cite them accordingly 

Implements \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 105 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and zheevh3().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path().


\begin{DoxyCode}
106 \{
107 
108   \textcolor{comment}{// Do vacuum oscillation in low density}
109   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} < 1.0e-6)\{
110     \hyperlink{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}{SetVacuumEigensystem}();
111     \textcolor{keywordflow}{return};
112   \}
113 
114   \textcolor{comment}{// Build Hamiltonian}
115   \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{BuildHms}();
116 
117   \textcolor{comment}{// Check if anything changed  }
118   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES}) \textcolor{keywordflow}{return};
119 
120   \textcolor{comment}{// Try caching if activated}
121   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}{TryCache}()) \textcolor{keywordflow}{return};
122 
123   \hyperlink{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}{UpdateHam}();
124 
125   \textcolor{keywordtype}{double} fEvalGLoBES[3];
126   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fEvecGLoBES[3][3];
127 
128   \textcolor{comment}{// Solve Hamiltonian for eigensystem using the GLoBES method}
129   \hyperlink{zheevh3_8cxx_a96ac4b39a8406951c69eeabad77a3bc6}{zheevh3}(\hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam},fEvecGLoBES,fEvalGLoBES);
130 
131   \textcolor{comment}{// Fill fEval and fEvec vectors from GLoBES arrays  }
132   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
133     \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] = fEvalGLoBES[i];
134     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
135       \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j] = fEvecGLoBES[i][j];
136     \}
137   \}
138   
139   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{true};
140 
141   \textcolor{comment}{// Fill cache if activated}
142   \hyperlink{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}{FillCache}();
143 
144 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}\label{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Try\+Cache@{Try\+Cache}}
\index{Try\+Cache@{Try\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Try\+Cache()}{TryCache()}}
{\footnotesize\ttfamily bool P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Try to find a cached version of this eigensystem. 

Definition at line 137 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache, and Osc\+Prob\+::\+Eigen\+Point\+::\+Set\+Vars().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
138 \{
139 
140   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache} && !\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.empty())\{
141 
142     \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_a2e293e0820715950ec8fb370e8cc9477}{SetVars}(\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy}, \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}, \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar});
143     
144     std::set<EigenPoint>::iterator it = \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.find(\hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe});
145 
146     \textcolor{keywordflow}{if}(it != \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.end())\{
147       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
148         \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] = (*it).fEval[i] * (*it).fEnergy / \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};
149         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
150           \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j] = (*it).fEvec[i][j];
151         \}
152       \}
153       \textcolor{keywordflow}{return} \textcolor{keyword}{true};
154     \}
155 
156   \}
157   
158   \textcolor{keywordflow}{return} \textcolor{keyword}{false};
159 
160 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_ab5c4f4644fbedb8835f6336c553805ce}\label{classOscProb_1_1PMNS__NSI_ab5c4f4644fbedb8835f6336c553805ce}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!Update\+Ham@{Update\+Ham}}
\index{Update\+Ham@{Update\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{Update\+Ham()}{UpdateHam()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Build the full Hamiltonian in matter

Here we divide the mass squared matrix Hms by the 2E to obtain the vacuum Hamiltonian in eV. Then, the matter potential is added to each flavour pair. 

Reimplemented from \hyperlink{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast}.



Definition at line 230 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, f\+Eps, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Get\+Zo\+A\+Coup(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Gf, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+K2, and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
231 \{
232 
233   \textcolor{keywordtype}{double} lv = 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};           \textcolor{comment}{// 2*E in eV }
234 
235   \textcolor{keywordtype}{double} kr2GNe   = \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{kK2}*M\_SQRT2*\hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{kGf} * \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density};
236   \textcolor{keywordtype}{double} kr2GNnsi = kr2GNe;
237 
238   kr2GNe   *= \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa};    \textcolor{comment}{// Std matter potential in eV}
239   kr2GNnsi *= \hyperlink{classOscProb_1_1PMNS__NSI_a42b2db6f2f42dbca7545a10d101a7950}{GetZoACoup}(); \textcolor{comment}{// NSI matter potential in eV}
240 
241   \textcolor{comment}{// Finish build Hamiltonian in matter with dimension of eV}
242   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
243     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=i;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
244       \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]/lv + kr2GNnsi*\hyperlink{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}{fEps}[i][j];
245       \textcolor{keywordflow}{else}          \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[i][j] = conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]/lv - kr2GNnsi*fEps[i][j]);
246     \}
247   \}
248   
249   \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[0][0] += kr2GNe;
250   \textcolor{keywordflow}{else}          \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[0][0] -= kr2GNe;
251 
252 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}\label{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Buffer@{f\+Buffer}}
\index{f\+Buffer@{f\+Buffer}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Buffer}{fBuffer}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Buffer\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 193 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}\label{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Built\+Hms@{f\+Built\+Hms}}
\index{f\+Built\+Hms@{f\+Built\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Built\+Hms}{fBuiltHms}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 204 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}\label{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Cache\+Prec@{f\+Cache\+Prec}}
\index{f\+Cache\+Prec@{f\+Cache\+Prec}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Cache\+Prec}{fCachePrec}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Cache\+Prec\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 208 of file P\+M\+N\+S\+\_\+\+Base.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}\label{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Delta@{f\+Delta}}
\index{f\+Delta@{f\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Delta}{fDelta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 187 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+State(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}\label{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Dm@{f\+Dm}}
\index{f\+Dm@{f\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Dm}{fDm}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 185 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}\label{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Energy@{f\+Energy}}
\index{f\+Energy@{f\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Energy}{fEnergy}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 198 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}\label{classOscProb_1_1PMNS__NSI_ab9328cb72e868b395f3efdd75b6af5e4}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Eps@{f\+Eps}}
\index{f\+Eps@{f\+Eps}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Eps}{fEps}}
{\footnotesize\ttfamily \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::f\+Eps\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 71 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+h.



Referenced by Get\+Eps(), Set\+Eps(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}\label{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Eval@{f\+Eval}}
\index{f\+Eval@{f\+Eval}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Eval}{fEval}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 195 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}\label{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Evec@{f\+Evec}}
\index{f\+Evec@{f\+Evec}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Evec}{fEvec}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 196 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}\label{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Got\+ES@{f\+Got\+ES}}
\index{f\+Got\+ES@{f\+Got\+ES}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Got\+ES}{fGotES}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 205 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Set\+Coup\+By\+Index(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Set\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}\label{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Ham@{f\+Ham}}
\index{f\+Ham@{f\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Ham}{fHam}}
{\footnotesize\ttfamily \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 62 of file P\+M\+N\+S\+\_\+\+Fast.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}\label{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Hms@{f\+Hms}}
\index{f\+Hms@{f\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Hms}{fHms}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 190 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}\label{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}}
\index{f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Is\+Nu\+Bar}{fIsNuBar}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 199 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}\label{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Max\+Cache@{f\+Max\+Cache}}
\index{f\+Max\+Cache@{f\+Max\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Max\+Cache}{fMaxCache}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 209 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Max\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}\label{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Mix\+Cache@{f\+Mix\+Cache}}
\index{f\+Mix\+Cache@{f\+Mix\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Mix\+Cache}{fMixCache}}
{\footnotesize\ttfamily std\+::set$<$\hyperlink{structOscProb_1_1EigenPoint}{Osc\+Prob\+::\+Eigen\+Point}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 211 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}\label{classOscProb_1_1PMNS__NSI_a1ac51957bbc4cec9fcfd8f816491cc95}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+N\+S\+Icoup@{f\+N\+S\+Icoup}}
\index{f\+N\+S\+Icoup@{f\+N\+S\+Icoup}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+N\+S\+Icoup}{fNSIcoup}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::f\+N\+S\+Icoup\mbox{[}3\mbox{]}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 73 of file P\+M\+N\+S\+\_\+\+N\+S\+I.\+h.



Referenced by Get\+Down\+Coup(), Get\+Elec\+Coup(), Get\+Up\+Coup(), Get\+Zo\+A\+Coup(), and Set\+Coup\+By\+Index().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}\label{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Num\+Nus@{f\+Num\+Nus}}
\index{f\+Num\+Nus@{f\+Num\+Nus}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Num\+Nus}{fNumNus}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 183 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Get\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Get\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Mass\+Eigenstate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), Set\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}\label{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Nu\+Paths@{f\+Nu\+Paths}}
\index{f\+Nu\+Paths@{f\+Nu\+Paths}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Nu\+Paths}{fNuPaths}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 201 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}\label{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Nu\+State@{f\+Nu\+State}}
\index{f\+Nu\+State@{f\+Nu\+State}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Nu\+State}{fNuState}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 189 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Mass\+Eigenstate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+State().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}\label{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Path@{f\+Path}}
\index{f\+Path@{f\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Path}{fPath}}
{\footnotesize\ttfamily \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 202 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Get\+Zo\+A\+Coup(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}\label{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Phases@{f\+Phases}}
\index{f\+Phases@{f\+Phases}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Phases}{fPhases}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Phases\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 192 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}\label{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Probe@{f\+Probe}}
\index{f\+Probe@{f\+Probe}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Probe}{fProbe}}
{\footnotesize\ttfamily \hyperlink{structOscProb_1_1EigenPoint}{Eigen\+Point} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 212 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}\label{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Theta@{f\+Theta}}
\index{f\+Theta@{f\+Theta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Theta}{fTheta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 186 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+State(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}\label{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!f\+Use\+Cache@{f\+Use\+Cache}}
\index{f\+Use\+Cache@{f\+Use\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{f\+Use\+Cache}{fUseCache}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 207 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Use\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}\label{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!k\+Ge\+V2eV@{k\+Ge\+V2eV}}
\index{k\+Ge\+V2eV@{k\+Ge\+V2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{k\+Ge\+V2eV}{kGeV2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV = 1.\+0e+09\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 138 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}\label{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!k\+Gf@{k\+Gf}}
\index{k\+Gf@{k\+Gf}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{k\+Gf}{kGf}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Gf = 1.\+1663787e-\/05\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 141 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}\label{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!k\+K2@{k\+K2}}
\index{k\+K2@{k\+K2}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{k\+K2}{kK2}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+K2 = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 137 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}\label{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!k\+Km2eV@{k\+Km2eV}}
\index{k\+Km2eV@{k\+Km2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{k\+Km2eV}{kKm2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV = 1.\+0 / 1.\+973269788e-\/10\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 136 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}\label{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!k\+NA@{k\+NA}}
\index{k\+NA@{k\+NA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{k\+NA}{kNA}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+NA = 6.\+022140857e23\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 139 of file P\+M\+N\+S\+\_\+\+Base.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}\label{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!one@{one}}
\index{one@{one}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{one}{one}}
{\footnotesize\ttfamily const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} P\+M\+N\+S\+\_\+\+Base\+::one\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 133 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}\label{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}!zero@{zero}}
\index{zero@{zero}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}}
\subsubsection{\texorpdfstring{zero}{zero}}
{\footnotesize\ttfamily const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} P\+M\+N\+S\+\_\+\+Base\+::zero\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 132 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Get\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__NSI_8h}{P\+M\+N\+S\+\_\+\+N\+S\+I.\+h}\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__NSI_8cxx}{P\+M\+N\+S\+\_\+\+N\+S\+I.\+cxx}\end{DoxyCompactItemize}
