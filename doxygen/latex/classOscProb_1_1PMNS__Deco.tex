\hypertarget{classOscProb_1_1PMNS__Deco}{}\section{Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+Deco Class Reference}
\label{classOscProb_1_1PMNS__Deco}\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}


Implementation of oscillations of neutrinos in matter in a three-\/neutrino framework with decoherence.  




{\ttfamily \#include $<$P\+M\+N\+S\+\_\+\+Deco.\+h$>$}

Inheritance diagram for Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+Deco\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classOscProb_1_1PMNS__Deco}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}
\item 
typedef std\+::vector$<$ \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row} $>$ \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classOscProb_1_1PMNS__Deco_a976dc43bb65547af5f4a27f5a8fccbba}{P\+M\+N\+S\+\_\+\+Deco} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classOscProb_1_1PMNS__Deco_a5539610ab44c510c204ae884fb8e2a0e}{$\sim$\+P\+M\+N\+S\+\_\+\+Deco} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_ac06a9c503d1c5b4a43c4eb797881898d}{Set\+Gamma} (int j, double val)
\begin{DoxyCompactList}\small\item\em Set any given decoherence parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_a1bc2d1fb1bab9841baa37eecc0135fe9}{Set\+Gamma32} (double val)
\begin{DoxyCompactList}\small\item\em Set the $\Gamma_{32}$ parameter. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_a35e79054682aa88c55f4350c29336014}{Set\+Deco\+Angle} (double th)
\begin{DoxyCompactList}\small\item\em Set the decoherence angle. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_afe7b8b9ae438d8b207bf75c2cfbb9fb8}{Set\+Power} (double n)
\begin{DoxyCompactList}\small\item\em Set the power index. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}{Get\+Gamma} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get any given decoherence parameter. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Deco_a5dadf6a39dec4a229babeff6a650179c}{Get\+Deco\+Angle} ()
\begin{DoxyCompactList}\small\item\em Get the decoherence angle. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Deco_aa40b92e0f204f499a24b18ba399b8b0e}{Get\+Power} ()
\begin{DoxyCompactList}\small\item\em Get the power index. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}{Set\+Mix} (double th12, double th23, double th13, double deltacp)
\begin{DoxyCompactList}\small\item\em Set the all mixing parameters at once. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}{Set\+Delta\+Msqrs} (double dm21, double dm32)
\begin{DoxyCompactList}\small\item\em Set both mass-\/splittings at once. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob} (int flvi, int flvf)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}{Prob} (int flvi, int flvf, double E)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}{Prob} (int flvi, int flvf, double E, double L)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E and distance L. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}{Avg\+Prob} (int flvi, int flvf, double E, double dE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of energy. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}{Avg\+Prob\+LoE} (int flvi, int flvf, double LoE, double d\+LoE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of L/E. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{Set\+Angle} (int i, int j, double th)
\begin{DoxyCompactList}\small\item\em Set the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}{Set\+Delta} (int i, int j, double delta)
\begin{DoxyCompactList}\small\item\em Set the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{Set\+Dm} (int j, double dm)
\begin{DoxyCompactList}\small\item\em Set the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}{Get\+Angle} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}{Get\+Delta} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}{Get\+Dm} (int j)
\begin{DoxyCompactList}\small\item\em Get the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}{Get\+Dm\+Eff} (int j)
\begin{DoxyCompactList}\small\item\em Get the effective mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}{Set\+Std\+Pars} ()
\begin{DoxyCompactList}\small\item\em Set P\+DG 3-\/flavor parameters. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{Set\+Energy} (double E)
\begin{DoxyCompactList}\small\item\em Set the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}{Set\+Is\+Nu\+Bar} (bool is\+Nu\+Bar)
\begin{DoxyCompactList}\small\item\em Set the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}{Get\+Energy} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}{Get\+Is\+Nu\+Bar} ()
\begin{DoxyCompactList}\small\item\em Get the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{Set\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}{Set\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}{Set\+Path} (std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ paths)
\begin{DoxyCompactList}\small\item\em Set a path sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{Add\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}{Add\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{Clear\+Path} ()
\begin{DoxyCompactList}\small\item\em Clear the path vector. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{Set\+Length} (double L)
\begin{DoxyCompactList}\small\item\em Set a single path lentgh in km. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}{Set\+Length} (std\+::vector$<$ double $>$ L)
\begin{DoxyCompactList}\small\item\em Set multiple path lengths. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}{Set\+Density} (double rho)
\begin{DoxyCompactList}\small\item\em Set single path density in g/cm$^\wedge$3. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}{Set\+Density} (std\+::vector$<$ double $>$ rho)
\begin{DoxyCompactList}\small\item\em Set multiple path densities. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}{Set\+ZoA} (double zoa)
\begin{DoxyCompactList}\small\item\em Set Z/A value for single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}{Set\+ZoA} (std\+::vector$<$ double $>$ zoa)
\begin{DoxyCompactList}\small\item\em Set multiple path Z/A values. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}{Set\+Layers} (std\+::vector$<$ int $>$ lay)
\begin{DoxyCompactList}\small\item\em Set multiple path layer indices. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{Set\+Std\+Path} ()
\begin{DoxyCompactList}\small\item\em Set standard neutrino path. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}{Get\+Path} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino path sequence. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{Get\+Sample\+Points} (double LoE, double d\+LoE)
\begin{DoxyCompactList}\small\item\em Compute the sample points for a bin of L/E with width d\+LoE. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}{Set\+Use\+Cache} (bool u=true)
\begin{DoxyCompactList}\small\item\em Set caching on/off. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{Clear\+Cache} ()
\begin{DoxyCompactList}\small\item\em Clear the cache. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}{Set\+Max\+Cache} (int mc=1e6)
\begin{DoxyCompactList}\small\item\em Set max cache size. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_a393940f176614e3ffebeea40cfe78a62}{Reset\+To\+Flavour} (int flv)
\begin{DoxyCompactList}\small\item\em Reset neutrino state to pure flavour flv. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Deco_aa75341a3608bb12d7792a14e67ef2d5e}{Propagate\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Propagate neutrino through a single path. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Deco_aa81f47ea36207b90a5feb9849060032d}{P} (int flv)
\begin{DoxyCompactList}\small\item\em Return the probability of final state in flavour flv. \end{DoxyCompactList}\item 
virtual \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} \hyperlink{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}{Dot} (\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} A, \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} B)
\item 
virtual \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} \hyperlink{classOscProb_1_1PMNS__Deco_aacc9909556ca22aca30620893e12b0db}{Mult} (\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} A, \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} B)
\item 
virtual \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} \hyperlink{classOscProb_1_1PMNS__Deco_aca391ff02be7abc2fd3dba40e9ce2665}{C\+Transp} (\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} A)
\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}{Update\+Ham} ()
\begin{DoxyCompactList}\small\item\em Build the full Hamiltonian. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}{Solve\+Ham} ()
\begin{DoxyCompactList}\small\item\em Solve the full Hamiltonian for eigenvectors and eigenvalues. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}{Set\+Vacuum\+Eigensystem} ()
\begin{DoxyCompactList}\small\item\em Set the eigensystem to the analytic solution of the vacuum Hamiltonian. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}{Initialize\+Vectors} ()
\begin{DoxyCompactList}\small\item\em Initialize all member vectors with zeros. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}{Try\+Cache} ()
\begin{DoxyCompactList}\small\item\em Try to find a cached eigensystem. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}{Fill\+Cache} ()
\begin{DoxyCompactList}\small\item\em Cache the current eigensystem. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{Set\+Cur\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set the path currently in use by the class. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{Set\+Att} (double att, int idx)
\begin{DoxyCompactList}\small\item\em Set one of the path attributes. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}{Set\+Att} (std\+::vector$<$ double $>$ att, int idx)
\begin{DoxyCompactList}\small\item\em Set all values of a path attribute. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH} (int i, int j)
\begin{DoxyCompactList}\small\item\em Rotate the Hamiltonian by theta\+\_\+ij and delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{Build\+Hms} ()
\begin{DoxyCompactList}\small\item\em Build the matrix of masses squared. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate} ()
\begin{DoxyCompactList}\small\item\em Propagate neutrino through full path. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{f\+Gamma} \mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em Stores each decoherence parameter. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}{f\+Power}
\begin{DoxyCompactList}\small\item\em Stores the power index parameter. \end{DoxyCompactList}\item 
\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{f\+Rho}
\begin{DoxyCompactList}\small\item\em The neutrino density matrix state. \end{DoxyCompactList}\item 
\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{f\+Ham} \mbox{[}3\mbox{]}\mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em The full hamiltonian. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{f\+Num\+Nus}
\begin{DoxyCompactList}\small\item\em Number of neutrino flavours. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{f\+Dm}
\begin{DoxyCompactList}\small\item\em m$^\wedge$2\+\_\+i -\/ m$^\wedge$2\+\_\+1 in vacuum \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{f\+Theta}
\begin{DoxyCompactList}\small\item\em theta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} mixing angle \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{f\+Delta}
\begin{DoxyCompactList}\small\item\em delta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} CP violating phase \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{f\+Nu\+State}
\begin{DoxyCompactList}\small\item\em The neutrino current state. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{f\+Hms}
\begin{DoxyCompactList}\small\item\em matrix H$\ast$2E in e\+V$^\wedge$2 \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{f\+Phases}
\begin{DoxyCompactList}\small\item\em Buffer for oscillation phases. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{f\+Buffer}
\begin{DoxyCompactList}\small\item\em Buffer for neutrino state tranformations. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{f\+Eval}
\begin{DoxyCompactList}\small\item\em Eigenvalues of the Hamiltonian. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{f\+Evec}
\begin{DoxyCompactList}\small\item\em Eigenvectors of the Hamiltonian. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{f\+Energy}
\begin{DoxyCompactList}\small\item\em Neutrino energy. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{f\+Is\+Nu\+Bar}
\begin{DoxyCompactList}\small\item\em Anti-\/neutrino flag. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{f\+Nu\+Paths}
\begin{DoxyCompactList}\small\item\em Vector of neutrino paths. \end{DoxyCompactList}\item 
\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{f\+Path}
\begin{DoxyCompactList}\small\item\em Current neutrino path. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{f\+Built\+Hms}
\begin{DoxyCompactList}\small\item\em Tag to avoid rebuilding Hms. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{f\+Got\+ES}
\begin{DoxyCompactList}\small\item\em Tag to avoid recalculating eigensystem. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{f\+Use\+Cache}
\begin{DoxyCompactList}\small\item\em Flag for whether to use caching. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}{f\+Cache\+Prec}
\begin{DoxyCompactList}\small\item\em Precision of cache matching. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{f\+Max\+Cache}
\begin{DoxyCompactList}\small\item\em Maximum cache size. \end{DoxyCompactList}\item 
std\+::set$<$ \hyperlink{structOscProb_1_1EigenPoint}{Osc\+Prob\+::\+Eigen\+Point} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{f\+Mix\+Cache}
\begin{DoxyCompactList}\small\item\em Caching set of eigensystems. \end{DoxyCompactList}\item 
\hyperlink{structOscProb_1_1EigenPoint}{Eigen\+Point} \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{f\+Probe}
\begin{DoxyCompactList}\small\item\em Eigenp\+Point to try. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}
\begin{DoxyCompactList}\small\item\em zero in complex \end{DoxyCompactList}\item 
static const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} \hyperlink{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}{one}
\begin{DoxyCompactList}\small\item\em one in complex \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{k\+Km2eV} = 1.\+0 / 1.\+973269788e-\/10
\begin{DoxyCompactList}\small\item\em km to e\+V$^\wedge$-\/1 \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{k\+K2} = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)
\begin{DoxyCompactList}\small\item\em mol/\+Ge\+V$^\wedge$2/cm$^\wedge$3 to eV \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{k\+Ge\+V2eV} = 1.\+0e+09
\begin{DoxyCompactList}\small\item\em GeV to eV. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}{k\+NA} = 6.\+022140857e23
\begin{DoxyCompactList}\small\item\em Avogadro constant. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{k\+Gf} = 1.\+1663787e-\/05
\begin{DoxyCompactList}\small\item\em G\+\_\+F in units of Ge\+V$^\wedge$-\/2. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class expands the \hyperlink{classOscProb_1_1PMNS__Fast}{P\+M\+N\+S\+\_\+\+Fast} class including a effects from decoherence in an increasing entropy and energy conserving model.

The model assumes a power law energy dependence of the decoherence parameters and that decoherence occurs in the effective mass basis.

\begin{DoxySeeAlso}{See also}
\hyperlink{classOscProb_1_1PMNS__Fast}{P\+M\+N\+S\+\_\+\+Fast}
\end{DoxySeeAlso}
\begin{DoxyAuthor}{Author}
coelho@lal.\+in2p3.\+fr 
\end{DoxyAuthor}


Definition at line 24 of file P\+M\+N\+S\+\_\+\+Deco.\+h.



\subsection{Member Typedef Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}\label{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!matrix@{matrix}}
\index{matrix@{matrix}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{matrix}{matrix}}
{\footnotesize\ttfamily typedef std\+::vector$<$\hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}$>$ \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::matrix}}



Definition at line 53 of file P\+M\+N\+S\+\_\+\+Deco.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}\label{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!row@{row}}
\index{row@{row}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{row}{row}}
{\footnotesize\ttfamily typedef std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::row}}



Definition at line 52 of file P\+M\+N\+S\+\_\+\+Deco.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a976dc43bb65547af5f4a27f5a8fccbba}\label{classOscProb_1_1PMNS__Deco_a976dc43bb65547af5f4a27f5a8fccbba}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!P\+M\+N\+S\+\_\+\+Deco@{P\+M\+N\+S\+\_\+\+Deco}}
\index{P\+M\+N\+S\+\_\+\+Deco@{P\+M\+N\+S\+\_\+\+Deco}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{P\+M\+N\+S\+\_\+\+Deco()}{PMNS\_Deco()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+Deco\+::\+P\+M\+N\+S\+\_\+\+Deco (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Constructor. \begin{DoxySeeAlso}{See also}
\hyperlink{classOscProb_1_1PMNS__Base_aa53e83b03a9cf4bdfa0a07136bd17a79}{P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base}
\end{DoxySeeAlso}
This class is restricted to 3 neutrino flavours. 

Definition at line 28 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References Set\+Deco\+Angle(), Set\+Gamma(), Set\+Power(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().


\begin{DoxyCode}
28                      : \hyperlink{classOscProb_1_1PMNS__Fast_a2bbac744bf63753105d766a860af7c0d}{PMNS\_Fast}(), \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}(),
29 \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}(3, \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}(3,0))
30 \{
31   \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
32   \hyperlink{classOscProb_1_1PMNS__Deco_ac06a9c503d1c5b4a43c4eb797881898d}{SetGamma}(2,0);
33   \hyperlink{classOscProb_1_1PMNS__Deco_ac06a9c503d1c5b4a43c4eb797881898d}{SetGamma}(3,0);
34   \hyperlink{classOscProb_1_1PMNS__Deco_a35e79054682aa88c55f4350c29336014}{SetDecoAngle}(0);
35   \hyperlink{classOscProb_1_1PMNS__Deco_afe7b8b9ae438d8b207bf75c2cfbb9fb8}{SetPower}(0);
36 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a5539610ab44c510c204ae884fb8e2a0e}\label{classOscProb_1_1PMNS__Deco_a5539610ab44c510c204ae884fb8e2a0e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!````~P\+M\+N\+S\+\_\+\+Deco@{$\sim$\+P\+M\+N\+S\+\_\+\+Deco}}
\index{````~P\+M\+N\+S\+\_\+\+Deco@{$\sim$\+P\+M\+N\+S\+\_\+\+Deco}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{$\sim$\+P\+M\+N\+S\+\_\+\+Deco()}{~PMNS\_Deco()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+Deco\+::$\sim$\+P\+M\+N\+S\+\_\+\+Deco (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Nothing to clean. 

Definition at line 42 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.


\begin{DoxyCode}
42 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}\label{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence. 
\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 351 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
351                                \{
352 
353   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.push\_back(p);
354 
355 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}\label{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence defining attributes directly. 
\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 365 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path().


\begin{DoxyCode}
365                                                                            \{
366 
367   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
368 
369 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}\label{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Avg\+Prob@{Avg\+Prob}}
\index{Avg\+Prob@{Avg\+Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Avg\+Prob()}{AvgProb()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{dE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of energy E with width dE.

This gets transformed into L/E, since the oscillation terms have arguments linear in L/E and not E.

This function currently only works for single paths.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in the bin center in GeV \\
\hline
{\em dE} & -\/ The energy bin width in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1215 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path().


\begin{DoxyCode}
1216 \{
1217 
1218   \textcolor{comment}{// Do nothing if energy is not positive}
1219   \textcolor{keywordflow}{if}(E<=0) \textcolor{keywordflow}{return} 0;
1220 
1221   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1222 
1223   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() != 1)\{
1224     cout << \textcolor{stringliteral}{"ERROR: AvgProb not implemented for multiple paths."} << endl;
1225     cout << \textcolor{stringliteral}{"       Returning probability at bin center."} << endl;
1226     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, E);
1227   \}
1228 
1229   \textcolor{comment}{// Don't average zero width}
1230   \textcolor{keywordflow}{if}(dE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, E);
1231 
1232   \textcolor{comment}{// Make sure fPath is set}
1233   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0]);
1234 
1235   \textcolor{comment}{// Define L/E variables}
1236   \textcolor{keywordtype}{double} LoE = 0;
1237   \textcolor{keywordtype}{double} dLoE = 0;
1238 
1239   \textcolor{comment}{// Set a minimum energy}
1240   \textcolor{keywordtype}{double} minE = 0.1 * E;
1241 
1242   \textcolor{comment}{// Transform range to L/E}
1243   \textcolor{comment}{// Full range if low edge > minE}
1244   \textcolor{keywordflow}{if}(E-dE/2 > minE)\{
1245     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1246     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1247   \}
1248   \textcolor{comment}{// Else start at minE}
1249   \textcolor{keywordflow}{else}\{
1250     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1251     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1252   \}
1253 
1254   \textcolor{comment}{// Compute average in LoE}
1255   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}{AvgProbLoE}(flvi, flvf, LoE, dLoE);
1256 
1257 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}\label{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Avg\+Prob\+LoE@{Avg\+Prob\+LoE}}
\index{Avg\+Prob\+LoE@{Avg\+Prob\+LoE}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Avg\+Prob\+Lo\+E()}{AvgProbLoE()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+LoE (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{LoE,  }\item[{double}]{d\+LoE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of L/E with width d\+LoE.

The probabilities are weighted by (L/E)$^\wedge$-\/2 so that event density is flat in energy. This avoids giving too much weight to low energies. Better approximations would be achieved if we used an interpolated event density.

This function currently only works for single paths.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1283 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob().


\begin{DoxyCode}
1284 \{
1285 
1286   \textcolor{comment}{// Do nothing if L/E is not positive}
1287   \textcolor{keywordflow}{if}(LoE<=0) \textcolor{keywordflow}{return} 0;
1288 
1289   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1290 
1291   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() > 1)\{
1292 
1293     cout << \textcolor{stringliteral}{"ERROR: AvgProb not implemented for multiple paths."} << endl;
1294     cout << \textcolor{stringliteral}{"       Returning probability at bin center."} << endl;
1295 
1296     \textcolor{keywordtype}{double} L = 0;
1297     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<int(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size()); i++)\{
1298       L += \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].length;
1299     \}
1300 
1301     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, L/LoE);
1302 
1303   \}
1304 
1305   \textcolor{comment}{// Make sure fPath is set}
1306   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0]);
1307 
1308   \textcolor{comment}{// Set the energy at bin center}
1309   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/LoE);
1310 
1311   \textcolor{comment}{// Don't average zero width}
1312   \textcolor{keywordflow}{if}(dLoE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1313 
1314   \textcolor{comment}{// Get sample points for this bin}
1315   vector<double> samples = \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{GetSamplePoints}(LoE, dLoE);
1316 
1317   \textcolor{comment}{// Variables to fill sample}
1318   \textcolor{comment}{// probabilities and weights}
1319   \textcolor{keywordtype}{double} sumw = 0;
1320   \textcolor{keywordtype}{double} prob = 0;
1321 
1322   \textcolor{comment}{// Loop over all sample points}
1323   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(samples.size()); j++)\{
1324 
1325     \textcolor{comment}{// Set (L/E)^-2 weights}
1326     \textcolor{keywordtype}{double} w = 1./pow(samples[j],2);
1327 
1328     \textcolor{comment}{// Add weighted probability}
1329     prob += w * \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length} / samples[j]);
1330 
1331     \textcolor{comment}{// Increment sum of weights}
1332     sumw += w;
1333 
1334   \}
1335 
1336   \textcolor{comment}{// Return weighted average of probabilities}
1337   \textcolor{keywordflow}{return} prob / sumw;
1338 
1339 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}\label{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Build\+Hms@{Build\+Hms}}
\index{Build\+Hms@{Build\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Build\+Hms()}{BuildHms()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Build Hms = H$\ast$2E, where H is the Hamiltonian in vacuum on flavour basis and E is the neutrino energy in eV. Hms is effectively the matrix of masses squared.

This is a hermitian matrix, so only the upper triangular part needs to be filled

The construction of the Hamiltonian avoids computing terms that are simply zero. This has a big impact in the computation time. 

Definition at line 984 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
985 \{
986 
987   \textcolor{comment}{// Check if anything changed}
988   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms}) \textcolor{keywordflow}{return};
989   
990   \textcolor{comment}{// Tag to recompute eigensystem}
991   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{false};
992 
993   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
994     \textcolor{comment}{// Set mass splitting}
995     \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j];
996     \textcolor{comment}{// Reset off-diagonal elements}
997     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
998       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = 0;
999     \}
1000     \textcolor{comment}{// Rotate j neutrinos}
1001     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
1002       \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH}(i,j);
1003     \}
1004   \}
1005 
1006   \hyperlink{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}{ClearCache}();
1007 
1008   \textcolor{comment}{// Tag as built}
1009   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} = \textcolor{keyword}{true};
1010 
1011 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}\label{classOscProb_1_1PMNS__Base_ac47fd33e69aa6490f99e2fd147a92f03}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Clear\+Cache@{Clear\+Cache}}
\index{Clear\+Cache@{Clear\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Clear\+Cache()}{ClearCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Clear the cache 

Definition at line 115 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Coup\+By\+Index(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps().


\begin{DoxyCode}
116 \{
117   \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.clear();
118 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}\label{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Clear\+Path@{Clear\+Path}}
\index{Clear\+Path@{Clear\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Clear\+Path()}{ClearPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Clear the path vector. 

Definition at line 319 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
319                          \{
320 
321   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.clear();
322 
323 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_aca391ff02be7abc2fd3dba40e9ce2665}\label{classOscProb_1_1PMNS__Deco_aca391ff02be7abc2fd3dba40e9ce2665}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!C\+Transp@{C\+Transp}}
\index{C\+Transp@{C\+Transp}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{C\+Transp()}{CTransp()}}
{\footnotesize\ttfamily \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{P\+M\+N\+S\+\_\+\+Deco\+::matrix} P\+M\+N\+S\+\_\+\+Deco\+::\+C\+Transp (\begin{DoxyParamCaption}\item[{\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}}]{A }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Conjugate transpose matrix.


\begin{DoxyParams}{Parameters}
{\em A} & -\/ input matrix A\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ $A^{\dagger}$ 
\end{DoxyReturn}


Definition at line 282 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



Referenced by Propagate\+Path().


\begin{DoxyCode}
283 \{
284 
285   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} out(3, \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}(3,0));
286   
287   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<3; i++)\{
288   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<3; j++)\{
289   
290     out[i][j] += conj(A[j][i]);
291 
292   \}\}
293   
294   \textcolor{keywordflow}{return} out;
295 
296 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}\label{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Dot@{Dot}}
\index{Dot@{Dot}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Dot()}{Dot()}}
{\footnotesize\ttfamily \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{P\+M\+N\+S\+\_\+\+Deco\+::matrix} P\+M\+N\+S\+\_\+\+Deco\+::\+Dot (\begin{DoxyParamCaption}\item[{\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}}]{A,  }\item[{\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}}]{B }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Dot product of two matrices.


\begin{DoxyParams}{Parameters}
{\em A} & -\/ input matrix A \\
\hline
{\em B} & -\/ input matrix B\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ matrix A.\+B 
\end{DoxyReturn}


Definition at line 234 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



Referenced by Propagate\+Path().


\begin{DoxyCode}
235 \{
236 
237   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} out(3, \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}(3,0));
238   
239   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<3; i++)\{
240   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<3; j++)\{
241   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<3; k++)\{
242 
243     out[i][j] += A[i][k] * B[k][j];
244 
245   \}\}\}
246   
247   \textcolor{keywordflow}{return} out;
248 
249 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}\label{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Fill\+Cache@{Fill\+Cache}}
\index{Fill\+Cache@{Fill\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Fill\+Cache()}{FillCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

If using caching, save the eigensystem in memory 

Definition at line 166 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Eigen\+Point\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+Eigen\+Point\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
167 \{
168 
169   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache})\{
170     \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.size()>\hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{fMaxCache})\{
171       \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.erase(\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.begin());
172       \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.erase(--\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.end());
173     \}
174     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
175       \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_a5c5e729d82e3aca1964c1777f4882f9d}{fEval}[i] = \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i];
176       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
177         \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_adf3ccb3d88ea1ae6ef3635fea8748e09}{fEvec}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j];
178       \}
179     \}
180     \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.insert(\hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe});
181   \}
182 
183 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}\label{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Angle@{Get\+Angle}}
\index{Get\+Angle@{Get\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Angle()}{GetAngle()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 658 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.


\begin{DoxyCode}
659 \{
660 
661   \textcolor{keywordflow}{if}(i>j)\{
662     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
663     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
664     \textcolor{keywordtype}{int} temp = i;
665     i = j;
666     j = temp;
667   \}
668   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
669     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
670     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
671     \textcolor{keywordflow}{return} 0;
672   \}
673 
674   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1];
675 
676 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a5dadf6a39dec4a229babeff6a650179c}\label{classOscProb_1_1PMNS__Deco_a5dadf6a39dec4a229babeff6a650179c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Deco\+Angle@{Get\+Deco\+Angle}}
\index{Get\+Deco\+Angle@{Get\+Deco\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Deco\+Angle()}{GetDecoAngle()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Deco\+::\+Get\+Deco\+Angle (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the decoherence angle value. 

Definition at line 167 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Gamma.


\begin{DoxyCode}
168 \{
169 
170   \textcolor{keywordflow}{return} acos(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0]);
171   
172 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}\label{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Delta@{Get\+Delta}}
\index{Get\+Delta@{Get\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Delta()}{GetDelta()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 728 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
729 \{
730 
731   \textcolor{keywordflow}{if}(i>j)\{
732     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
733     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
734     \textcolor{keywordtype}{int} temp = i;
735     i = j;
736     j = temp;
737   \}
738   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
739     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
740     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
741     \textcolor{keywordflow}{return} 0;
742   \}
743   \textcolor{keywordflow}{if}(i+1==j)\{
744     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Returning zero."} << endl;
745     \textcolor{keywordflow}{return} 0;
746   \}
747 
748   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1];
749 
750 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}\label{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Dm@{Get\+Dm}}
\index{Get\+Dm@{Get\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Dm()}{GetDm()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm (\begin{DoxyParamCaption}\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 788 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
789 \{
790 
791   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
792     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
793     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
794     \textcolor{keywordflow}{return} 0;
795   \}
796 
797   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1];
798 
799 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}\label{classOscProb_1_1PMNS__Base_a4ea861a6707ce1be3a54aad2b60f8632}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Dm\+Eff@{Get\+Dm\+Eff}}
\index{Get\+Dm\+Eff@{Get\+Dm\+Eff}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Dm\+Eff()}{GetDmEff()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff (\begin{DoxyParamCaption}\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the effective mass-\/splitting dm\+\_\+j1 in matter in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 809 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().


\begin{DoxyCode}
810 \{
811 
812   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
813     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
814     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
815     \textcolor{keywordflow}{return} 0;
816   \}
817 
818   \textcolor{comment}{// Solve the Hamiltonian to update eigenvalues}
819   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
820   
821   \textcolor{comment}{// Sort eigenvalues in same order as vacuum Dm^2}
822   vector<int> TrueIdx(fNumNus, 0);
823   vector<double> TrueVals(fNumNus, 0);
824   vector<int> EffIdx(fNumNus, 0);
825   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
826     TrueIdx[i] = i;
827     EffIdx[i] = i;
828   \}
829   sort(TrueIdx.begin(), TrueIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}));
830   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++) TrueVals[i] = TrueIdx[i];
831   sort(TrueIdx.begin(), TrueIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(TrueVals));
832   sort(EffIdx.begin(), EffIdx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}));
833 
834   \textcolor{comment}{// Return eigenvalues * 2E}
835   \textcolor{keywordflow}{return} (\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[EffIdx[TrueIdx[j-1]]] - \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[EffIdx[TrueIdx[0]]]) * 
      \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} * 2e9;
836 
837 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}\label{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Energy@{Get\+Energy}}
\index{Get\+Energy@{Get\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Energy()}{GetEnergy()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the neutrino energy in GeV. 

Definition at line 277 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy.


\begin{DoxyCode}
277                             \{
278 
279   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};
280 
281 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}\label{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Gamma@{Get\+Gamma}}
\index{Get\+Gamma@{Get\+Gamma}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Gamma()}{GetGamma()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Deco\+::\+Get\+Gamma (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get any given decoherence parameter.

Requires that i $>$ j. Will notify you if input is wrong. If i $<$ j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i} & -\/ The first mass index \\
\hline
{\em j} & -\/ The second mass index \\
\hline
\end{DoxyParams}


Definition at line 195 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Gamma, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Propagate\+Path(), and Set\+Gamma32().


\begin{DoxyCode}
196 \{
197 
198   \textcolor{keywordflow}{if}(i < j)\{
199     cout << \textcolor{stringliteral}{"First argument should be larger than second argument"} << endl;
200     cout << \textcolor{stringliteral}{"Setting reverse order (Gamma\_"} << j << i << \textcolor{stringliteral}{"). "} << endl;
201     \textcolor{keywordtype}{int} temp = i;
202     i = j;
203     j = temp;
204   \}
205   \textcolor{keywordflow}{if}(i<1 || i>3 || i <= j || j < 1)\{
206     cout << \textcolor{stringliteral}{"Gamma\_"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
207     cout << \textcolor{stringliteral}{" neutrinos. Returning 0."} << endl;
208     \textcolor{keywordflow}{return} 0;
209   \}
210 
211   \textcolor{keywordflow}{if}(j == 1)\{ 
212     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[i-1];
213   \}
214   \textcolor{keywordflow}{else} \{
215     \textcolor{comment}{// Combine Gamma31, Gamma21 and an angle (fGamma[0] = cos(th)) to make Gamma32}
216     \textcolor{keywordtype}{double} arg = \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1] * ( 4*\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[2] - \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]*(1 - pow(
      \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2)) );
217     
218     \textcolor{keywordflow}{if}(arg < 0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1] - 3*\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[2];
219 
220     \textcolor{keywordflow}{return} fGamma[2] + fGamma[1]*pow(fGamma[0],2) - fGamma[0] * sqrt(arg);
221 
222   \}
223 
224 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}\label{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}}
\index{Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Is\+Nu\+Bar()}{GetIsNuBar()}}
{\footnotesize\ttfamily bool P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the anti-\/neutrino flag. 

Definition at line 287 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.


\begin{DoxyCode}
287                            \{
288 
289   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar};
290 
291 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}\label{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Path@{Get\+Path}}
\index{Get\+Path@{Get\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Path()}{GetPath()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1NuPath}{Nu\+Path} $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the vector of neutrino paths. 

Definition at line 340 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
340                                  \{
341 
342   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths};
343 
344 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_aa40b92e0f204f499a24b18ba399b8b0e}\label{classOscProb_1_1PMNS__Deco_aa40b92e0f204f499a24b18ba399b8b0e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Power@{Get\+Power}}
\index{Get\+Power@{Get\+Power}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Power()}{GetPower()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Deco\+::\+Get\+Power (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Get the power index for energy dependence. 

Definition at line 178 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Power.


\begin{DoxyCode}
179 \{
180 
181   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}{fPower};
182   
183 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}\label{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Get\+Sample\+Points@{Get\+Sample\+Points}}
\index{Get\+Sample\+Points@{Get\+Sample\+Points}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Get\+Sample\+Points()}{GetSamplePoints()}}
{\footnotesize\ttfamily vector$<$ double $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points (\begin{DoxyParamCaption}\item[{double}]{LoE,  }\item[{double}]{d\+LoE }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the sample points for a bin of L/E with width d\+LoE

This is used for averaging the probability over a bin of L/E. It should be a private function, but I\textquotesingle{}m keeping it public for now for debugging purposes. The number of sample points seems too high for most purposes. The number of subdivisions needs to be optimized.


\begin{DoxyParams}{Parameters}
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV \\
\hline
\end{DoxyParams}


Definition at line 1354 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E().


\begin{DoxyCode}
1355 \{
1356 
1357   \textcolor{comment}{// Solve Hamiltonian to get eigenvalues}
1358   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
1359 
1360   \textcolor{comment}{// Define conversion factor [km/GeV -> 1/(4 eV^2)]}
1361   \textcolor{keyword}{const} \textcolor{keywordtype}{double} k1267 = \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} / (4 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV});
1362 
1363   \textcolor{comment}{// Get list of all effective Dm^2}
1364   vector<double> effDm;
1365 
1366   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1; i++)\{
1367     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=i+1; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
1368       effDm.push\_back( 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV} * \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} * fabs(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[j] - 
      \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i]) );
1369     \}
1370   \}
1371 
1372   \textcolor{keywordtype}{int} numDm = effDm.size();
1373 
1374   \textcolor{comment}{// Set a number of sub-divisions to achieve "good" accuracy}
1375   \textcolor{comment}{// This needs to be studied better}
1376   \textcolor{keywordtype}{int} n\_div = ceil( 20 * pow(dLoE/LoE,0.8) );
1377   \textcolor{comment}{//int n\_div = 1;}
1378 
1379   \textcolor{comment}{// A vector to store sample points}
1380   vector<double> allSamples;
1381 
1382   \textcolor{comment}{// Loop over sub-divisions}
1383   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<n\_div; k++)\{
1384 
1385     \textcolor{comment}{// Define sub-division center and width}
1386     \textcolor{keywordtype}{double} bctr = LoE - dLoE/2 + (k+0.5)*dLoE/n\_div;
1387     \textcolor{keywordtype}{double} bwdt = dLoE/n\_div;
1388 
1389     \textcolor{comment}{// Make a list of indices sorted by Dm^2 value}
1390     vector<int> Idx(numDm, 0);
1391     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<numDm; i++) Idx[i] = i;
1392     sort(Idx.begin(), Idx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(effDm));
1393 
1394     \textcolor{comment}{// Make a vector of L/E sample values}
1395     \textcolor{comment}{// Initialized in the sub-division center}
1396     vector<double> samples;
1397     samples.push\_back(bctr);
1398 
1399     \textcolor{comment}{// Loop over all Dm^2 to average each frequency}
1400     \textcolor{comment}{// This will recursively sample points in smaller}
1401     \textcolor{comment}{// bins so that all relevant frequencies are used}
1402     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<numDm; i++)\{
1403 
1404       \textcolor{comment}{// Copy the list of sample L/E values}
1405       vector<double> prev = samples;
1406 
1407       \textcolor{comment}{// Redefine bin width to lie within full sub-division}
1408       \textcolor{keywordtype}{double} Width = 2*min(prev[0] - (bctr - bwdt/2), (bctr + bwdt/2) - prev[0]);
1409 
1410       \textcolor{comment}{// Compute oscillation argument sorted from lowest  to highest}
1411       \textcolor{keyword}{const} \textcolor{keywordtype}{double} arg = k1267 * effDm[Idx[i]] * Width;
1412 
1413       \textcolor{comment}{// Skip small oscillation values.}
1414       \textcolor{comment}{// If it's the last one, lower the tolerance}
1415       \textcolor{keywordflow}{if}(i < numDm-1)\{
1416         \textcolor{keywordflow}{if}(arg<0.9) \textcolor{keywordflow}{continue};
1417       \}
1418       \textcolor{keywordflow}{else}\{
1419         \textcolor{keywordflow}{if}(arg<0.1) \textcolor{keywordflow}{continue};
1420       \}
1421 
1422       \textcolor{comment}{// Reset samples to redefine them}
1423       samples.clear();
1424 
1425       \textcolor{comment}{// Loop over previous samples}
1426       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(prev.size()); j++)\{
1427 
1428         \textcolor{comment}{// Compute new sample points around old samples}
1429         \textcolor{comment}{// This is based on a oscillatory quadrature rule}
1430         \textcolor{keywordtype}{double} sample = (1/sqrt(3)) * (Width/2);
1431         \textcolor{keywordflow}{if}(arg!=0) sample = acos(sin(arg)/arg)/arg * (Width/2);
1432 
1433         \textcolor{comment}{// Add samples above and below center}
1434         samples.push\_back(prev[j]-sample);
1435         samples.push\_back(prev[j]+sample);
1436 
1437       \}
1438 
1439     \}\textcolor{comment}{// End of loop over Dm^2}
1440 
1441     \textcolor{comment}{// Add sub-division samples to the end of allSamples vector}
1442     allSamples.insert(allSamples.end(), samples.begin(), samples.end());
1443 
1444   \}\textcolor{comment}{// End of loop over sub-divisions}
1445 
1446   \textcolor{comment}{// Return all sample points}
1447   \textcolor{keywordflow}{return} allSamples;
1448 
1449 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}\label{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Initialize\+Vectors@{Initialize\+Vectors}}
\index{Initialize\+Vectors@{Initialize\+Vectors}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Initialize\+Vectors()}{InitializeVectors()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector sizes and initialize elements to zero. 

Definition at line 78 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Buffer, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Phases, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
79 \{
80 
81   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}    = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
82   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
83   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
84 
85   \hyperlink{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}{fNuState} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
86   \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}     = vector< vector<complexD> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complexD>(
      \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},\hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}));
87 
88   \hyperlink{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}{fPhases} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
89   \hyperlink{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}{fBuffer} = vector<complexD>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero});
90 
91   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval} = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
92   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec} = vector< vector<complexD> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complexD>(
      \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},\hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero}));
93 
94 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_aacc9909556ca22aca30620893e12b0db}\label{classOscProb_1_1PMNS__Deco_aacc9909556ca22aca30620893e12b0db}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Mult@{Mult}}
\index{Mult@{Mult}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Mult()}{Mult()}}
{\footnotesize\ttfamily \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{P\+M\+N\+S\+\_\+\+Deco\+::matrix} P\+M\+N\+S\+\_\+\+Deco\+::\+Mult (\begin{DoxyParamCaption}\item[{\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}}]{A,  }\item[{\hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix}}]{B }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Product of elements of two matrices.


\begin{DoxyParams}{Parameters}
{\em A} & -\/ input matrix A \\
\hline
{\em B} & -\/ input matrix B\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ matrix A $\ast$ B 
\end{DoxyReturn}


Definition at line 259 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



Referenced by Propagate\+Path().


\begin{DoxyCode}
260 \{
261 
262   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} out(3, \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}(3,0));
263   
264   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<3; i++)\{
265   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<3; j++)\{
266   
267     out[i][j] += A[i][j] * B[i][j];
268 
269   \}\}
270   
271   \textcolor{keywordflow}{return} out;
272 
273 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_aa81f47ea36207b90a5feb9849060032d}\label{classOscProb_1_1PMNS__Deco_aa81f47ea36207b90a5feb9849060032d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!P@{P}}
\index{P@{P}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{P()}{P()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Deco\+::P (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Compute oscillation probability of flavour flv from current state

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Reimplemented from \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 409 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and f\+Rho.


\begin{DoxyCode}
410 \{
411   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
412   \textcolor{keywordflow}{return} std::abs(\hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}[flv][flv]);
413 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}\label{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1119 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1120 \{
1121 
1122   \textcolor{keywordflow}{if}(flvi < 0 || flvi >= \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
1123     cout << \textcolor{stringliteral}{"ERROR: Initial flavour not in range: 0 - "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 << endl;
1124   \}
1125   \textcolor{keywordflow}{if}(flvf < 0 || flvf >= \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
1126     cout << \textcolor{stringliteral}{"ERROR: Final flavour not in range: 0 - "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 << endl;
1127   \}
1128 
1129   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(flvi);
1130 
1131   \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate}();
1132 
1133   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{P}(flvf);
1134 
1135 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}\label{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1152 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().


\begin{DoxyCode}
1153 \{
1154 
1155   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1156 
1157   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1158 
1159 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}\label{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV and distance in km in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost.

Don\textquotesingle{}t use this if you want to propagate over multiple path segments.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV \\
\hline
{\em L} & -\/ The neutrino path length in km\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1183 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length().


\begin{DoxyCode}
1184 \{
1185 
1186   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1187   \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{SetLength}(L);
1188 
1189   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1190 
1191 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}\label{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Propagate@{Propagate}}
\index{Propagate@{Propagate}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Propagate()}{Propagate()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Propagate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Propagate neutrino state through full path 

Definition at line 1055 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
1056 \{
1057 
1058   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<int(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size()); i++)\{
1059 
1060     \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{PropagatePath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i]);
1061 
1062   \}
1063 
1064 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_aa75341a3608bb12d7792a14e67ef2d5e}\label{classOscProb_1_1PMNS__Deco_aa75341a3608bb12d7792a14e67ef2d5e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Propagate\+Path@{Propagate\+Path}}
\index{Propagate\+Path@{Propagate\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Propagate\+Path()}{PropagatePath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Propagate the current neutrino state through a given path


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 304 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References C\+Transp(), Dot(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, f\+Power, f\+Rho, Get\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, Osc\+Prob\+::\+Nu\+Path\+::length, Mult(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
305 \{
306 
307   \textcolor{comment}{// Set the neutrino path}
308   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(p);
309 
310   \textcolor{comment}{// Solve for eigensystem}
311   \hyperlink{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}{SolveHam}();
312   
313   \textcolor{comment}{// The code below is not pretty or optimised at all. Lots of matrix}
314   \textcolor{comment}{// multiplications are going on which could be otpimised due to }
315   \textcolor{comment}{// symmetry. The index sorting is also terrible. Needs improving.}
316 
317   \textcolor{comment}{// Store rotation matrices}
318   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} U = \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec};
319   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} Ut = \hyperlink{classOscProb_1_1PMNS__Deco_aca391ff02be7abc2fd3dba40e9ce2665}{CTransp}(\hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec});
320 
321   \textcolor{comment}{// Rotate to effective mass basis}
322   \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho} = \hyperlink{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}{Dot}(Ut, \hyperlink{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}{Dot}(\hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}, U));
323   
324   \textcolor{comment}{// Compute evolution matrix}
325   \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} evolve(3, \hyperlink{classOscProb_1_1PMNS__Deco_a430859c3da89582de577f8f7e75f2d16}{row}(3,1));
326   
327   \textcolor{comment}{// Some ugly way of matching gamma and dmsqr indices}
328   \textcolor{keywordtype}{int} maxdm = 0; 
329   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[1] > \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[maxdm]) maxdm = 1;
330   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[2] > \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[maxdm]) maxdm = 2;
331 
332   \textcolor{keywordtype}{int} mindm = 0; 
333   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[1] < \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[mindm]) mindm = 1;
334   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[2] < \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[mindm]) mindm = 2;
335 
336   \textcolor{keywordtype}{int} middm = 0;
337   \textcolor{keywordflow}{if}(middm == maxdm || middm == mindm) middm = 1; 
338   \textcolor{keywordflow}{if}(middm == maxdm || middm == mindm) middm = 2; 
339 
340   \textcolor{keywordtype}{int} maxev = 0; 
341   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[1] > \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[maxev]) maxev = 1;
342   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[2] > \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[maxev]) maxev = 2;
343 
344   \textcolor{keywordtype}{int} minev = 0; 
345   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[1] < \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[minev]) minev = 1;
346   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[2] < \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[minev]) minev = 2;
347 
348   \textcolor{keywordtype}{int} midev = 0;
349   \textcolor{keywordflow}{if}(midev == maxev || midev == minev) midev = 1; 
350   \textcolor{keywordflow}{if}(midev == maxev || midev == minev) midev = 2; 
351   
352   \textcolor{keywordtype}{int} idx[3];
353   idx[minev] = mindm;
354   idx[midev] = middm;
355   idx[maxev] = maxdm;
356   
357   \textcolor{keywordtype}{double} energyCorr = pow(\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy}, \hyperlink{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}{fPower});
358 
359   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<3; j++)\{ 
360   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
361     \textcolor{keywordtype}{double} gamma\_ij = \hyperlink{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}{GetGamma}(max(idx[i],idx[j])+1, min(idx[i],idx[j])+1) * energyCorr;
362     \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} arg = \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(gamma\_ij * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}, \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] - 
      \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[j]) * \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} * p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length};
363     evolve[i][j] = exp(-arg);
364     evolve[j][i] = exp(-conj(arg));
365   \}\}
366   
367   \textcolor{comment}{// Evolve density matrix}
368   \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho} = \hyperlink{classOscProb_1_1PMNS__Deco_aacc9909556ca22aca30620893e12b0db}{Mult}(\hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}, evolve);
369   
370   \textcolor{comment}{// Rotate back to flavour basis}
371   \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho} = \hyperlink{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}{Dot}(U, \hyperlink{classOscProb_1_1PMNS__Deco_a8d6b547de294c0d52d4208bde44fe171}{Dot}(\hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}, Ut));
372 
373 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a393940f176614e3ffebeea40cfe78a62}\label{classOscProb_1_1PMNS__Deco_a393940f176614e3ffebeea40cfe78a62}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Reset\+To\+Flavour@{Reset\+To\+Flavour}}
\index{Reset\+To\+Flavour@{Reset\+To\+Flavour}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Reset\+To\+Flavour()}{ResetToFlavour()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Reset the neutrino state back to a pure flavour where it starts

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino starting flavour. \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 386 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, f\+Rho, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::one, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.


\begin{DoxyCode}
387 \{
388   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
389   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; ++i)\{
390   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; ++j)\{
391     \textcolor{keywordflow}{if} (i==flv && i==j) \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}{one};
392     \textcolor{keywordflow}{else}                \hyperlink{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}{fRho}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}{zero};
393   \}\}
394 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}\label{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!RotateH@{RotateH}}
\index{RotateH@{RotateH}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Rotate\+H()}{RotateH()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+RotateH (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Rotate the Hamiltonian by the angle theta\+\_\+ij and phase delta\+\_\+ij.

The rotations assume all off-\/diagonal elements with i $>$ j are zero. This is correct if the order of rotations is chosen appropriately and it speeds up computation by skipping null terms


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of the rotation ij \\
\hline
\end{DoxyParams}


Definition at line 850 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms().


\begin{DoxyCode}
850                                   \{
851 
852   \textcolor{comment}{// Do nothing if angle is zero}
853   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]==0) \textcolor{keywordflow}{return};
854 
855   \textcolor{keywordtype}{double} fSinBuffer = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
856   \textcolor{keywordtype}{double} fCosBuffer = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
857 
858   \textcolor{keywordtype}{double}  fHmsBufferD;
859   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fHmsBufferC;
860 
861   \textcolor{comment}{// With Delta}
862   \textcolor{keywordflow}{if}(i+1<j)\{
863     \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fExpBuffer = \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}(cos(\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]), -sin(
      \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]));
864 
865     \textcolor{comment}{// General case}
866     \textcolor{keywordflow}{if}(i>0)\{
867       \textcolor{comment}{// Top columns}
868       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
869         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i];
870 
871         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] *= fCosBuffer;
872         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] * fSinBuffer * conj(fExpBuffer);
873 
874         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
875         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= fHmsBufferC * fSinBuffer * fExpBuffer;
876       \}
877 
878       \textcolor{comment}{// Middle row and column}
879       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
880         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j];
881 
882         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
883         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
884 
885         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] *= fCosBuffer;
886         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] += fSinBuffer * fExpBuffer * conj(fHmsBufferC);
887       \}
888 
889       \textcolor{comment}{// Nodes ij}
890       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i];
891       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j]);
892 
893       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
894       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer));
895       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] * fSinBuffer;
896 
897       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
898       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
899       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer));
900 
901       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] * conj(fExpBuffer)) * fSinBuffer * fExpBuffer;
902       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC) * fExpBuffer;
903 
904     \}
905     \textcolor{comment}{// First rotation on j (No top columns)}
906     \textcolor{keywordflow}{else}\{
907       \textcolor{comment}{// Middle rows and columns}
908       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
909         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] = -conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
910 
911         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][k] *= fCosBuffer;
912       \}
913 
914       \textcolor{comment}{// Nodes ij}
915       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i]);
916 
917       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = fSinBuffer * fCosBuffer * (\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] - fHmsBufferD) * fExpBuffer;
918 
919       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
920       fHms[i][i] += fSinBuffer * fHms[j][j] * fSinBuffer;
921 
922       fHms[j][j] *= fCosBuffer * fCosBuffer;
923       fHms[j][j] += fSinBuffer * fHmsBufferD * fSinBuffer;
924     \}
925 
926   \}
927   \textcolor{comment}{// Without Delta (No middle rows or columns: j = i+1)}
928   \textcolor{keywordflow}{else}\{
929     \textcolor{comment}{// General case}
930     \textcolor{keywordflow}{if}(i>0)\{
931       \textcolor{comment}{// Top columns}
932       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
933         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i];
934 
935         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] *= fCosBuffer;
936         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] * fSinBuffer;
937 
938         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] *= fCosBuffer;
939         \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[k][j] -= fHmsBufferC * fSinBuffer;
940       \}
941 
942       \textcolor{comment}{// Nodes ij}
943       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i];
944       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j]);
945 
946       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
947       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]);
948       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] * fSinBuffer;
949 
950       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
951       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
952       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]);
953 
954       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]) * fSinBuffer;
955       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC);
956 
957     \}
958     \textcolor{comment}{// First rotation (theta12)}
959     \textcolor{keywordflow}{else}\{
960 
961       \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j] = fSinBuffer * fCosBuffer * \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[j][j];
962 
963       fHms[i][i] = fSinBuffer * fHms[j][j] * fSinBuffer;
964 
965       fHms[j][j] *= fCosBuffer * fCosBuffer;
966 
967     \}
968   \}
969 
970 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}\label{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Angle@{Set\+Angle}}
\index{Set\+Angle@{Set\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Angle()}{SetAngle()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{th }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
{\em th} & -\/ the value of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 626 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
627 \{
628 
629   \textcolor{keywordflow}{if}(i>j)\{
630     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
631     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
632     \textcolor{keywordtype}{int} temp = i;
633     i = j;
634     j = temp;
635   \}
636   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
637     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
638     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
639     \textcolor{keywordflow}{return};
640   \}
641 
642   \textcolor{comment}{// Check if value is actually changing}
643   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] == th);
644 
645   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] = th;
646 
647 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}\label{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{double}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set some single path attribute.

An auxiliary function to set individual attributes in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The value of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 415 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Zo\+A().


\begin{DoxyCode}
415                                          \{
416 
417   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() != 1)\{
418 
419     cout << \textcolor{stringliteral}{"Warning: Clearing path vector and starting new single path."} << endl;
420     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
421 
422     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
423 
424   \}
425 
426   \textcolor{keywordflow}{switch}(idx)\{
427     \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].length  = att; \textcolor{keywordflow}{break};
428     \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].density = att; \textcolor{keywordflow}{break};
429     \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].zoa     = att; \textcolor{keywordflow}{break};
430     \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].layer   = att; \textcolor{keywordflow}{break};
431   \}
432 
433 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}\label{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set all values of a path attribute.

An auxiliary function to set individual attributes in a path sequence.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The values of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 492 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
492                                                     \{
493 
494   \textcolor{comment}{// Get the sizes of the attribute and}
495   \textcolor{comment}{// path sequence vectors}
496   \textcolor{keywordtype}{int} nA = att.size();
497   \textcolor{keywordtype}{int} nP = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size();
498 
499   \textcolor{comment}{// If the vector sizes are equal, update this attribute}
500   \textcolor{keywordflow}{if}(nA == nP)\{
501 
502     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nP; i++)\{
503 
504       \textcolor{keywordflow}{switch}(idx)\{
505         \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].length  = att[i]; \textcolor{keywordflow}{break};
506         \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].density = att[i]; \textcolor{keywordflow}{break};
507         \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].zoa     = att[i]; \textcolor{keywordflow}{break};
508         \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].layer   = att[i]; \textcolor{keywordflow}{break};
509       \}
510 
511     \}
512 
513   \}
514   \textcolor{comment}{// If the vector sizes differ, create a new path sequence}
515   \textcolor{comment}{// and set value for this attribute. Other attributes will}
516   \textcolor{comment}{// be taken from default single path.}
517   \textcolor{keywordflow}{else}\{
518 
519     cout << \textcolor{stringliteral}{"Warning: New vector size. Starting new path vector."} << endl;
520     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
521 
522     \textcolor{comment}{// Start a new standard path just}
523     \textcolor{comment}{// to set default values}
524     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
525 
526     \textcolor{comment}{// Create a path segment with default values}
527     \hyperlink{structOscProb_1_1NuPath}{NuPath} p = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0];
528 
529     \textcolor{comment}{// Clear the path sequence}
530     \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
531 
532     \textcolor{comment}{// Set this particular attribute's value}
533     \textcolor{comment}{// and add the path segment to the sequence}
534     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nA; i++)\{
535 
536       \textcolor{keywordflow}{switch}(idx)\{
537         \textcolor{keywordflow}{case} 0: p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = att[i]; \textcolor{keywordflow}{break};
538         \textcolor{keywordflow}{case} 1: p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = att[i]; \textcolor{keywordflow}{break};
539         \textcolor{keywordflow}{case} 2: p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = att[i]; \textcolor{keywordflow}{break};
540         \textcolor{keywordflow}{case} 3: p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = att[i]; \textcolor{keywordflow}{break};
541       \}
542 
543       \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
544 
545     \}
546 
547   \}
548 
549 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}\label{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Cur\+Path@{Set\+Cur\+Path}}
\index{Set\+Cur\+Path@{Set\+Cur\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Cur\+Path()}{SetCurPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the path currentlyin use by the class.

This will be used to know what path to propagate through next.

It will also check if values are changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 304 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().


\begin{DoxyCode}
305 \{
306 
307   \textcolor{comment}{// Check if relevant value are actually changing}
308   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} == p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density});
309   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa} == p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa});
310 
311   \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath} = p;
312 
313 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a35e79054682aa88c55f4350c29336014}\label{classOscProb_1_1PMNS__Deco_a35e79054682aa88c55f4350c29336014}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Deco\+Angle@{Set\+Deco\+Angle}}
\index{Set\+Deco\+Angle@{Set\+Deco\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Deco\+Angle()}{SetDecoAngle()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Deco\+Angle (\begin{DoxyParamCaption}\item[{double}]{th }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the decoherence angle. This will define the relationship\+:

$ \Gamma_{32} = \Gamma_{31} + \Gamma_{21} \cos^2\theta - \cos\theta \sqrt{\Gamma_{21} (4\Gamma_{31} - \Gamma_{21} (1 - \cos^2\theta))} $


\begin{DoxyParams}{Parameters}
{\em th} & -\/ decoherence angle \\
\hline
\end{DoxyParams}


Definition at line 138 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Gamma.



Referenced by P\+M\+N\+S\+\_\+\+Deco().


\begin{DoxyCode}
139 \{
140 
141   \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] = cos(th);
142   
143 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}\label{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Delta@{Set\+Delta}}
\index{Set\+Delta@{Set\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Delta()}{SetDelta()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
{\em delta} & -\/ the value of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 692 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix().


\begin{DoxyCode}
693 \{
694 
695   \textcolor{keywordflow}{if}(i>j)\{
696     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
697     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
698     \textcolor{keywordtype}{int} temp = i;
699     i = j;
700     j = temp;
701   \}
702   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
703     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
704     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
705     \textcolor{keywordflow}{return};
706   \}
707   \textcolor{keywordflow}{if}(i+1==j)\{
708     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Doing nothing."} << endl;
709     \textcolor{keywordflow}{return};
710   \}
711 
712   \textcolor{comment}{// Check if value is actually changing}
713   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] == delta);
714 
715   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] = delta;
716 
717 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}\label{classOscProb_1_1PMNS__Fast_a63733b246e6d2e609ce3de7a65ba5b9f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Delta\+Msqrs@{Set\+Delta\+Msqrs}}
\index{Set\+Delta\+Msqrs@{Set\+Delta\+Msqrs}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Delta\+Msqrs()}{SetDeltaMsqrs()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Delta\+Msqrs (\begin{DoxyParamCaption}\item[{double}]{dm21,  }\item[{double}]{dm32 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set both mass-\/splittings at once.

These are Dm\+\_\+21 and Dm\+\_\+32 in e\+V$^\wedge$2.~\newline
The corresponding Dm\+\_\+31 is set in the class attributes.


\begin{DoxyParams}{Parameters}
{\em dm21} & -\/ The solar mass-\/splitting Dm\+\_\+21 \\
\hline
{\em dm32} & -\/ The atmospheric mass-\/splitting Dm\+\_\+32 \\
\hline
\end{DoxyParams}


Definition at line 60 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().


\begin{DoxyCode}
61 \{
62 
63   \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, dm21);
64   \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(3, dm32 + dm21);
65 
66 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}\label{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{double}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path density.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 459 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
459                                     \{
460 
461   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
462 
463 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}\label{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path densities.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The densities of the path segments in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 575 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
575                                                \{
576 
577   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
578 
579 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}\label{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Dm@{Set\+Dm}}
\index{Set\+Dm@{Set\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Dm()}{SetDm()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{double}]{dm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
{\em dm} & -\/ the value of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 764 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Delta\+Msqrs(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
765 \{
766 
767   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
768     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
769     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
770     \textcolor{keywordflow}{return};
771   \}
772 
773   \textcolor{comment}{// Check if value is actually changing}
774   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] == dm);
775 
776   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] = dm;
777 
778 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}\label{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Energy@{Set\+Energy}}
\index{Set\+Energy@{Set\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Energy()}{SetEnergy()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy (\begin{DoxyParamCaption}\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set neutrino energy in GeV.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em E} & -\/ The neutrino energy in GeV \\
\hline
\end{DoxyParams}


Definition at line 244 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
245 \{
246 
247   \textcolor{comment}{// Check if value is actually changing}
248   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} == E);
249 
250   \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} = E;
251 
252 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_ac06a9c503d1c5b4a43c4eb797881898d}\label{classOscProb_1_1PMNS__Deco_ac06a9c503d1c5b4a43c4eb797881898d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Gamma@{Set\+Gamma}}
\index{Set\+Gamma@{Set\+Gamma}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Gamma()}{SetGamma()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Gamma (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{double}]{val }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the decoherence parameter $\Gamma_{j1}$.

Requires that j = 2 or 3. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ The first mass index \\
\hline
{\em val} & -\/ The absolute value of the parameter \\
\hline
\end{DoxyParams}


Definition at line 53 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Gamma, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by P\+M\+N\+S\+\_\+\+Deco().


\begin{DoxyCode}
53                                          \{
54 
55   \textcolor{keywordflow}{if}(j < 2 || j > 3)\{
56     cout << \textcolor{stringliteral}{"Gamma\_"} << j << 1 << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
57     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
58     \textcolor{keywordflow}{return};
59   \}
60 
61   \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[j-1] = val;
62   
63 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a1bc2d1fb1bab9841baa37eecc0135fe9}\label{classOscProb_1_1PMNS__Deco_a1bc2d1fb1bab9841baa37eecc0135fe9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Gamma32@{Set\+Gamma32}}
\index{Set\+Gamma32@{Set\+Gamma32}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Gamma32()}{SetGamma32()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Gamma32 (\begin{DoxyParamCaption}\item[{double}]{val }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the decoherence parameter $\Gamma_{32}$.

In practice, this sets $\Gamma_{31}$ internally via the formula\+:

$ \Gamma_{31} = \Gamma_{32} + \Gamma_{21} \cos^2\theta + \cos\theta \sqrt{\Gamma_{21} (4\Gamma_{32} - \Gamma_{21} (1 - \cos^2\theta))} $

I\+M\+P\+O\+R\+T\+A\+NT\+: Note this needs to be used A\+F\+T\+ER defining $\Gamma_{21}$ and $\theta$.


\begin{DoxyParams}{Parameters}
{\em val} & -\/ The absolute value of the parameter \\
\hline
\end{DoxyParams}


Definition at line 80 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Gamma, and Get\+Gamma().


\begin{DoxyCode}
80                                     \{
81 
82   \textcolor{keywordtype}{double} min32 = 0.25*\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1];
83 
84   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] >= 0) min32 *= 1 - pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2);
85   \textcolor{keywordflow}{else}               min32 *= 1 + 3*pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2);
86   
87   \textcolor{keywordflow}{if}(val < min32)\{
88     
89     \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0]>=0 || 4*val/\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1] < 1)\{
90       \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] = sqrt(1 - 4*val/\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]);
91       \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[2] = 0.25*\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]*(1 + 3*pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2));
92     \}
93     \textcolor{keywordflow}{else}\{
94       \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] = -sqrt((4*val/\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1] - 1)/3);
95       \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[2] = 0.25*\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]*(1 - pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2));
96     \}
97     
98     cout << \textcolor{stringliteral}{"WARNING: Impossible to have Gamma32 = "}        << val
99          << \textcolor{stringliteral}{" with current Gamma21 and theta parameters."}   << endl
100          << \textcolor{stringliteral}{"         Changing the value of cos(theta) to "} << \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] 
101          << endl;
102          
103     \textcolor{keywordflow}{return};
104          
105   \}
106 
107   \textcolor{keywordtype}{double} arg = \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1] * ( 4*val - \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]*(1 - pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2)) );
108 
109   \textcolor{keywordflow}{if}(arg < 0)\{
110     arg = 0;
111     \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] = sqrt(1 - 4*val/\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]);
112     cout << \textcolor{stringliteral}{"WARNING: Imaginary Gamma31 found. Changing the value of cos(theta) to "} 
113          << \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] << endl;
114   \}
115   
116   \textcolor{keywordtype}{double} gamma31 = val + \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[1]*pow(\hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0],2) + \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[0] * sqrt(arg);
117   
118   \hyperlink{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}{fGamma}[2] = gamma31;
119   
120   \textcolor{keywordflow}{if}(fabs(val - \hyperlink{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}{GetGamma}(3,2)) > 1e-6)\{
121     cout << \textcolor{stringliteral}{"ERROR: Failed sanity check: GetGamma(3,2) = "}
122          << \hyperlink{classOscProb_1_1PMNS__Deco_a73461e806063588a8e3a9d5d0dd201cb}{GetGamma}(3,2) << \textcolor{stringliteral}{" != "} << val << endl;
123   \}
124   
125 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}\label{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}}
\index{Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Is\+Nu\+Bar()}{SetIsNuBar()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar (\begin{DoxyParamCaption}\item[{bool}]{is\+Nu\+Bar }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set anti-\/neutrino flag.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em is\+Nu\+Bar} & -\/ Set to true for anti-\/neutrino and false for neutrino. \\
\hline
\end{DoxyParams}


Definition at line 263 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
264 \{
265 
266   \textcolor{comment}{// Check if value is actually changing}
267   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} == isNuBar);
268 
269   \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} = isNuBar;
270 
271 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}\label{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Layers@{Set\+Layers}}
\index{Set\+Layers@{Set\+Layers}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Layers()}{SetLayers()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$}]{lay }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path layer indices.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em lay} & -\/ Indices to identify the layer types (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 605 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
605                                            \{
606 
607   vector<double> lay\_double(lay.begin(), lay.end());
608 
609   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(lay\_double, 3);
610 
611 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}\label{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the length for a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The length of the path segment in km \\
\hline
\end{DoxyParams}


Definition at line 444 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
444                                  \{
445 
446   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
447 
448 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}\label{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path lengths.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The lengths of the path segments in km \\
\hline
\end{DoxyParams}


Definition at line 560 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
560                                             \{
561 
562   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
563 
564 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}\label{classOscProb_1_1PMNS__Base_ae67862cf58b0802487a14b047b012a78}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Max\+Cache@{Set\+Max\+Cache}}
\index{Set\+Max\+Cache@{Set\+Max\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Max\+Cache()}{SetMaxCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Max\+Cache (\begin{DoxyParamCaption}\item[{int}]{mc = {\ttfamily 1e6} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set maximum number of cached eigensystems. Finding eigensystems can become slow and take up memory. This protects the cache from becoming too large.


\begin{DoxyParams}{Parameters}
{\em mc} & -\/ Max cache size (default\+: 1e6) \\
\hline
\end{DoxyParams}


Definition at line 128 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache.


\begin{DoxyCode}
129 \{
130   \hyperlink{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}{fMaxCache} = mc;
131 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}\label{classOscProb_1_1PMNS__Fast_ad849b2231d99c5d66fb3ade8efb896e1}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Mix@{Set\+Mix}}
\index{Set\+Mix@{Set\+Mix}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Mix()}{SetMix()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix (\begin{DoxyParamCaption}\item[{double}]{th12,  }\item[{double}]{th23,  }\item[{double}]{th13,  }\item[{double}]{deltacp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set all mixing parameters at once. 
\begin{DoxyParams}{Parameters}
{\em th12} & -\/ The value of the mixing angle theta\+\_\+12 \\
\hline
{\em th23} & -\/ The value of the mixing angle theta\+\_\+23 \\
\hline
{\em th13} & -\/ The value of the mixing angle theta\+\_\+13 \\
\hline
{\em deltacp} & -\/ The value of the CP phase delta\+\_\+13 \\
\hline
\end{DoxyParams}


Definition at line 40 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta().


\begin{DoxyCode}
41 \{
42 
43   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, th12);
44   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,3, th13);
45   \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(2,3, th23);
46   \hyperlink{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}{SetDelta}(1,3, deltacp);
47 
48 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}\label{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 379 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().


\begin{DoxyCode}
379                                \{
380 
381   \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
382   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
383 
384 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}\label{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path defining attributes directly.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 397 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
397                                                                            \{
398 
399   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
400 
401 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}\label{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$}]{paths }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector of neutrino paths. 
\begin{DoxyParams}{Parameters}
{\em paths} & -\/ A sequence of neutrino paths \\
\hline
\end{DoxyParams}


Definition at line 330 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
330                                               \{
331 
332   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}=paths;
333 
334 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_afe7b8b9ae438d8b207bf75c2cfbb9fb8}\label{classOscProb_1_1PMNS__Deco_afe7b8b9ae438d8b207bf75c2cfbb9fb8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Power@{Set\+Power}}
\index{Set\+Power@{Set\+Power}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Power()}{SetPower()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Power (\begin{DoxyParamCaption}\item[{double}]{n }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Set the power index of the decoherence energy dependence. This will multiply the Gammas such that the final parameters are\+:

$ \Gamma_{ij} \rightarrow \Gamma_{ij} \times \left(\frac{E}{[1 \mbox{GeV}]}\right)^n $


\begin{DoxyParams}{Parameters}
{\em n} & -\/ power index \\
\hline
\end{DoxyParams}


Definition at line 156 of file P\+M\+N\+S\+\_\+\+Deco.\+cxx.



References f\+Power.



Referenced by P\+M\+N\+S\+\_\+\+Deco().


\begin{DoxyCode}
157 \{
158 
159   \hyperlink{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}{fPower} = n;
160   
161 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}\label{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Std\+Pars@{Set\+Std\+Pars}}
\index{Set\+Std\+Pars@{Set\+Std\+Pars}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Std\+Pars()}{SetStdPars()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard oscillation parameters from P\+DG 2015.

For two neutrinos, Dm is set to the muon disappearance effective mass-\/splitting and mixing angle. 

Definition at line 192 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
193 \{
194 
195   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}>2)\{
196     \textcolor{comment}{// PDG values for 3 neutrinos}
197     \textcolor{comment}{// Also applicable for 3+N neutrinos}
198     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, asin(sqrt(0.304)));
199     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,3, asin(sqrt(0.0219)));
200     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(2,3, asin(sqrt(0.514)));
201     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 7.53e-5);
202     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(3, 2.52e-3);
203   \}
204   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}==2)\{
205     \textcolor{comment}{// Effective muon disappearance values}
206     \textcolor{comment}{// for two-flavour approximation}
207     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, 0.788);
208     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 2.47e-3);
209   \}
210 
211 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}\label{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Std\+Path@{Set\+Std\+Path}}
\index{Set\+Std\+Path@{Set\+Std\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Std\+Path()}{SetStdPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard single path.

Length is 1000 km, so $\sim$2 GeV peak energy.

Density is approximate from C\+R\+U\+S\+T2.\+0 ($\sim$2.8 g/cm$^\wedge$3). Z/A is set to a round 0.\+5. 

Definition at line 222 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), P\+M\+N\+S\+\_\+\+Deco(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
222                           \{
223 
224   \hyperlink{structOscProb_1_1NuPath}{NuPath} p;
225 
226   p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = 1000; \textcolor{comment}{// 1000 km default}
227   p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = 2.8;  \textcolor{comment}{// Crust density}
228   p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = 0.5;  \textcolor{comment}{// Crust Z/A}
229   p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = 0;    \textcolor{comment}{// Single layer}
230 
231   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(p);
232 
233 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}\label{classOscProb_1_1PMNS__Base_aa94c1e1fff0ba731c75f7e633b023a9f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Use\+Cache@{Set\+Use\+Cache}}
\index{Set\+Use\+Cache@{Set\+Use\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Use\+Cache()}{SetUseCache()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Use\+Cache (\begin{DoxyParamCaption}\item[{bool}]{u = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Turn on/off caching of eigensystems. This can save a lot of C\+PU time by avoiding recomputing eigensystems if we\textquotesingle{}ve already seen them recently. Especially useful when running over multiple earth layers and even more if multiple baselines will be computed, e.\+g. for atmospheric neutrinos.


\begin{DoxyParams}{Parameters}
{\em u} & -\/ flag to set caching on (default\+: true) \\
\hline
\end{DoxyParams}


Definition at line 106 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
107 \{
108   \hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache} = u; 
109 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}\label{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+Vacuum\+Eigensystem@{Set\+Vacuum\+Eigensystem}}
\index{Set\+Vacuum\+Eigensystem@{Set\+Vacuum\+Eigensystem}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Vacuum\+Eigensystem()}{SetVacuumEigensystem()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the eigensystem to the analytic solution in vacuum.

We know the vacuum eigensystem, so just write it explicitly 

Definition at line 152 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
153 \{
154 
155   \textcolor{keywordtype}{double}  s12, s23, s13, c12, c23, c13;
156   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} idelta(0.0, \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[0][2]);
157   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) idelta = conj(idelta);
158 
159   s12 = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][1]);  s23 = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[1][2]);  s13 = sin(
      \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][2]);
160   c12 = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][1]);  c23 = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[1][2]);  c13 = cos(
      \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[0][2]);
161 
162   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][0] =  c12*c13;
163   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][1] =  s12*c13;
164   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[0][2] =  s13*exp(-idelta);
165 
166   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][0] = -s12*c23-c12*s23*s13*exp(idelta);
167   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][1] =  c12*c23-s12*s23*s13*exp(idelta);
168   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[1][2] =  s23*c13;
169 
170   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][0] =  s12*s23-c12*c23*s13*exp(idelta);
171   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][1] = -c12*s23-s12*c23*s13*exp(idelta);
172   \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[2][2] =  c23*c13;
173 
174   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[0] = 0;
175   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[1] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[1] / (2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy});
176   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[2] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[2] / (2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy});
177 
178 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}\label{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{double}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path Z/A.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
\end{DoxyParams}


Definition at line 474 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
474                                 \{
475 
476   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
477 
478 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}\label{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path Z/A values.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segments \\
\hline
\end{DoxyParams}


Definition at line 590 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
590                                            \{
591 
592   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
593 
594 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}\label{classOscProb_1_1PMNS__Fast_a8a0828401591e88c60e0051fbfe02d5e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Solve\+Ham@{Solve\+Ham}}
\index{Solve\+Ham@{Solve\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Solve\+Ham()}{SolveHam()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Solve the full Hamiltonian for eigenvectors and eigenvalues.

This is using a method from the G\+Lo\+B\+ES software available at \href{http://www.mpi-hd.mpg.de/personalhomes/globes/3x3/}{\tt http\+://www.\+mpi-\/hd.\+mpg.\+de/personalhomes/globes/3x3/} ~\newline
We should cite them accordingly 

Implements \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 105 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and zheevh3().



Referenced by Propagate\+Path().


\begin{DoxyCode}
106 \{
107 
108   \textcolor{comment}{// Do vacuum oscillation in low density}
109   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} < 1.0e-6)\{
110     \hyperlink{classOscProb_1_1PMNS__Fast_a76dd5a761df8689c502b28ad0391f9e2}{SetVacuumEigensystem}();
111     \textcolor{keywordflow}{return};
112   \}
113 
114   \textcolor{comment}{// Build Hamiltonian}
115   \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{BuildHms}();
116 
117   \textcolor{comment}{// Check if anything changed  }
118   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES}) \textcolor{keywordflow}{return};
119 
120   \textcolor{comment}{// Try caching if activated}
121   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}{TryCache}()) \textcolor{keywordflow}{return};
122 
123   \hyperlink{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}{UpdateHam}();
124 
125   \textcolor{keywordtype}{double} fEvalGLoBES[3];
126   \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} fEvecGLoBES[3][3];
127 
128   \textcolor{comment}{// Solve Hamiltonian for eigensystem using the GLoBES method}
129   \hyperlink{zheevh3_8cxx_a96ac4b39a8406951c69eeabad77a3bc6}{zheevh3}(\hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam},fEvecGLoBES,fEvalGLoBES);
130 
131   \textcolor{comment}{// Fill fEval and fEvec vectors from GLoBES arrays  }
132   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
133     \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] = fEvalGLoBES[i];
134     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
135       \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j] = fEvecGLoBES[i][j];
136     \}
137   \}
138   
139   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{true};
140 
141   \textcolor{comment}{// Fill cache if activated}
142   \hyperlink{classOscProb_1_1PMNS__Base_a785c37fcea974628623c8881bb0fbbf9}{FillCache}();
143 
144 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}\label{classOscProb_1_1PMNS__Base_abe533da5f64bec1f4724ab7b58606b77}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Try\+Cache@{Try\+Cache}}
\index{Try\+Cache@{Try\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Try\+Cache()}{TryCache()}}
{\footnotesize\ttfamily bool P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Try to find a cached version of this eigensystem. 

Definition at line 137 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache, and Osc\+Prob\+::\+Eigen\+Point\+::\+Set\+Vars().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
138 \{
139 
140   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}{fUseCache} && !\hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.empty())\{
141 
142     \hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe}.\hyperlink{structOscProb_1_1EigenPoint_a2e293e0820715950ec8fb370e8cc9477}{SetVars}(\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy}, \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}, \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar});
143     
144     std::set<EigenPoint>::iterator it = \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.find(\hyperlink{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}{fProbe});
145 
146     \textcolor{keywordflow}{if}(it != \hyperlink{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}{fMixCache}.end())\{
147       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; i++)\{
148         \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] = (*it).fEval[i] * (*it).fEnergy / \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};
149         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
150           \hyperlink{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}{fEvec}[i][j] = (*it).fEvec[i][j];
151         \}
152       \}
153       \textcolor{keywordflow}{return} \textcolor{keyword}{true};
154     \}
155 
156   \}
157   
158   \textcolor{keywordflow}{return} \textcolor{keyword}{false};
159 
160 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}\label{classOscProb_1_1PMNS__Fast_a16248082308f9d2c332ebf1be0aa90c3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!Update\+Ham@{Update\+Ham}}
\index{Update\+Ham@{Update\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{Update\+Ham()}{UpdateHam()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Build the full Hamiltonian in matter.

Here we divide the mass squared matrix Hms by the 2E to obtain the vacuum Hamiltonian in eV. Then, the matter potential is added to the electron component. 

Reimplemented in \hyperlink{classOscProb_1_1PMNS__NSI_ab5c4f4644fbedb8835f6336c553805ce}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+SI}.



Definition at line 76 of file P\+M\+N\+S\+\_\+\+Fast.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Gf, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+K2, and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
77 \{
78 
79   \textcolor{keywordtype}{double} lv = 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};     \textcolor{comment}{// 2E in eV }
80 
81   \textcolor{keywordtype}{double} kr2GNe = \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{kK2}*M\_SQRT2*\hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{kGf};
82   kr2GNe *= \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} * \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}; \textcolor{comment}{// Matter potential in eV}
83 
84   \textcolor{comment}{// Finish building Hamiltonian in matter with dimension of eV}
85   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
86     \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[i][i] = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][i]/lv;
87     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=i+1;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
88       \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j]/lv;
89       \textcolor{keywordflow}{else}          \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[i][j] = conj(\hyperlink{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}{fHms}[i][j])/lv;
90     \}
91   \}
92   \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[0][0] += kr2GNe;
93   \textcolor{keywordflow}{else}          \hyperlink{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}{fHam}[0][0] -= kr2GNe;
94 
95 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}\label{classOscProb_1_1PMNS__Base_a5440bc3efa466a37649601abce559e3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Buffer@{f\+Buffer}}
\index{f\+Buffer@{f\+Buffer}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Buffer}{fBuffer}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Buffer\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 175 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}\label{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Built\+Hms@{f\+Built\+Hms}}
\index{f\+Built\+Hms@{f\+Built\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Built\+Hms}{fBuiltHms}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 186 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}\label{classOscProb_1_1PMNS__Base_a0b4c41a27de281472453a1912cbc1e64}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Cache\+Prec@{f\+Cache\+Prec}}
\index{f\+Cache\+Prec@{f\+Cache\+Prec}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Cache\+Prec}{fCachePrec}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Cache\+Prec\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 190 of file P\+M\+N\+S\+\_\+\+Base.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}\label{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Delta@{f\+Delta}}
\index{f\+Delta@{f\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Delta}{fDelta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 169 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}\label{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Dm@{f\+Dm}}
\index{f\+Dm@{f\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Dm}{fDm}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 167 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}\label{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Energy@{f\+Energy}}
\index{f\+Energy@{f\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Energy}{fEnergy}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 180 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}\label{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Eval@{f\+Eval}}
\index{f\+Eval@{f\+Eval}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Eval}{fEval}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 177 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}\label{classOscProb_1_1PMNS__Base_a87be137356c5f27ab83cab5e1298ef8f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Evec@{f\+Evec}}
\index{f\+Evec@{f\+Evec}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Evec}{fEvec}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 178 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}\label{classOscProb_1_1PMNS__Deco_ae2f30ac9f8b25344959f1698616d337a}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Gamma@{f\+Gamma}}
\index{f\+Gamma@{f\+Gamma}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Gamma}{fGamma}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::f\+Gamma\mbox{[}3\mbox{]}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 69 of file P\+M\+N\+S\+\_\+\+Deco.\+h.



Referenced by Get\+Deco\+Angle(), Get\+Gamma(), Set\+Deco\+Angle(), Set\+Gamma(), and Set\+Gamma32().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}\label{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Got\+ES@{f\+Got\+ES}}
\index{f\+Got\+ES@{f\+Got\+ES}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Got\+ES}{fGotES}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 187 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Coup\+By\+Index(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}\label{classOscProb_1_1PMNS__Fast_a94286a881bc53dd512a89d548346b611}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Ham@{f\+Ham}}
\index{f\+Ham@{f\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Ham}{fHam}}
{\footnotesize\ttfamily \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::f\+Ham\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 62 of file P\+M\+N\+S\+\_\+\+Fast.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}\label{classOscProb_1_1PMNS__Base_acd3c8783e7603081eab316ea4c86c766}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Hms@{f\+Hms}}
\index{f\+Hms@{f\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Hms}{fHms}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 172 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}\label{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}}
\index{f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Is\+Nu\+Bar}{fIsNuBar}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 181 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}\label{classOscProb_1_1PMNS__Base_a74c13356eafec2490d8c3c19759ba7f0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Max\+Cache@{f\+Max\+Cache}}
\index{f\+Max\+Cache@{f\+Max\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Max\+Cache}{fMaxCache}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Max\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 191 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Max\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}\label{classOscProb_1_1PMNS__Base_a8159424f20197a3a7145fe3bf2c11176}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Mix\+Cache@{f\+Mix\+Cache}}
\index{f\+Mix\+Cache@{f\+Mix\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Mix\+Cache}{fMixCache}}
{\footnotesize\ttfamily std\+::set$<$\hyperlink{structOscProb_1_1EigenPoint}{Osc\+Prob\+::\+Eigen\+Point}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Mix\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 193 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}\label{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Num\+Nus@{f\+Num\+Nus}}
\index{f\+Num\+Nus@{f\+Num\+Nus}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Num\+Nus}{fNumNus}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 165 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm\+Eff(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Eps(), Get\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+P\+M\+N\+S\+\_\+\+Sterile(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps(), Set\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}\label{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Nu\+Paths@{f\+Nu\+Paths}}
\index{f\+Nu\+Paths@{f\+Nu\+Paths}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Nu\+Paths}{fNuPaths}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 183 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}\label{classOscProb_1_1PMNS__Base_abf99f2339e3ee989600740b5d88063e8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Nu\+State@{f\+Nu\+State}}
\index{f\+Nu\+State@{f\+Nu\+State}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Nu\+State}{fNuState}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 171 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}\label{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Path@{f\+Path}}
\index{f\+Path@{f\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Path}{fPath}}
{\footnotesize\ttfamily \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 184 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Zo\+A\+Coup(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}\label{classOscProb_1_1PMNS__Base_ab8d26b722047d49d977f5f2d83026ede}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Phases@{f\+Phases}}
\index{f\+Phases@{f\+Phases}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Phases}{fPhases}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Phases\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 174 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}\label{classOscProb_1_1PMNS__Deco_a19fdcdf9a8b2bd9677f72ca1fd77dc3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Power@{f\+Power}}
\index{f\+Power@{f\+Power}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Power}{fPower}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::f\+Power\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 70 of file P\+M\+N\+S\+\_\+\+Deco.\+h.



Referenced by Get\+Power(), Propagate\+Path(), and Set\+Power().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}\label{classOscProb_1_1PMNS__Base_ab1fe4800ee3ae48df4fc942dce00e0d3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Probe@{f\+Probe}}
\index{f\+Probe@{f\+Probe}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Probe}{fProbe}}
{\footnotesize\ttfamily \hyperlink{structOscProb_1_1EigenPoint}{Eigen\+Point} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Probe\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 194 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}\label{classOscProb_1_1PMNS__Deco_a0488d62b4ef4cf5b43425769f5fcdbdf}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Rho@{f\+Rho}}
\index{f\+Rho@{f\+Rho}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Rho}{fRho}}
{\footnotesize\ttfamily \hyperlink{classOscProb_1_1PMNS__Deco_a77b4e0c041b6268910a270be0f5387c9}{matrix} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::f\+Rho\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 72 of file P\+M\+N\+S\+\_\+\+Deco.\+h.



Referenced by P(), Propagate\+Path(), and Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}\label{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Theta@{f\+Theta}}
\index{f\+Theta@{f\+Theta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Theta}{fTheta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 168 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}\label{classOscProb_1_1PMNS__Base_ad28c12ef897b5555eda509ea55c99107}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!f\+Use\+Cache@{f\+Use\+Cache}}
\index{f\+Use\+Cache@{f\+Use\+Cache}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{f\+Use\+Cache}{fUseCache}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Use\+Cache\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 189 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Fill\+Cache(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Use\+Cache(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Try\+Cache().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}\label{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!k\+Ge\+V2eV@{k\+Ge\+V2eV}}
\index{k\+Ge\+V2eV@{k\+Ge\+V2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{k\+Ge\+V2eV}{kGeV2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV = 1.\+0e+09\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 121 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}\label{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!k\+Gf@{k\+Gf}}
\index{k\+Gf@{k\+Gf}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{k\+Gf}{kGf}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Gf = 1.\+1663787e-\/05\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 124 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}\label{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!k\+K2@{k\+K2}}
\index{k\+K2@{k\+K2}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{k\+K2}{kK2}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+K2 = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 120 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}\label{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!k\+Km2eV@{k\+Km2eV}}
\index{k\+Km2eV@{k\+Km2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{k\+Km2eV}{kKm2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV = 1.\+0 / 1.\+973269788e-\/10\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 119 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}\label{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!k\+NA@{k\+NA}}
\index{k\+NA@{k\+NA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{k\+NA}{kNA}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+NA = 6.\+022140857e23\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 122 of file P\+M\+N\+S\+\_\+\+Base.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}\label{classOscProb_1_1PMNS__Base_a7d1d0bbcab30a1fd8c368c40134c51ff}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!one@{one}}
\index{one@{one}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{one}{one}}
{\footnotesize\ttfamily const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} P\+M\+N\+S\+\_\+\+Base\+::one\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 116 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}\label{classOscProb_1_1PMNS__Base_a05e595848c2521dc795efa7645728b94}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}!zero@{zero}}
\index{zero@{zero}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}}
\subsubsection{\texorpdfstring{zero}{zero}}
{\footnotesize\ttfamily const \hyperlink{EigenPoint_8h_a67ca8e107e20610c3fff78d5e726ece0}{complexD} P\+M\+N\+S\+\_\+\+Base\+::zero\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 115 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__Deco_8h}{P\+M\+N\+S\+\_\+\+Deco.\+h}\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__Deco_8cxx}{P\+M\+N\+S\+\_\+\+Deco.\+cxx}\end{DoxyCompactItemize}
