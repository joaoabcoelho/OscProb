\hypertarget{zheevc3_8cxx}{}\section{/home/jcoelho/\+Osc\+Prob\+Git/\+Matrix\+Decomp/zheevc3.cxx File Reference}
\label{zheevc3_8cxx}\index{/home/jcoelho/\+Osc\+Prob\+Git/\+Matrix\+Decomp/zheevc3.\+cxx@{/home/jcoelho/\+Osc\+Prob\+Git/\+Matrix\+Decomp/zheevc3.\+cxx}}
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$complex$>$}\\*
{\ttfamily \#include \char`\"{}zheevc3.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{zheevc3_8cxx_a104a20eff010ec8c4f3af770e698860b}{M\+\_\+\+S\+Q\+R\+T3}~1.\+73205080756887729352744634151
\item 
\#define \hyperlink{zheevc3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(x)~((x)$\ast$(x))
\item 
\#define \hyperlink{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{S\+Q\+R\+\_\+\+A\+BS}(x)~(\hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(real(x)) + \hyperlink{zhetrd3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{S\+QR}(imag(x)))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{zheevc3_8cxx_a9ac76ac4ddaf7e2a513107356d1ed85e}{zheevc3} (std\+::complex$<$ double $>$ A\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, double w\mbox{[}3\mbox{]})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{zheevc3.\+cxx@{zheevc3.\+cxx}!M\+\_\+\+S\+Q\+R\+T3@{M\+\_\+\+S\+Q\+R\+T3}}
\index{M\+\_\+\+S\+Q\+R\+T3@{M\+\_\+\+S\+Q\+R\+T3}!zheevc3.\+cxx@{zheevc3.\+cxx}}
\subsubsection[{\texorpdfstring{M\+\_\+\+S\+Q\+R\+T3}{M_SQRT3}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+\_\+\+S\+Q\+R\+T3~1.\+73205080756887729352744634151}\hypertarget{zheevc3_8cxx_a104a20eff010ec8c4f3af770e698860b}{}\label{zheevc3_8cxx_a104a20eff010ec8c4f3af770e698860b}


Definition at line 25 of file zheevc3.\+cxx.



Referenced by zheevc3().

\index{zheevc3.\+cxx@{zheevc3.\+cxx}!S\+QR@{S\+QR}}
\index{S\+QR@{S\+QR}!zheevc3.\+cxx@{zheevc3.\+cxx}}
\subsubsection[{\texorpdfstring{S\+QR}{SQR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+QR(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~((x)$\ast$(x))}\hypertarget{zheevc3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{}\label{zheevc3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}


Definition at line 28 of file zheevc3.\+cxx.



Referenced by zheevc3().

\index{zheevc3.\+cxx@{zheevc3.\+cxx}!S\+Q\+R\+\_\+\+A\+BS@{S\+Q\+R\+\_\+\+A\+BS}}
\index{S\+Q\+R\+\_\+\+A\+BS@{S\+Q\+R\+\_\+\+A\+BS}!zheevc3.\+cxx@{zheevc3.\+cxx}}
\subsubsection[{\texorpdfstring{S\+Q\+R\+\_\+\+A\+BS}{SQR_ABS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+Q\+R\+\_\+\+A\+BS(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~({\bf S\+QR}(real(x)) + {\bf S\+QR}(imag(x)))}\hypertarget{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{}\label{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}


Definition at line 29 of file zheevc3.\+cxx.



Referenced by zheevc3().



\subsection{Function Documentation}
\index{zheevc3.\+cxx@{zheevc3.\+cxx}!zheevc3@{zheevc3}}
\index{zheevc3@{zheevc3}!zheevc3.\+cxx@{zheevc3.\+cxx}}
\subsubsection[{\texorpdfstring{zheevc3(std\+::complex$<$ double $>$ A[3][3], double w[3])}{zheevc3(std::complex< double > A[3][3], double w[3])}}]{\setlength{\rightskip}{0pt plus 5cm}int zheevc3 (
\begin{DoxyParamCaption}
\item[{std\+::complex$<$ double $>$}]{A\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, }
\item[{double}]{w\mbox{[}3\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{zheevc3_8cxx_a9ac76ac4ddaf7e2a513107356d1ed85e}{}\label{zheevc3_8cxx_a9ac76ac4ddaf7e2a513107356d1ed85e}


Definition at line 33 of file zheevc3.\+cxx.



References M\+\_\+\+S\+Q\+R\+T3, S\+QR, and S\+Q\+R\+\_\+\+A\+BS.



Referenced by zheevh3().


\begin{DoxyCode}
48 \{
49   \textcolor{keywordtype}{double} m, c1, c0;
50   
51   \textcolor{comment}{// Determine coefficients of characteristic poynomial. We write}
52   \textcolor{comment}{//       | a   d   f  |}
53   \textcolor{comment}{//  A =  | d*  b   e  |}
54   \textcolor{comment}{//       | f*  e*  c  |}
55   std::complex<double> de = A[0][1] * A[1][2];                            \textcolor{comment}{// d * e}
56   \textcolor{keywordtype}{double} dd = \hyperlink{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(A[0][1]);                                  \textcolor{comment}{// d * conj(d)}
57   \textcolor{keywordtype}{double} ee = \hyperlink{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(A[1][2]);                                  \textcolor{comment}{// e * conj(e)}
58   \textcolor{keywordtype}{double} ff = \hyperlink{zheevc3_8cxx_a3037777638f94ba01c4104dc03dfbf98}{SQR\_ABS}(A[0][2]);                                  \textcolor{comment}{// f * conj(f)}
59   m  = real(A[0][0]) + real(A[1][1]) + real(A[2][2]);
60   c1 = (real(A[0][0])*real(A[1][1])  \textcolor{comment}{// a*b + a*c + b*c - d*conj(d) - e*conj(e) - f*conj(f)}
61           + real(A[0][0])*real(A[2][2])
62           + real(A[1][1])*real(A[2][2]))
63           - (dd + ee + ff);
64   c0 = real(A[2][2])*dd + real(A[0][0])*ee + real(A[1][1])*ff
65             - real(A[0][0])*real(A[1][1])*real(A[2][2])
66             - 2.0 * (real(A[0][2])*real(de) + imag(A[0][2])*imag(de));
67                              \textcolor{comment}{// c*d*conj(d) + a*e*conj(e) + b*f*conj(f) - a*b*c - 2*Re(conj(f)*d*e)}
68 
69   \textcolor{keywordtype}{double} p, sqrt\_p, q, c, s, phi;
70   p = \hyperlink{zheevc3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{SQR}(m) - 3.0*c1;
71   q = m*(p - (3.0/2.0)*c1) - (27.0/2.0)*c0;
72   sqrt\_p = sqrt(fabs(p));
73 
74   phi = 27.0 * ( 0.25*\hyperlink{zheevc3_8cxx_aa7866fa5e4e0ee9b034e9dab6599a9cc}{SQR}(c1)*(p - c1) + c0*(q + 27.0/4.0*c0));
75   phi = (1.0/3.0) * atan2(sqrt(fabs(phi)), q);
76   
77   c = sqrt\_p*cos(phi);
78   s = (1.0/\hyperlink{zheevc3_8cxx_a104a20eff010ec8c4f3af770e698860b}{M\_SQRT3})*sqrt\_p*sin(phi);
79 
80   w[1]  = (1.0/3.0)*(m - c);
81   w[2]  = w[1] + s;
82   w[0]  = w[1] + c;
83   w[1] -= s;
84 
85   \textcolor{keywordflow}{return} 0;
86 \}
\end{DoxyCode}
