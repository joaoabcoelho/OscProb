<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OscProb: OscProb::EarthModelBinned Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OscProb
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classOscProb_1_1EarthModelBinned.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classOscProb_1_1EarthModelBinned-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">OscProb::EarthModelBinned Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements an earth model with depth/latitude/longitude bins.  
 <a href="classOscProb_1_1EarthModelBinned.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OscProb::EarthModelBinned:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classOscProb_1_1EarthModelBinned.png" usemap="#OscProb::EarthModelBinned_map" alt=""/>
  <map id="OscProb::EarthModelBinned_map" name="OscProb::EarthModelBinned_map">
<area href="classOscProb_1_1EarthModelBase.html" title="Base class for implementing an earth model." alt="OscProb::EarthModelBase" shape="rect" coords="0,56,172,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html">LatBinInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct holding information about upcoming latitude bin crossings along the neutrino's trajectory.  <a href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html">LonBinInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct holding information about upcoming longitude bin crossings along the neutrino's trajectory.  <a href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4614d7d1dc9e0dd02d1bc691a8bad767"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a4614d7d1dc9e0dd02d1bc691a8bad767">EarthModelBinned</a> (std::string filename=&quot;&quot;)</td></tr>
<tr class="memdesc:a4614d7d1dc9e0dd02d1bc691a8bad767"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classOscProb_1_1EarthModelBinned.html#a4614d7d1dc9e0dd02d1bc691a8bad767">More...</a><br /></td></tr>
<tr class="separator:a4614d7d1dc9e0dd02d1bc691a8bad767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fa46b95118c64834fbe21669e06ff60"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a1fa46b95118c64834fbe21669e06ff60">~EarthModelBinned</a> ()</td></tr>
<tr class="memdesc:a1fa46b95118c64834fbe21669e06ff60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classOscProb_1_1EarthModelBinned.html#a1fa46b95118c64834fbe21669e06ff60">More...</a><br /></td></tr>
<tr class="separator:a1fa46b95118c64834fbe21669e06ff60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c15aa64deadcd3e792c182d7ebd133"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a63c15aa64deadcd3e792c182d7ebd133">SetDetPos</a> (double rad, double lat=0, double lon=0)</td></tr>
<tr class="separator:a63c15aa64deadcd3e792c182d7ebd133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc141466f89062ca2f615a9f5407424"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a2cc141466f89062ca2f615a9f5407424">FillPath</a> (double cosT, double phi=0)</td></tr>
<tr class="separator:a2cc141466f89062ca2f615a9f5407424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a456945c25af7160616ed421228af41e9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a456945c25af7160616ed421228af41e9">LoadModel</a> (std::string filename)</td></tr>
<tr class="memdesc:a456945c25af7160616ed421228af41e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load an earth model from a file.  <a href="classOscProb_1_1EarthModelBinned.html#a456945c25af7160616ed421228af41e9">More...</a><br /></td></tr>
<tr class="separator:a456945c25af7160616ed421228af41e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e123ebaa3ee3a86259be16bcf22343"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a35e123ebaa3ee3a86259be16bcf22343">GetEarthBins</a> ()</td></tr>
<tr class="separator:a35e123ebaa3ee3a86259be16bcf22343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6576633bae966613e9eb07305c1c3aae"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a6576633bae966613e9eb07305c1c3aae">SetRegionZoA</a> (int index, double zoa)</td></tr>
<tr class="memdesc:a6576633bae966613e9eb07305c1c3aae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Z/A of all bins with specified region index.  <a href="classOscProb_1_1EarthModelBinned.html#a6576633bae966613e9eb07305c1c3aae">More...</a><br /></td></tr>
<tr class="separator:a6576633bae966613e9eb07305c1c3aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019bd087769bbd2958cf8bd6ef5b2092"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a019bd087769bbd2958cf8bd6ef5b2092">GetRegionZoA</a> (int index)</td></tr>
<tr class="memdesc:a019bd087769bbd2958cf8bd6ef5b2092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Z/A of all bins with specified region index.  <a href="classOscProb_1_1EarthModelBinned.html#a019bd087769bbd2958cf8bd6ef5b2092">More...</a><br /></td></tr>
<tr class="separator:a019bd087769bbd2958cf8bd6ef5b2092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e7b25114c4f0d8c3fd998c1e6bf559"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ad5e7b25114c4f0d8c3fd998c1e6bf559">ScaleRegionDensity</a> (int index, double scalingfactor)</td></tr>
<tr class="separator:ad5e7b25114c4f0d8c3fd998c1e6bf559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8f4560e43656b5ea964151b864c99f"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#aad8f4560e43656b5ea964151b864c99f">GetNuPath</a> ()</td></tr>
<tr class="separator:aad8f4560e43656b5ea964151b864c99f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f0fafc9dbdd01fb9fc6dbadf69fb4e"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a78f0fafc9dbdd01fb9fc6dbadf69fb4e">GetMergedPaths</a> (double prec=0.25)</td></tr>
<tr class="memdesc:a78f0fafc9dbdd01fb9fc6dbadf69fb4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get merged path sequence in a vector.  <a href="classOscProb_1_1EarthModelBase.html#a78f0fafc9dbdd01fb9fc6dbadf69fb4e">More...</a><br /></td></tr>
<tr class="separator:a78f0fafc9dbdd01fb9fc6dbadf69fb4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a83f69ca6cb7438917d16afaa376c97"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a3a83f69ca6cb7438917d16afaa376c97">GetTotalL</a> (double cosT)</td></tr>
<tr class="memdesc:a3a83f69ca6cb7438917d16afaa376c97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total baseline for a given cosTheta.  <a href="classOscProb_1_1EarthModelBase.html#a3a83f69ca6cb7438917d16afaa376c97">More...</a><br /></td></tr>
<tr class="separator:a3a83f69ca6cb7438917d16afaa376c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7fd7dc94d2749ddc1af8db11bda962"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a7e7fd7dc94d2749ddc1af8db11bda962">GetCosT</a> (double L)</td></tr>
<tr class="memdesc:a7e7fd7dc94d2749ddc1af8db11bda962"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cosTheta for a given total baseline.  <a href="classOscProb_1_1EarthModelBase.html#a7e7fd7dc94d2749ddc1af8db11bda962">More...</a><br /></td></tr>
<tr class="separator:a7e7fd7dc94d2749ddc1af8db11bda962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6399e4d3ec17a360f2fe3f7d39576c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#abc6399e4d3ec17a360f2fe3f7d39576c">SetRemoveSmallPaths</a> (bool rp=true)</td></tr>
<tr class="memdesc:abc6399e4d3ec17a360f2fe3f7d39576c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set tag to remove small paths.  <a href="classOscProb_1_1EarthModelBase.html#abc6399e4d3ec17a360f2fe3f7d39576c">More...</a><br /></td></tr>
<tr class="separator:abc6399e4d3ec17a360f2fe3f7d39576c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a0cd434f08ca3d4d48ee339b9c16446e8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a> ()</td></tr>
<tr class="memdesc:a0cd434f08ca3d4d48ee339b9c16446e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear the earth model information.  <a href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">More...</a><br /></td></tr>
<tr class="separator:a0cd434f08ca3d4d48ee339b9c16446e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fff4e60498ca07cda7becc2c98b9cd6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a7fff4e60498ca07cda7becc2c98b9cd6">AddBin</a> (double radius_out, double radius_in, double latitude, double longitude, double density, double zoa, double layer)</td></tr>
<tr class="memdesc:a7fff4e60498ca07cda7becc2c98b9cd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a bin to the model (angles in degrees)  <a href="classOscProb_1_1EarthModelBinned.html#a7fff4e60498ca07cda7becc2c98b9cd6">More...</a><br /></td></tr>
<tr class="separator:a7fff4e60498ca07cda7becc2c98b9cd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3ae04b5d494c60924f817dcb1b3be2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a> (double length, <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a> bin)</td></tr>
<tr class="memdesc:a1e3ae04b5d494c60924f817dcb1b3be2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a path segment to the sequence.  <a href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">More...</a><br /></td></tr>
<tr class="separator:a1e3ae04b5d494c60924f817dcb1b3be2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d10c0efa1f34b49eebe3562336d377"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ad7d10c0efa1f34b49eebe3562336d377">DetDistForNextLatBin</a> (int cur_index, <a class="el" href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html">LatBinInfo</a> &amp;L)</td></tr>
<tr class="separator:ad7d10c0efa1f34b49eebe3562336d377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03fd9f0aa5eeeaba5da75706fd1b4556"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a03fd9f0aa5eeeaba5da75706fd1b4556">DetDistForNextLonBin</a> (double prev_lon, <a class="el" href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html">LonBinInfo</a> &amp;L)</td></tr>
<tr class="separator:a03fd9f0aa5eeeaba5da75706fd1b4556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d35fc1df9d15f0c4c85b08bb7ab597f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a4d35fc1df9d15f0c4c85b08bb7ab597f">RecordLatLonBinCrossings</a> (double detDist_nextDbin, double &amp;DetDist, int &amp;index, <a class="el" href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html">LatBinInfo</a> &amp;latI, <a class="el" href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html">LonBinInfo</a> &amp;lonI)</td></tr>
<tr class="separator:a4d35fc1df9d15f0c4c85b08bb7ab597f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87bc7e45352b116395fe0ae04f2bd03"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">LonBinIndex</a> (double longitude)</td></tr>
<tr class="memdesc:ab87bc7e45352b116395fe0ae04f2bd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find lon bin index containing longitude.  <a href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">More...</a><br /></td></tr>
<tr class="separator:ab87bc7e45352b116395fe0ae04f2bd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace5763a4202c28287cda66e75faa9196"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ace5763a4202c28287cda66e75faa9196">ClassDef</a> (<a class="el" href="classOscProb_1_1EarthModelBinned.html">EarthModelBinned</a>, 1)</td></tr>
<tr class="separator:ace5763a4202c28287cda66e75faa9196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f17dd5f4b429897b5f3d027bdb37fe"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#af7f17dd5f4b429897b5f3d027bdb37fe">SetDetectorCoordinates</a> (double rad, double lat, double lon)</td></tr>
<tr class="separator:af7f17dd5f4b429897b5f3d027bdb37fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4398bca05cdac15da15027b30d04a8d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#ad4398bca05cdac15da15027b30d04a8d">AddPathSegment</a> (double length, double density, double zoa, int index)</td></tr>
<tr class="memdesc:ad4398bca05cdac15da15027b30d04a8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a path segment to the sequence.  <a href="classOscProb_1_1EarthModelBase.html#ad4398bca05cdac15da15027b30d04a8d">More...</a><br /></td></tr>
<tr class="separator:ad4398bca05cdac15da15027b30d04a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae384b3a9ebacc19a9af429a29153e5ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#ae384b3a9ebacc19a9af429a29153e5ba">ClassDef</a> (<a class="el" href="classOscProb_1_1EarthModelBase.html">EarthModelBase</a>, 1)</td></tr>
<tr class="separator:ae384b3a9ebacc19a9af429a29153e5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac1048e55f7edf48d192c119805deca8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOscProb_1_1TrajConstants.html">TrajConstants</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a></td></tr>
<tr class="memdesc:ac1048e55f7edf48d192c119805deca8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Useful constants for the trajectory.  <a href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">More...</a><br /></td></tr>
<tr class="separator:ac1048e55f7edf48d192c119805deca8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ccb848f9c2f2b461ec1a887edf86d48"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a></td></tr>
<tr class="memdesc:a0ccb848f9c2f2b461ec1a887edf86d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">The bins in the earth model.  <a href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">More...</a><br /></td></tr>
<tr class="separator:a0ccb848f9c2f2b461ec1a887edf86d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a269a23478b10150833e98908e177f584"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a></td></tr>
<tr class="memdesc:a269a23478b10150833e98908e177f584"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of depth bins.  <a href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">More...</a><br /></td></tr>
<tr class="separator:a269a23478b10150833e98908e177f584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade362672b6324e8a619a584690f8321c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a></td></tr>
<tr class="memdesc:ade362672b6324e8a619a584690f8321c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of longitude bins.  <a href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">More...</a><br /></td></tr>
<tr class="separator:ade362672b6324e8a619a584690f8321c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d55291b081a7e3e0ad785d13419506"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a></td></tr>
<tr class="memdesc:a70d55291b081a7e3e0ad785d13419506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of latitude bins.  <a href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">More...</a><br /></td></tr>
<tr class="separator:a70d55291b081a7e3e0ad785d13419506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104ef294d4ac7099ebb4a8531f45ddae"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a104ef294d4ac7099ebb4a8531f45ddae">fInvLonBinWidth</a></td></tr>
<tr class="memdesc:a104ef294d4ac7099ebb4a8531f45ddae"><td class="mdescLeft">&#160;</td><td class="mdescRight">1/binwidth for each longitude bin  <a href="classOscProb_1_1EarthModelBinned.html#a104ef294d4ac7099ebb4a8531f45ddae">More...</a><br /></td></tr>
<tr class="separator:a104ef294d4ac7099ebb4a8531f45ddae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84542bc6b02f9197f79276b1a809339"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">fInvLatBinWidth</a></td></tr>
<tr class="memdesc:ab84542bc6b02f9197f79276b1a809339"><td class="mdescLeft">&#160;</td><td class="mdescRight">1/binwidth for each latitude bin  <a href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">More...</a><br /></td></tr>
<tr class="separator:ab84542bc6b02f9197f79276b1a809339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d7e03565438b0f1aa96a69bddb7d55"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">fHalfLonBinWidth</a></td></tr>
<tr class="memdesc:a50d7e03565438b0f1aa96a69bddb7d55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Half-width of each longitude bin.  <a href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">More...</a><br /></td></tr>
<tr class="separator:a50d7e03565438b0f1aa96a69bddb7d55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f56eafc1d45fc28e70ff92e18c632a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a></td></tr>
<tr class="memdesc:aa3f56eafc1d45fc28e70ff92e18c632a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Half-width of each latitude bin.  <a href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">More...</a><br /></td></tr>
<tr class="separator:aa3f56eafc1d45fc28e70ff92e18c632a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58d53ccb36e3bb4e250af0fa914cc09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a></td></tr>
<tr class="memdesc:ac58d53ccb36e3bb4e250af0fa914cc09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Largest region index in model.  <a href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">More...</a><br /></td></tr>
<tr class="separator:ac58d53ccb36e3bb4e250af0fa914cc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade89889b7f38d79dc273e6654691fdc3"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#ade89889b7f38d79dc273e6654691fdc3">fErrorMessage_LonInfo</a></td></tr>
<tr class="separator:ade89889b7f38d79dc273e6654691fdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326ad46fde69ecbe295cd41419eb868b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBinned.html#a326ad46fde69ecbe295cd41419eb868b">fLonError</a></td></tr>
<tr class="separator:a326ad46fde69ecbe295cd41419eb868b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae40eaf3d8b666cfd4fe9242decf78121"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a></td></tr>
<tr class="memdesc:ae40eaf3d8b666cfd4fe9242decf78121"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current neutrino path sequence.  <a href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">More...</a><br /></td></tr>
<tr class="separator:ae40eaf3d8b666cfd4fe9242decf78121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cbe53a328039a65b25736151dc6d586"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a></td></tr>
<tr class="memdesc:a3cbe53a328039a65b25736151dc6d586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum radius in Earth model (in km)  <a href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">More...</a><br /></td></tr>
<tr class="separator:a3cbe53a328039a65b25736151dc6d586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11bb0a5e0d6348513e46ede9ff16cda"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a></td></tr>
<tr class="memdesc:af11bb0a5e0d6348513e46ede9ff16cda"><td class="mdescLeft">&#160;</td><td class="mdescRight">The radius where the detector sits (in km)  <a href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">More...</a><br /></td></tr>
<tr class="separator:af11bb0a5e0d6348513e46ede9ff16cda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c1e80b6c99f58dcbb4eec872f013fdd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">fDetLat</a></td></tr>
<tr class="memdesc:a5c1e80b6c99f58dcbb4eec872f013fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The latitude (in rad) where the detector sits.  <a href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">More...</a><br /></td></tr>
<tr class="separator:a5c1e80b6c99f58dcbb4eec872f013fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc2d1736dd6ebdb38cc2da60a44a4de"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a></td></tr>
<tr class="memdesc:a9fc2d1736dd6ebdb38cc2da60a44a4de"><td class="mdescLeft">&#160;</td><td class="mdescRight">The longitude (in rad) where the detector sits.  <a href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">More...</a><br /></td></tr>
<tr class="separator:a9fc2d1736dd6ebdb38cc2da60a44a4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4176958be65c82a111e03c38aeadbe4e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOscProb_1_1EarthModelBase.html#a4176958be65c82a111e03c38aeadbe4e">fRemoveSmallPaths</a></td></tr>
<tr class="memdesc:a4176958be65c82a111e03c38aeadbe4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tag whether to merge small paths.  <a href="classOscProb_1_1EarthModelBase.html#a4176958be65c82a111e03c38aeadbe4e">More...</a><br /></td></tr>
<tr class="separator:a4176958be65c82a111e03c38aeadbe4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >This class implements a 3D (asymmetric) model of the earth using <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a>'s to store bins with different properties.</p>
<p >The class is then able to produce path sequences through the Earth as a function of the azimuthal angle and cosine of the zenith angle with respect to the detector.</p>
<p >The detector can be positioned at any point within the Earth, and the path sequences will take into account the fact that some layers are above the detector.</p>
<p >Using indices to specify various regions (which must have a constant Z/A value), the Z/A value for a region can be changed, and the density throughout the region can be scaled by a constant factor.</p>
<p >By default this implements the model stored in EarthTables/earth_binned_default.txt with the detector at the bottom of the ocean layer (radius = 6368 km) where the prime meridian intersects the equator.</p>
<p >This class inherits from <a class="el" href="classOscProb_1_1EarthModelBase.html" title="Base class for implementing an earth model.">EarthModelBase</a> and can be saved in ROOT files.</p>
<dl class="section author"><dt>Author</dt><dd>rpestes@apc.in2p3.fr </dd></dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00217">217</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4614d7d1dc9e0dd02d1bc691a8bad767" name="a4614d7d1dc9e0dd02d1bc691a8bad767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4614d7d1dc9e0dd02d1bc691a8bad767">&#9670;&nbsp;</a></span>EarthModelBinned()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EarthModelBinned::EarthModelBinned </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Constructor.</p>
<p >By default this implements the model stored in EarthTables/earth_binned_default.txt with the detector 6368 km from the center of the Earth, having a latitude of 0 deg N and a longitude of 0 deg E.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>- The txt file containing a table of earth layers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00096">96</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>{</div>
<div class="line"><span class="lineno">   98</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a63c15aa64deadcd3e792c182d7ebd133">SetDetPos</a>(6368, 0, 0);</div>
<div class="line"><span class="lineno">   99</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a456945c25af7160616ed421228af41e9">LoadModel</a>(filename);</div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBase.html#abc6399e4d3ec17a360f2fe3f7d39576c">SetRemoveSmallPaths</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  101</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a326ad46fde69ecbe295cd41419eb868b">fLonError</a> = 0;</div>
<div class="line"><span class="lineno">  102</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_abc6399e4d3ec17a360f2fe3f7d39576c"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#abc6399e4d3ec17a360f2fe3f7d39576c">OscProb::EarthModelBase::SetRemoveSmallPaths</a></div><div class="ttdeci">virtual void SetRemoveSmallPaths(bool rp=true)</div><div class="ttdoc">Set tag to remove small paths.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8cxx_source.html#l00188">EarthModelBase.cxx:188</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a326ad46fde69ecbe295cd41419eb868b"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a326ad46fde69ecbe295cd41419eb868b">OscProb::EarthModelBinned::fLonError</a></div><div class="ttdeci">int fLonError</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00336">EarthModelBinned.h:336</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a456945c25af7160616ed421228af41e9"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a456945c25af7160616ed421228af41e9">OscProb::EarthModelBinned::LoadModel</a></div><div class="ttdeci">virtual void LoadModel(std::string filename)</div><div class="ttdoc">Load an earth model from a file.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00189">EarthModelBinned.cxx:189</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a63c15aa64deadcd3e792c182d7ebd133"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a63c15aa64deadcd3e792c182d7ebd133">OscProb::EarthModelBinned::SetDetPos</a></div><div class="ttdeci">void SetDetPos(double rad, double lat=0, double lon=0)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00144">EarthModelBinned.cxx:144</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00336">fLonError</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>, and <a class="el" href="EarthModelBase_8cxx_source.html#l00188">OscProb::EarthModelBase::SetRemoveSmallPaths()</a>.</p>

</div>
</div>
<a id="a1fa46b95118c64834fbe21669e06ff60" name="a1fa46b95118c64834fbe21669e06ff60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fa46b95118c64834fbe21669e06ff60">&#9670;&nbsp;</a></span>~EarthModelBinned()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">EarthModelBinned::~EarthModelBinned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Nothing to clean. </p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00108">108</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  108</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7fff4e60498ca07cda7becc2c98b9cd6" name="a7fff4e60498ca07cda7becc2c98b9cd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fff4e60498ca07cda7becc2c98b9cd6">&#9670;&nbsp;</a></span>AddBin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::AddBin </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>longitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Add a bin to the earth model.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">radius_out</td><td>- The outer depth of the bin in km </td></tr>
    <tr><td class="paramname">radius_in</td><td>- The inner depth of the bin in km </td></tr>
    <tr><td class="paramname">latitude</td><td>- The latitude of the bin center in degrees </td></tr>
    <tr><td class="paramname">longitude</td><td>- The longitude of the bin center in degrees </td></tr>
    <tr><td class="paramname">density</td><td>- The density of the matter in the bin in g/cm^3 </td></tr>
    <tr><td class="paramname">zoa</td><td>- The effective Z/A value of the matter in the bin </td></tr>
    <tr><td class="paramname">index</td><td>- Region index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00162">162</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  165</span>{</div>
<div class="line"><span class="lineno">  166</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.push_back(<a class="code hl_struct" href="structOscProb_1_1EarthBin.html">EarthBin</a>(radius_out, radius_in, latitude, longitude,</div>
<div class="line"><span class="lineno">  167</span>                                density, zoa, index));</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a0ccb848f9c2f2b461ec1a887edf86d48"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">OscProb::EarthModelBinned::fEarthBins</a></div><div class="ttdeci">std::vector&lt; EarthBin &gt; fEarthBins</div><div class="ttdoc">The bins in the earth model.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00322">EarthModelBinned.h:322</a></div></div>
<div class="ttc" id="astructOscProb_1_1EarthBin_html"><div class="ttname"><a href="structOscProb_1_1EarthBin.html">OscProb::EarthBin</a></div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00153">EarthModelBinned.h:153</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="a1e3ae04b5d494c60924f817dcb1b3be2" name="a1e3ae04b5d494c60924f817dcb1b3be2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3ae04b5d494c60924f817dcb1b3be2">&#9670;&nbsp;</a></span>AddPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::AddPath </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a>&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Add a path segment to the sequence.</p>
<p >For a given <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a>, adds a path of a given length in that material</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>- The length of the path segment in km </td></tr>
    <tr><td class="paramname">bin</td><td>- The bin we are crossing </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00408">408</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  409</span>{</div>
<div class="line"><span class="lineno">  410</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBase.html#ad4398bca05cdac15da15027b30d04a8d">AddPathSegment</a>(length, bin.<a class="code hl_variable" href="structOscProb_1_1EarthBin.html#af70ecdf5f9255dcefd4427a48fcbbbaf">density</a>, bin.<a class="code hl_variable" href="structOscProb_1_1EarthBin.html#a84de9cf6e5c25280a80fb0cb59dd2cd3">zoa</a>, bin.<a class="code hl_variable" href="structOscProb_1_1EarthBin.html#ac93310c7dde51855e5d3dd869322ba94">index</a>);</div>
<div class="line"><span class="lineno">  411</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_ad4398bca05cdac15da15027b30d04a8d"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#ad4398bca05cdac15da15027b30d04a8d">OscProb::EarthModelBase::AddPathSegment</a></div><div class="ttdeci">virtual void AddPathSegment(double length, double density, double zoa, int index)</div><div class="ttdoc">Add a path segment to the sequence.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8cxx_source.html#l00065">EarthModelBase.cxx:65</a></div></div>
<div class="ttc" id="astructOscProb_1_1EarthBin_html_a84de9cf6e5c25280a80fb0cb59dd2cd3"><div class="ttname"><a href="structOscProb_1_1EarthBin.html#a84de9cf6e5c25280a80fb0cb59dd2cd3">OscProb::EarthBin::zoa</a></div><div class="ttdeci">double zoa</div><div class="ttdoc">The effective Z/A value of the matter in the bin.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00213">EarthModelBinned.h:213</a></div></div>
<div class="ttc" id="astructOscProb_1_1EarthBin_html_ac93310c7dde51855e5d3dd869322ba94"><div class="ttname"><a href="structOscProb_1_1EarthBin.html#ac93310c7dde51855e5d3dd869322ba94">OscProb::EarthBin::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">Region index.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00214">EarthModelBinned.h:214</a></div></div>
<div class="ttc" id="astructOscProb_1_1EarthBin_html_af70ecdf5f9255dcefd4427a48fcbbbaf"><div class="ttname"><a href="structOscProb_1_1EarthBin.html#af70ecdf5f9255dcefd4427a48fcbbbaf">OscProb::EarthBin::density</a></div><div class="ttdeci">double density</div><div class="ttdoc">The density of the matter in the bin in g/cm^3.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00212">EarthModelBinned.h:212</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8cxx_source.html#l00065">OscProb::EarthModelBase::AddPathSegment()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00212">OscProb::EarthBin::density</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00214">OscProb::EarthBin::index</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00213">OscProb::EarthBin::zoa</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>.</p>

</div>
</div>
<a id="ad4398bca05cdac15da15027b30d04a8d" name="ad4398bca05cdac15da15027b30d04a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4398bca05cdac15da15027b30d04a8d">&#9670;&nbsp;</a></span>AddPathSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBase::AddPathSegment </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Add a path segment to the sequence.</p>
<p >For a given <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a>, adds a path of a given length in that material</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>- The length of the path segment in km </td></tr>
    <tr><td class="paramname">density</td><td>- The density along the path segment </td></tr>
    <tr><td class="paramname">zoa</td><td>- Z/A along the path segment </td></tr>
    <tr><td class="paramname">index</td><td>- Index for the matter along the path segment </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00065">65</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>{</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>.push_back(<a class="code hl_struct" href="structOscProb_1_1NuPath.html">NuPath</a>(length, density, zoa, index));</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_ae40eaf3d8b666cfd4fe9242decf78121"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">OscProb::EarthModelBase::fNuPath</a></div><div class="ttdeci">std::vector&lt; NuPath &gt; fNuPath</div><div class="ttdoc">The current neutrino path sequence.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00074">EarthModelBase.h:74</a></div></div>
<div class="ttc" id="astructOscProb_1_1NuPath_html"><div class="ttname"><a href="structOscProb_1_1NuPath.html">OscProb::NuPath</a></div><div class="ttdoc">A struct representing a neutrino path segment.</div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00034">NuPath.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00074">OscProb::EarthModelBase::fNuPath</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00408">AddPath()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00325">OscProb::PremModel::AddPath()</a>.</p>

</div>
</div>
<a id="ae384b3a9ebacc19a9af429a29153e5ba" name="ae384b3a9ebacc19a9af429a29153e5ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae384b3a9ebacc19a9af429a29153e5ba">&#9670;&nbsp;</a></span>ClassDef() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OscProb::EarthModelBase::ClassDef </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOscProb_1_1EarthModelBase.html">EarthModelBase</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ace5763a4202c28287cda66e75faa9196" name="ace5763a4202c28287cda66e75faa9196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace5763a4202c28287cda66e75faa9196">&#9670;&nbsp;</a></span>ClassDef() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OscProb::EarthModelBinned::ClassDef </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOscProb_1_1EarthModelBinned.html">EarthModelBinned</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0cd434f08ca3d4d48ee339b9c16446e8" name="a0cd434f08ca3d4d48ee339b9c16446e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd434f08ca3d4d48ee339b9c16446e8">&#9670;&nbsp;</a></span>ClearModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::ClearModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Clear the earth model information. </p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">122</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  123</span>{</div>
<div class="line"><span class="lineno">  124</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a> = 0;</div>
<div class="line"><span class="lineno">  125</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a>   = 0;</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a>   = 0;</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.clear();</div>
<div class="line"><span class="lineno">  128</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a269a23478b10150833e98908e177f584"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">OscProb::EarthModelBinned::fnDepthBins</a></div><div class="ttdeci">int fnDepthBins</div><div class="ttdoc">Total number of depth bins.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00323">EarthModelBinned.h:323</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a70d55291b081a7e3e0ad785d13419506"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">OscProb::EarthModelBinned::fnLatBins</a></div><div class="ttdeci">int fnLatBins</div><div class="ttdoc">Total number of latitude bins.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00325">EarthModelBinned.h:325</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ade362672b6324e8a619a584690f8321c"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">OscProb::EarthModelBinned::fnLonBins</a></div><div class="ttdeci">int fnLonBins</div><div class="ttdoc">Total number of longitude bins.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00324">EarthModelBinned.h:324</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00323">fnDepthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00325">fnLatBins</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00324">fnLonBins</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="ad7d10c0efa1f34b49eebe3562336d377" name="ad7d10c0efa1f34b49eebe3562336d377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d10c0efa1f34b49eebe3562336d377">&#9670;&nbsp;</a></span>DetDistForNextLatBin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EarthModelBinned::DetDistForNextLatBin </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cur_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html">LatBinInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Calculate the detector distance at the edge of the current lat bin along the neutrino's trajectory</p>
<p >Calculate the distance to the detector along a neutrino trajectory, specified by cosT and the azimuthal angle, at the edge of the current latitude bin in the direction specified by dir. Returns a negative value if the next latitude bin will not be reached before the neutrino reaches the detector. Flips L.sign and changes L.maxreached to true if the extreme latitude is within the cur_index Earth bin.</p>
<p >In an attempt to make this calculation more robust, this function turns the latitude bin iteration around when sin^2(lat) gets within 10^(-14) of its extreme limit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cur_index</td><td>- Index of current Earth bin </td></tr>
    <tr><td class="paramname">L</td><td>- Information for the lat bin crossings </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated detector distance </dd></dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00431">431</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>{</div>
<div class="line"><span class="lineno">  433</span>  <span class="comment">// Find next lat bin boundary (bin center +/- 1/2-binwidth)</span></div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordtype">double</span> NewLat = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[cur_index].latitude + L.sign * L.dLat;</div>
<div class="line"><span class="lineno">  435</span>  <span class="comment">// Turn around if lat reaches +/- 90 degrees (or close enough)</span></div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordflow">if</span> (abs(NewLat) - 0.5 * M_PI &gt; -1.0e-14) {</div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> (L.maxreached) <span class="keywordflow">return</span> -1; <span class="comment">// Only turn around once</span></div>
<div class="line"><span class="lineno">  438</span>    L.maxreached = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">//    cout &lt;&lt; &quot;Max latitude reached...&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  440</span>    L.sign = -L.sign;</div>
<div class="line"><span class="lineno">  441</span>    NewLat = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[cur_index].latitude + L.sign * L.dLat;</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordflow">if</span> (abs(NewLat) - 0.5 * M_PI &gt; -1.0e-14)</div>
<div class="line"><span class="lineno">  443</span>      <span class="keywordflow">return</span> -1; <span class="comment">// This would happen if there&#39;s only one latitude bin...</span></div>
<div class="line"><span class="lineno">  444</span>  }</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  <span class="comment">// Calculate parts of answer</span></div>
<div class="line"><span class="lineno">  447</span>  <span class="keywordtype">double</span> sinNewLat    = sin(NewLat);</div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordtype">double</span> NsinSqNewLat = -sinNewLat * sinNewLat;</div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordtype">double</span> radicand     = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a9d3d75a4790e16793f5ad6213ae556f5">maxSinSqLat</a> +</div>
<div class="line"><span class="lineno">  450</span>                    NsinSqNewLat; <span class="comment">// 1-[sin(NewLat)]^2-[sin(phi)cos(DetLat)]^2</span></div>
<div class="line"><span class="lineno">  451</span>  <span class="comment">// Turn around if the radicand is 0 (close enough) or less</span></div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">if</span> (radicand &lt; 1.0e-14) {</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> (L.maxreached) <span class="keywordflow">return</span> -1; <span class="comment">// Only turn around once</span></div>
<div class="line"><span class="lineno">  454</span>    L.maxreached = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  455</span>    <span class="comment">//    cout &lt;&lt; &quot;Max latitude reached...&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  456</span>    L.sign       = -L.sign;</div>
<div class="line"><span class="lineno">  457</span>    NewLat       = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[cur_index].latitude + L.sign * L.dLat;</div>
<div class="line"><span class="lineno">  458</span>    sinNewLat    = sin(NewLat);</div>
<div class="line"><span class="lineno">  459</span>    NsinSqNewLat = -sinNewLat * sinNewLat;</div>
<div class="line"><span class="lineno">  460</span>    radicand     = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a9d3d75a4790e16793f5ad6213ae556f5">maxSinSqLat</a> + NsinSqNewLat;</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">if</span> (radicand &lt; 1.0e-14)</div>
<div class="line"><span class="lineno">  462</span>      <span class="keywordflow">return</span> -1; <span class="comment">// The rest of the track is contained in this lat bin</span></div>
<div class="line"><span class="lineno">  463</span>  }</div>
<div class="line"><span class="lineno">  464</span>  <span class="keywordtype">double</span> denominator = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a2ec711472cf7ecdd50afebc1c86d6568">gammaSq</a> + NsinSqNewLat;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>  <span class="comment">// Calculate distance from the detector at next lat bin boundary</span></div>
<div class="line"><span class="lineno">  467</span>  <span class="keywordtype">double</span> answer;</div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">if</span> (denominator == 0) {</div>
<div class="line"><span class="lineno">  469</span>    answer = 0.5 * (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a4915b889e8c3934d96be90c753ccec50">xlatextreme</a> - <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aa4d40c9f867f99c00564e6f852d0dcac">rDetSinDetLat</a> / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a95c2627a62e52941931e381e2c967479">gamma</a>);</div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">// There is a &quot;possible&quot; case where answer would be 0:</span></div>
<div class="line"><span class="lineno">  471</span>    <span class="comment">//   if the detector is at the center of the Earth... just don&#39;t...</span></div>
<div class="line"><span class="lineno">  472</span>  }</div>
<div class="line"><span class="lineno">  473</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  474</span>    answer = -(<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">rDetCosT</a> * NsinSqNewLat + <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7d12fa3695e0e8a68bad8bafc050d56a">rDetGammaSinDetLat</a> +</div>
<div class="line"><span class="lineno">  475</span>               L.sign * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a39ed29ebc9c25d8e9ff4ec24ef9d6fa2">rDetSinT</a> * sinNewLat * sqrt(radicand)) /</div>
<div class="line"><span class="lineno">  476</span>             denominator;</div>
<div class="line"><span class="lineno">  477</span>  }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  <span class="comment">// Check to see if going to the edge of the bin jumped to an invalid</span></div>
<div class="line"><span class="lineno">  480</span>  <span class="comment">// part of the function (cosA*rDetCosDetLat/beta = x at max lat)</span></div>
<div class="line"><span class="lineno">  481</span>  <span class="keywordflow">if</span> (L.maxreached &amp;&amp; answer &gt;= <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a4915b889e8c3934d96be90c753ccec50">xlatextreme</a>) {</div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">return</span> -1; <span class="comment">// The rest of the track is contained in this lat bin</span></div>
<div class="line"><span class="lineno">  483</span>  }</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordflow">return</span> answer;</div>
<div class="line"><span class="lineno">  486</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ac1048e55f7edf48d192c119805deca8d"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">OscProb::EarthModelBinned::fC</a></div><div class="ttdeci">TrajConstants fC</div><div class="ttdoc">Useful constants for the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00320">EarthModelBinned.h:320</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a2ec711472cf7ecdd50afebc1c86d6568"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a2ec711472cf7ecdd50afebc1c86d6568">OscProb::TrajConstants::gammaSq</a></div><div class="ttdeci">double gammaSq</div><div class="ttdoc">[sin(T)*cos(phi)*cos(DetLat)+cosT*sin(DetLat)]^2</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00143">EarthModelBinned.h:143</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a39ed29ebc9c25d8e9ff4ec24ef9d6fa2"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a39ed29ebc9c25d8e9ff4ec24ef9d6fa2">OscProb::TrajConstants::rDetSinT</a></div><div class="ttdeci">double rDetSinT</div><div class="ttdoc">rDet*sin(T)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00139">EarthModelBinned.h:139</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a4915b889e8c3934d96be90c753ccec50"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a4915b889e8c3934d96be90c753ccec50">OscProb::TrajConstants::xlatextreme</a></div><div class="ttdeci">double xlatextreme</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00148">EarthModelBinned.h:148</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a7381db6a7bd21b1d654bf86ecc071267"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">OscProb::TrajConstants::rDetCosT</a></div><div class="ttdeci">double rDetCosT</div><div class="ttdoc">rDet*cosT</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00138">EarthModelBinned.h:138</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a7d12fa3695e0e8a68bad8bafc050d56a"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a7d12fa3695e0e8a68bad8bafc050d56a">OscProb::TrajConstants::rDetGammaSinDetLat</a></div><div class="ttdeci">double rDetGammaSinDetLat</div><div class="ttdoc">rDet*sin(DetLat)*[sin(T)*cos(phi)*cos(DetLat)+cosT*sin(DetLat)]</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00145">EarthModelBinned.h:145</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a95c2627a62e52941931e381e2c967479"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a95c2627a62e52941931e381e2c967479">OscProb::TrajConstants::gamma</a></div><div class="ttdeci">double gamma</div><div class="ttdoc">sin(T)*cos(phi)*cos(DetLat)+cosT*sin(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00142">EarthModelBinned.h:142</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a9d3d75a4790e16793f5ad6213ae556f5"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a9d3d75a4790e16793f5ad6213ae556f5">OscProb::TrajConstants::maxSinSqLat</a></div><div class="ttdeci">double maxSinSqLat</div><div class="ttdoc">1 - [sin(phi)*cos(DetLat)]^2</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00146">EarthModelBinned.h:146</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_aa4d40c9f867f99c00564e6f852d0dcac"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#aa4d40c9f867f99c00564e6f852d0dcac">OscProb::TrajConstants::rDetSinDetLat</a></div><div class="ttdeci">double rDetSinDetLat</div><div class="ttdoc">rDet*sin(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00131">EarthModelBinned.h:131</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00258">OscProb::EarthModelBinned::LatBinInfo::dLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00320">fC</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00142">OscProb::TrajConstants::gamma</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00143">OscProb::TrajConstants::gammaSq</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00262">OscProb::EarthModelBinned::LatBinInfo::maxreached</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00146">OscProb::TrajConstants::maxSinSqLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00138">OscProb::TrajConstants::rDetCosT</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00145">OscProb::TrajConstants::rDetGammaSinDetLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00131">OscProb::TrajConstants::rDetSinDetLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00139">OscProb::TrajConstants::rDetSinT</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00254">OscProb::EarthModelBinned::LatBinInfo::sign</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00148">OscProb::TrajConstants::xlatextreme</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>.</p>

</div>
</div>
<a id="a03fd9f0aa5eeeaba5da75706fd1b4556" name="a03fd9f0aa5eeeaba5da75706fd1b4556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03fd9f0aa5eeeaba5da75706fd1b4556">&#9670;&nbsp;</a></span>DetDistForNextLonBin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EarthModelBinned::DetDistForNextLonBin </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prev_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html">LonBinInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Calculate the detector distance at the edge of the current lon bin along the neutrino's trajectory and increment L.bin</p>
<p >Calculate the distance to the detector at the edge of the current longitude bin along a neutrino trajectory specified by cosT and the azimuthal angle, setting the index for the next longitude bin in the process. The maximum/minimum longitude are expressed around the 0-2pi boundary. So, if the track spans that boundary, the actual allowed range for lon is [min_lon,2pi)U[0,max_lon].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prev_lon</td><td>- Value at center of initial longitude bin </td></tr>
    <tr><td class="paramname">L</td><td>- Information about longitude bin crossings </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated detector distance </dd></dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00501">501</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  502</span>{</div>
<div class="line"><span class="lineno">  503</span>  <span class="keywordtype">double</span> twoPi = 2 * M_PI;</div>
<div class="line"><span class="lineno">  504</span>  <span class="comment">// Increment to next bin in direction dLon</span></div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordtype">double</span> lon = prev_lon + L.dLon;</div>
<div class="line"><span class="lineno">  506</span>  <span class="keywordflow">if</span> (lon &lt; 0 || lon &gt;= twoPi) { lon -= floor(lon / twoPi) * twoPi; }</div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">if</span> (L.dLon &gt; 0) {</div>
<div class="line"><span class="lineno">  508</span>    L.nextBin = L.bin + 1;</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">if</span> (L.nextBin &gt;= <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a>) {</div>
<div class="line"><span class="lineno">  510</span>      <span class="comment">// cross from 2pi to 0</span></div>
<div class="line"><span class="lineno">  511</span>      L.nextBin = 0;</div>
<div class="line"><span class="lineno">  512</span>    }</div>
<div class="line"><span class="lineno">  513</span>  }</div>
<div class="line"><span class="lineno">  514</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  515</span>    L.nextBin = L.bin - 1;</div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">if</span> (L.nextBin &lt; 0) {</div>
<div class="line"><span class="lineno">  517</span>      <span class="comment">// cross from 0 to 2pi</span></div>
<div class="line"><span class="lineno">  518</span>      L.nextBin = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a> - 1;</div>
<div class="line"><span class="lineno">  519</span>    }</div>
<div class="line"><span class="lineno">  520</span>  }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// Check if lon is outside of range covered by neutrino&#39;s trajectory</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="keywordflow">if</span> (L.max &lt; L.min) {</div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordflow">if</span> (0 &gt; lon - L.min &amp;&amp; L.max - lon &lt; 0) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  525</span>  }</div>
<div class="line"><span class="lineno">  526</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">if</span> (0 &gt; lon - L.min || L.max - lon &lt; 0) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  528</span>  }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>  <span class="comment">// Parts of the answer</span></div>
<div class="line"><span class="lineno">  531</span>  <span class="keywordtype">double</span> cosNewLon   = cos(lon);</div>
<div class="line"><span class="lineno">  532</span>  <span class="keywordtype">double</span> sinNewLon   = sin(lon);</div>
<div class="line"><span class="lineno">  533</span>  <span class="keywordtype">double</span> expression  = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a8e200fae669fd9bcdbd412c5612bdd6e">sinDetLon</a> * cosNewLon - sinNewLon * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a1dae85a396f884f2168a2d9007e0478f">cosDetLon</a>;</div>
<div class="line"><span class="lineno">  534</span>  <span class="keywordtype">double</span> denominator = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">alpha</a> * expression +</div>
<div class="line"><span class="lineno">  535</span>                       <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#ac0c5f8ad095f9f55a2a1f94af7402757">sinTsinAcosDetLon</a> * cosNewLon +</div>
<div class="line"><span class="lineno">  536</span>                       <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a913597a42222e54e0585c8ec0e9bebc5">sinTsinAsinDetLon</a> * sinNewLon;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>  <span class="comment">// Calculate &amp; return detector distance</span></div>
<div class="line"><span class="lineno">  539</span>  <span class="keywordflow">if</span> (denominator == 0) { <span class="comment">// Is there ever a case when this is true???</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// Error message will be printed at the end of the FillPath function</span></div>
<div class="line"><span class="lineno">  541</span>    L.err_message.assign(<span class="stringliteral">&quot;Longitude along neutrino trajectory = &quot;</span> +</div>
<div class="line"><span class="lineno">  542</span>                         std::to_string(lon));</div>
<div class="line"><span class="lineno">  543</span>    L.error = -1;</div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  545</span>  }</div>
<div class="line"><span class="lineno">  546</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aac095b1d3d8eb15ce9c3c100349063a2">rDetCosDetLat</a> * expression / denominator;</div>
<div class="line"><span class="lineno">  547</span>}</div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a1dae85a396f884f2168a2d9007e0478f"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a1dae85a396f884f2168a2d9007e0478f">OscProb::TrajConstants::cosDetLon</a></div><div class="ttdeci">double cosDetLon</div><div class="ttdoc">cos(DetLon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00119">EarthModelBinned.h:119</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a68eff8955b93baedd3ad878820b25bbc"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">OscProb::TrajConstants::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">sin(T)*cos(phi)*sin(DetLat)-cosT*cos(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00140">EarthModelBinned.h:140</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a8e200fae669fd9bcdbd412c5612bdd6e"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a8e200fae669fd9bcdbd412c5612bdd6e">OscProb::TrajConstants::sinDetLon</a></div><div class="ttdeci">double sinDetLon</div><div class="ttdoc">sin(DetLon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00120">EarthModelBinned.h:120</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a913597a42222e54e0585c8ec0e9bebc5"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a913597a42222e54e0585c8ec0e9bebc5">OscProb::TrajConstants::sinTsinAsinDetLon</a></div><div class="ttdeci">double sinTsinAsinDetLon</div><div class="ttdoc">sin(T)*sin(phi)*sin(DetLon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00135">EarthModelBinned.h:135</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_aac095b1d3d8eb15ce9c3c100349063a2"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#aac095b1d3d8eb15ce9c3c100349063a2">OscProb::TrajConstants::rDetCosDetLat</a></div><div class="ttdeci">double rDetCosDetLat</div><div class="ttdoc">rDet*cos(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00132">EarthModelBinned.h:132</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_ac0c5f8ad095f9f55a2a1f94af7402757"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#ac0c5f8ad095f9f55a2a1f94af7402757">OscProb::TrajConstants::sinTsinAcosDetLon</a></div><div class="ttdeci">double sinTsinAcosDetLon</div><div class="ttdoc">sin(T)*sin(phi)*cos(DetLon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00136">EarthModelBinned.h:136</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00140">OscProb::TrajConstants::alpha</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00268">OscProb::EarthModelBinned::LonBinInfo::bin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00119">OscProb::TrajConstants::cosDetLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00276">OscProb::EarthModelBinned::LonBinInfo::dLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00285">OscProb::EarthModelBinned::LonBinInfo::err_message</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00282">OscProb::EarthModelBinned::LonBinInfo::error</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00320">fC</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00324">fnLonBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00281">OscProb::EarthModelBinned::LonBinInfo::max</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00280">OscProb::EarthModelBinned::LonBinInfo::min</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00269">OscProb::EarthModelBinned::LonBinInfo::nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00132">OscProb::TrajConstants::rDetCosDetLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00120">OscProb::TrajConstants::sinDetLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00136">OscProb::TrajConstants::sinTsinAcosDetLon</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00135">OscProb::TrajConstants::sinTsinAsinDetLon</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>.</p>

</div>
</div>
<a id="a2cc141466f89062ca2f615a9f5407424" name="a2cc141466f89062ca2f615a9f5407424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc141466f89062ca2f615a9f5407424">&#9670;&nbsp;</a></span>FillPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EarthModelBinned::FillPath </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Fill the path sequence in a vector (phi in degrees)</p>
<p >Fill the path sequence in a vector.</p>
<p >This will start at the upper-most layer (where the neutrino's path started) and find path lengths to the next bin crossed. When reaching the inner-most depth in the given direction, the paths move back to outer layers until hitting the detector. The neutrino direction is specified as the zenith angle and azimuthal angle of the vector pointing from the detector to where the neutrino entered the Earth.</p>
<p >The path sequence is stored as an attribute and can be retrieved with the function GetNuPath.</p>
<p >Note: This function assumes uniform bin sizes for the latitude bins and the longitude bins.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cosT</td><td>- The cosine of the zenith angle of the neutrino direction </td></tr>
    <tr><td class="paramname">phi</td><td>- The azimuthal angle (in degrees from North) of the neutrino direction </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of path segments in the sequence </dd></dl>

<p>Implements <a class="el" href="classOscProb_1_1EarthModelBase.html#a5b66f8bb3016dd042e352802e9af54a6">OscProb::EarthModelBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">666</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  667</span>{</div>
<div class="line"><span class="lineno">  668</span>  <span class="comment">// Clear current path sequence</span></div>
<div class="line"><span class="lineno">  669</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>.clear();</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>  <span class="comment">// Do nothing if cosine is unphysical</span></div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordflow">if</span> (fabs(cosT) &gt; 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  <span class="comment">// Calculate useful combinations of variables</span></div>
<div class="line"><span class="lineno">  675</span>  <span class="keywordtype">double</span> Az = phi / 180.0 * M_PI; <span class="comment">// convert from degrees to radians</span></div>
<div class="line"><span class="lineno">  676</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_function" href="structOscProb_1_1TrajConstants.html#a9e2d2f88f27cbfec6f2a812dee43479e">UpdateNuAngles</a>(cosT, Az);</div>
<div class="line"><span class="lineno">  677</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_function" href="structOscProb_1_1TrajConstants.html#aea9fd40eb64ccf33dd796f46261dc596">Recalculate</a>();</div>
<div class="line"><span class="lineno">  678</span>  <span class="keywordtype">double</span> rDetSqSinSqT = pow(<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a39ed29ebc9c25d8e9ff4ec24ef9d6fa2">rDetSinT</a>, 2);</div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordtype">double</span> distEdgeToMin =</div>
<div class="line"><span class="lineno">  680</span>      sqrt(<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> -</div>
<div class="line"><span class="lineno">  681</span>           rDetSqSinSqT); <span class="comment">// distance from point where neutrino enters to</span></div>
<div class="line"><span class="lineno">  682</span>                          <span class="comment">// minimum depth (neglecting stopping at the detector)</span></div>
<div class="line"><span class="lineno">  683</span>  <span class="keywordtype">double</span> baseline = distEdgeToMin - <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">rDetCosT</a>; <span class="comment">// total baseline</span></div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>  <span class="comment">// Define the maximum depth (minimum radius) along the path (detector</span></div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">// depth/radius, if cosT is non-negative)</span></div>
<div class="line"><span class="lineno">  687</span>  <span class="keywordtype">double</span> minRadius = <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a>;</div>
<div class="line"><span class="lineno">  688</span>  <span class="keywordflow">if</span> (cosT &lt; 0) { minRadius = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a39ed29ebc9c25d8e9ff4ec24ef9d6fa2">rDetSinT</a>; }</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="comment">// Starting latitude</span></div>
<div class="line"><span class="lineno">  691</span>  <span class="comment">/*  cout &lt;&lt; &quot;Pieces of init_lat calculation:&quot; &lt;&lt; endl</span></div>
<div class="line"><span class="lineno">  692</span><span class="comment">         &lt;&lt; &quot;\trDetSinT = &quot; &lt;&lt; fC.rDetSinT &lt;&lt; endl</span></div>
<div class="line"><span class="lineno">  693</span><span class="comment">         &lt;&lt; &quot;\tbeta = &quot; &lt;&lt; fC.beta &lt;&lt; endl</span></div>
<div class="line"><span class="lineno">  694</span><span class="comment">         &lt;&lt; &quot;\tgamma = &quot; &lt;&lt; fC.gamma &lt;&lt; endl</span></div>
<div class="line"><span class="lineno">  695</span><span class="comment">         &lt;&lt; &quot;\tdistEdgeToMin = &quot; &lt;&lt; distEdgeToMin &lt;&lt; endl</span></div>
<div class="line"><span class="lineno">  696</span><span class="comment">         &lt;&lt; &quot;\tRadiusMax = &quot; &lt;&lt; fRadiusMax &lt;&lt; endl; */</span></div>
<div class="line"><span class="lineno">  697</span>  <span class="keywordtype">double</span> init_lat = asin((<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a39ed29ebc9c25d8e9ff4ec24ef9d6fa2">rDetSinT</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a2be346fc4bf3514317e1092b7c56cced">beta</a> + <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a95c2627a62e52941931e381e2c967479">gamma</a> * distEdgeToMin) /</div>
<div class="line"><span class="lineno">  698</span>                         <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a>); <span class="comment">// in radians</span></div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>  <span class="comment">// Starting longitude</span></div>
<div class="line"><span class="lineno">  701</span>  <span class="keywordtype">double</span> init_lon = atan2(</div>
<div class="line"><span class="lineno">  702</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a8e200fae669fd9bcdbd412c5612bdd6e">sinDetLon</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aac095b1d3d8eb15ce9c3c100349063a2">rDetCosDetLat</a> -</div>
<div class="line"><span class="lineno">  703</span>          baseline * (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">alpha</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a8e200fae669fd9bcdbd412c5612bdd6e">sinDetLon</a> + <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#ac0c5f8ad095f9f55a2a1f94af7402757">sinTsinAcosDetLon</a>),</div>
<div class="line"><span class="lineno">  704</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a1dae85a396f884f2168a2d9007e0478f">cosDetLon</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aac095b1d3d8eb15ce9c3c100349063a2">rDetCosDetLat</a> +</div>
<div class="line"><span class="lineno">  705</span>          baseline *</div>
<div class="line"><span class="lineno">  706</span>              (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a913597a42222e54e0585c8ec0e9bebc5">sinTsinAsinDetLon</a> -</div>
<div class="line"><span class="lineno">  707</span>               <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">alpha</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a1dae85a396f884f2168a2d9007e0478f">cosDetLon</a>)); <span class="comment">// in radians (between -M_PI and M_PI)</span></div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">if</span> (init_lon &lt; 0) { init_lon += 2 * M_PI; }</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>  <span class="comment">// Get initial Earth bin and # of bins per depth layer</span></div>
<div class="line"><span class="lineno">  711</span>  LatBinInfo latinfo;</div>
<div class="line"><span class="lineno">  712</span>  LonBinInfo loninfo;</div>
<div class="line"><span class="lineno">  713</span>  <span class="keywordtype">int</span>        binsPerDepth = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size() / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a>;</div>
<div class="line"><span class="lineno">  714</span>  <span class="keywordtype">int</span>        init_lonBin  = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">LonBinIndex</a>(init_lon);</div>
<div class="line"><span class="lineno">  715</span>  <span class="keywordtype">int</span>        init_latBin  = floor((init_lat + M_PI / 2.0) * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">fInvLatBinWidth</a>);</div>
<div class="line"><span class="lineno">  716</span>  <span class="keywordtype">int</span>        index =</div>
<div class="line"><span class="lineno">  717</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size() - binsPerDepth + init_lonBin * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a> + init_latBin;</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>  latinfo.bin = init_latBin;</div>
<div class="line"><span class="lineno">  720</span>  loninfo.bin = init_lonBin;</div>
<div class="line"><span class="lineno">  721</span>  <span class="comment">//  cout &lt;&lt; &quot;Neutrino starting at (lat,lon)=(&quot; &lt;&lt; init_lat &lt;&lt; &quot;rad,&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  722</span>  <span class="comment">//  init_lon &lt;&lt; &quot;rad) in Earth bin &quot; &lt;&lt; index &lt;&lt; &quot; = (r&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  723</span>  <span class="comment">//  floor(index/binsPerDepth) &lt;&lt; &quot;, lon&quot; &lt;&lt; loninfo.bin &lt;&lt; &quot;, lat&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  724</span>  <span class="comment">//  latinfo.bin &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>  <span class="comment">/* Find detector distances for 1st latitude/longitude bin changes */</span></div>
<div class="line"><span class="lineno">  727</span>  latinfo.dLat = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a>; <span class="comment">// change in lat from bin center to next bin</span></div>
<div class="line"><span class="lineno">  728</span>                                   <span class="comment">// (0 if no more than 1 lat bin change)</span></div>
<div class="line"><span class="lineno">  729</span>  <span class="comment">// Condition calculation for starting sign in x(lat) equation</span></div>
<div class="line"><span class="lineno">  730</span>  latinfo.sign = 1; <span class="comment">//+ =&gt; lat incr., - =&gt; lat decr. (with decr. x)</span></div>
<div class="line"><span class="lineno">  731</span>  latinfo.maxreached =</div>
<div class="line"><span class="lineno">  732</span>      <span class="keyword">false</span>; <span class="comment">// this changes to true if past the lat func transition</span></div>
<div class="line"><span class="lineno">  733</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a2be346fc4bf3514317e1092b7c56cced">beta</a> &lt; 0) latinfo.sign = -1;</div>
<div class="line"><span class="lineno">  734</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a2be346fc4bf3514317e1092b7c56cced">beta</a> == 0) {</div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a52d7f7f81e8ce3bc99e7447a4dcd8a64">cosA</a> &gt; 0) latinfo.sign = -1;</div>
<div class="line"><span class="lineno">  736</span>  }</div>
<div class="line"><span class="lineno">  737</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (baseline &lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a4915b889e8c3934d96be90c753ccec50">xlatextreme</a>) {</div>
<div class="line"><span class="lineno">  738</span>    latinfo.sign       = -(latinfo.sign);</div>
<div class="line"><span class="lineno">  739</span>    latinfo.maxreached = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  740</span>  }</div>
<div class="line"><span class="lineno">  741</span>  <span class="comment">// Condition calculation for incr./decr. Longitude (with decr. x)</span></div>
<div class="line"><span class="lineno">  742</span>  loninfo.dLon =</div>
<div class="line"><span class="lineno">  743</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">fHalfLonBinWidth</a>;   <span class="comment">// change in lon from bin center to next bin (includes</span></div>
<div class="line"><span class="lineno">  744</span>                          <span class="comment">// direction; 0 if no more than 1 lon bin change)</span></div>
<div class="line"><span class="lineno">  745</span>  loninfo.min = init_lon; <span class="comment">// initial lon if lon is inc.</span></div>
<div class="line"><span class="lineno">  746</span>  loninfo.max = <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a>;  <span class="comment">// detector lon if lon is inc.</span></div>
<div class="line"><span class="lineno">  747</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#acf93c97174b03dfc682d17636a4320a3">sinA</a> &lt; 0) {</div>
<div class="line"><span class="lineno">  748</span>    loninfo.dLon = -(loninfo.dLon);</div>
<div class="line"><span class="lineno">  749</span>    loninfo.min  = loninfo.max;</div>
<div class="line"><span class="lineno">  750</span>    loninfo.max  = init_lon;</div>
<div class="line"><span class="lineno">  751</span>    <span class="comment">// Switch max/min if dec., instead of inc.</span></div>
<div class="line"><span class="lineno">  752</span>    loninfo.max = init_lon;</div>
<div class="line"><span class="lineno">  753</span>    loninfo.min = <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a>;</div>
<div class="line"><span class="lineno">  754</span>  }</div>
<div class="line"><span class="lineno">  755</span>  <span class="comment">// Remainder of detDist (and nextBin) calculations</span></div>
<div class="line"><span class="lineno">  756</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#ab4892bf4a9c5bacae35e1caf4e58ad78">sinT</a> == 0) {</div>
<div class="line"><span class="lineno">  757</span>    <span class="comment">// both latitude and logitude flip at center of the Earth</span></div>
<div class="line"><span class="lineno">  758</span>    loninfo.detDist_nextBin =</div>
<div class="line"><span class="lineno">  759</span>        -<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">rDetCosT</a>; <span class="comment">// formula is divided by cosT, but cosT = +-1</span></div>
<div class="line"><span class="lineno">  760</span>    loninfo.nextBin         = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">LonBinIndex</a>(<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a>);</div>
<div class="line"><span class="lineno">  761</span>    loninfo.dLon            = 0;</div>
<div class="line"><span class="lineno">  762</span>    latinfo.detDist_nextBin = loninfo.detDist_nextBin;</div>
<div class="line"><span class="lineno">  763</span>    latinfo.nextBin         = floor((<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">fDetLat</a> + 0.5 * M_PI) * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">fInvLatBinWidth</a>);</div>
<div class="line"><span class="lineno">  764</span>    latinfo.dLat            = 0;</div>
<div class="line"><span class="lineno">  765</span>  }</div>
<div class="line"><span class="lineno">  766</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#acf93c97174b03dfc682d17636a4320a3">sinA</a> == 0) {</div>
<div class="line"><span class="lineno">  768</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">alpha</a> == 0) { <span class="comment">// crosses &quot;at&quot; infinity</span></div>
<div class="line"><span class="lineno">  769</span>        loninfo.detDist_nextBin = -1;</div>
<div class="line"><span class="lineno">  770</span>      }</div>
<div class="line"><span class="lineno">  771</span>      <span class="keywordflow">else</span> { <span class="comment">// longitude flips at center of the Earth</span></div>
<div class="line"><span class="lineno">  772</span>        loninfo.detDist_nextBin = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aac095b1d3d8eb15ce9c3c100349063a2">rDetCosDetLat</a> / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a68eff8955b93baedd3ad878820b25bbc">alpha</a>;</div>
<div class="line"><span class="lineno">  773</span>        loninfo.nextBin         = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">LonBinIndex</a>(<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a>);</div>
<div class="line"><span class="lineno">  774</span>      }</div>
<div class="line"><span class="lineno">  775</span>      loninfo.dLon = 0;</div>
<div class="line"><span class="lineno">  776</span>    }</div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#aaf9b5ba81db2f3ed91fefbf8c555fb46">cosDetLat</a> == 0) {</div>
<div class="line"><span class="lineno">  778</span>      loninfo.detDist_nextBin = -1;</div>
<div class="line"><span class="lineno">  779</span>    }</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  781</span>      <span class="comment">// x(lon) calculation</span></div>
<div class="line"><span class="lineno">  782</span>      loninfo.detDist_nextBin = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a03fd9f0aa5eeeaba5da75706fd1b4556">DetDistForNextLonBin</a>(</div>
<div class="line"><span class="lineno">  783</span>          <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index].longitude, loninfo); <span class="comment">// also sets loninfo.nextBin</span></div>
<div class="line"><span class="lineno">  784</span>    }</div>
<div class="line"><span class="lineno">  785</span>    <span class="comment">// x(lat) calculation</span></div>
<div class="line"><span class="lineno">  786</span>    latinfo.detDist_nextBin = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#ad7d10c0efa1f34b49eebe3562336d377">DetDistForNextLatBin</a>(index, latinfo);</div>
<div class="line"><span class="lineno">  787</span>    latinfo.nextBin         = init_latBin + latinfo.sign;</div>
<div class="line"><span class="lineno">  788</span>  }</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>  <span class="comment">// Get initial Detector Distance</span></div>
<div class="line"><span class="lineno">  791</span>  <span class="keywordtype">double</span> prev_DetDistance = baseline;</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>  <span class="comment">/* Start at the top layer of Earth model and go down to minimum (not including</span></div>
<div class="line"><span class="lineno">  794</span><span class="comment">   * minimum), looping over depth bins */</span></div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordtype">int</span> dBin = 0; <span class="comment">// depth bin index</span></div>
<div class="line"><span class="lineno">  796</span>  <span class="keywordflow">for</span> (dBin = 0; dBin &lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a> - 1; dBin++) {</div>
<div class="line"><span class="lineno">  797</span>    <span class="comment">// Check if minimum radius is contained in depth bin</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordtype">double</span> r_in = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index].radius_in; <span class="comment">// inner-most radius</span></div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">if</span> (r_in &lt; minRadius) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>    <span class="comment">// Distance from detector at inner-most radius</span></div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordtype">double</span> DetDistance = -<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">rDetCosT</a> + sqrt(r_in * r_in - rDetSqSinSqT);</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">// Check for latitude/longitude bin crossings</span></div>
<div class="line"><span class="lineno">  805</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a4d35fc1df9d15f0c4c85b08bb7ab597f">RecordLatLonBinCrossings</a>(DetDistance, prev_DetDistance, index, latinfo,</div>
<div class="line"><span class="lineno">  806</span>                             loninfo);</div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">// Add Segment to next depth bin to path</span></div>
<div class="line"><span class="lineno">  809</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a>(prev_DetDistance - DetDistance, <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index]);</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">// Reset variables for next depth bin</span></div>
<div class="line"><span class="lineno">  812</span>    prev_DetDistance = DetDistance;</div>
<div class="line"><span class="lineno">  813</span>    index -= binsPerDepth;</div>
<div class="line"><span class="lineno">  814</span>    <span class="comment">//    cout &lt;&lt; &quot;Depth bin crossing at x=&quot; &lt;&lt; DetDistance &lt;&lt; &quot;km...now in</span></div>
<div class="line"><span class="lineno">  815</span>    <span class="comment">//    Earth bin &quot; &lt;&lt; index &lt;&lt; &quot; = (r&quot; &lt;&lt; floor(index/binsPerDepth) &lt;&lt; &quot;,</span></div>
<div class="line"><span class="lineno">  816</span>    <span class="comment">//    lon&quot; &lt;&lt; loninfo.bin &lt;&lt; &quot;, lat&quot; &lt;&lt; latinfo.bin &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  817</span>  }</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>  <span class="comment">/* Do minimum depth bin and then go up to the detector */</span></div>
<div class="line"><span class="lineno">  820</span>  <span class="keywordtype">int</span> index2 = index;</div>
<div class="line"><span class="lineno">  821</span>  <span class="keywordflow">for</span> (index2 = index; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index2].radius_out &lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a>;</div>
<div class="line"><span class="lineno">  822</span>       index2 += binsPerDepth) {</div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordtype">double</span> r_out = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index2].radius_out; <span class="comment">// outer-most radius</span></div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">// Distance from detector at outer-most radius</span></div>
<div class="line"><span class="lineno">  826</span>    <span class="keywordtype">double</span> DetDistance = -<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_variable" href="structOscProb_1_1TrajConstants.html#a7381db6a7bd21b1d654bf86ecc071267">rDetCosT</a> - sqrt(r_out * r_out - rDetSqSinSqT);</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>    <span class="comment">// Check for latitude/longitude bin crossings</span></div>
<div class="line"><span class="lineno">  829</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a4d35fc1df9d15f0c4c85b08bb7ab597f">RecordLatLonBinCrossings</a>(DetDistance, prev_DetDistance, index2, latinfo,</div>
<div class="line"><span class="lineno">  830</span>                             loninfo);</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>    <span class="comment">// Add Segment in depth bin to path</span></div>
<div class="line"><span class="lineno">  833</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a>(prev_DetDistance - DetDistance, <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index2]);</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    <span class="comment">// Reset variables for &quot;previous&quot; depth bin</span></div>
<div class="line"><span class="lineno">  836</span>    prev_DetDistance = DetDistance;</div>
<div class="line"><span class="lineno">  837</span>    <span class="comment">//    cout &lt;&lt; &quot;Depth bin crossing at x=&quot; &lt;&lt; DetDistance &lt;&lt; &quot;km...now in</span></div>
<div class="line"><span class="lineno">  838</span>    <span class="comment">//    Earth bin &quot; &lt;&lt; index2 &lt;&lt; &quot; = (r&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  839</span>    <span class="comment">//    floor((index2+binsPerDepth)/binsPerDepth) &lt;&lt; &quot;, lon&quot; &lt;&lt; loninfo.bin &lt;&lt;</span></div>
<div class="line"><span class="lineno">  840</span>    <span class="comment">//    &quot;, lat&quot; &lt;&lt; latinfo.bin &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  841</span>  }</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>  <span class="comment">/* Do path to detector */</span></div>
<div class="line"><span class="lineno">  844</span>  <span class="comment">// Check for latitude/longitude bin crossings</span></div>
<div class="line"><span class="lineno">  845</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a4d35fc1df9d15f0c4c85b08bb7ab597f">RecordLatLonBinCrossings</a>(0, prev_DetDistance, index2, latinfo, loninfo);</div>
<div class="line"><span class="lineno">  846</span>  <span class="comment">// Add the path segment within the detector bin</span></div>
<div class="line"><span class="lineno">  847</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a>(prev_DetDistance, <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index2]);</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>  <span class="comment">// Longitude calculation error message, if needed</span></div>
<div class="line"><span class="lineno">  850</span>  <span class="keywordflow">if</span> (loninfo.error &lt; 0) {</div>
<div class="line"><span class="lineno">  851</span>    cerr</div>
<div class="line"><span class="lineno">  852</span>        &lt;&lt; <span class="stringliteral">&quot;ERROR:  Oops... It turns out that I was wrong about the denominator&quot;</span></div>
<div class="line"><span class="lineno">  853</span>        &lt;&lt; <span class="stringliteral">&quot; of the x(long) equation never being 0 apart from the cases where &quot;</span></div>
<div class="line"><span class="lineno">  854</span>        &lt;&lt; <span class="stringliteral">&quot;sin(Zenith) = 0, sin(Azimuthal) = 0, or cos(Detector Longitude) = &quot;</span></div>
<div class="line"><span class="lineno">  855</span>        &lt;&lt; <span class="stringliteral">&quot;0.&quot;</span></div>
<div class="line"><span class="lineno">  856</span>        &lt;&lt; <span class="stringliteral">&quot;  Send the following message to rpestes@apc.in2p3.fr:&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  857</span>        &lt;&lt; endl</div>
<div class="line"><span class="lineno">  858</span>        &lt;&lt; <span class="stringliteral">&quot;You were wrong about the denominator of x(long)... &quot;</span></div>
<div class="line"><span class="lineno">  859</span>        &lt;&lt; <span class="stringliteral">&quot;Here are the values of the variables that broke it:&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  860</span>        &lt;&lt; <span class="stringliteral">&quot;\tDetector Coordinates (r,lat,lon) = (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  861</span>        &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">fDetLat</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  862</span>        &lt;&lt; <span class="stringliteral">&quot;\tcos(Zenith Angle) = &quot;</span> &lt;&lt; cosT &lt;&lt; endl</div>
<div class="line"><span class="lineno">  863</span>        &lt;&lt; <span class="stringliteral">&quot;\tAzimuthal Angle = &quot;</span> &lt;&lt; phi &lt;&lt; <span class="stringliteral">&quot; deg&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  864</span>        &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; loninfo.err_message &lt;&lt; endl</div>
<div class="line"><span class="lineno">  865</span>        &lt;&lt; <span class="stringliteral">&quot;Please fix this ASAP!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  866</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  867</span>  }</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>  <span class="comment">// Return the number of path segments</span></div>
<div class="line"><span class="lineno">  870</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>.size();</div>
<div class="line"><span class="lineno">  871</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_a3cbe53a328039a65b25736151dc6d586"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">OscProb::EarthModelBase::fRadiusMax</a></div><div class="ttdeci">double fRadiusMax</div><div class="ttdoc">Maximum radius in Earth model (in km)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00076">EarthModelBase.h:76</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_a5c1e80b6c99f58dcbb4eec872f013fdd"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">OscProb::EarthModelBase::fDetLat</a></div><div class="ttdeci">double fDetLat</div><div class="ttdoc">The latitude (in rad) where the detector sits.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00078">EarthModelBase.h:78</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_a9fc2d1736dd6ebdb38cc2da60a44a4de"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">OscProb::EarthModelBase::fDetLon</a></div><div class="ttdeci">double fDetLon</div><div class="ttdoc">The longitude (in rad) where the detector sits.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00079">EarthModelBase.h:79</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_af11bb0a5e0d6348513e46ede9ff16cda"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">OscProb::EarthModelBase::fDetRadius</a></div><div class="ttdeci">double fDetRadius</div><div class="ttdoc">The radius where the detector sits (in km)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00077">EarthModelBase.h:77</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a03fd9f0aa5eeeaba5da75706fd1b4556"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a03fd9f0aa5eeeaba5da75706fd1b4556">OscProb::EarthModelBinned::DetDistForNextLonBin</a></div><div class="ttdeci">virtual double DetDistForNextLonBin(double prev_lon, LonBinInfo &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00501">EarthModelBinned.cxx:501</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a1e3ae04b5d494c60924f817dcb1b3be2"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">OscProb::EarthModelBinned::AddPath</a></div><div class="ttdeci">virtual void AddPath(double length, EarthBin bin)</div><div class="ttdoc">Add a path segment to the sequence.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00408">EarthModelBinned.cxx:408</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a4d35fc1df9d15f0c4c85b08bb7ab597f"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a4d35fc1df9d15f0c4c85b08bb7ab597f">OscProb::EarthModelBinned::RecordLatLonBinCrossings</a></div><div class="ttdeci">virtual void RecordLatLonBinCrossings(double detDist_nextDbin, double &amp;DetDist, int &amp;index, LatBinInfo &amp;latI, LonBinInfo &amp;lonI)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00561">EarthModelBinned.cxx:561</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a50d7e03565438b0f1aa96a69bddb7d55"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">OscProb::EarthModelBinned::fHalfLonBinWidth</a></div><div class="ttdeci">double fHalfLonBinWidth</div><div class="ttdoc">Half-width of each longitude bin.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00328">EarthModelBinned.h:328</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_aa3f56eafc1d45fc28e70ff92e18c632a"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">OscProb::EarthModelBinned::fHalfLatBinWidth</a></div><div class="ttdeci">double fHalfLatBinWidth</div><div class="ttdoc">Half-width of each latitude bin.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00329">EarthModelBinned.h:329</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ab84542bc6b02f9197f79276b1a809339"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">OscProb::EarthModelBinned::fInvLatBinWidth</a></div><div class="ttdeci">double fInvLatBinWidth</div><div class="ttdoc">1/binwidth for each latitude bin</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00327">EarthModelBinned.h:327</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ab87bc7e45352b116395fe0ae04f2bd03"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ab87bc7e45352b116395fe0ae04f2bd03">OscProb::EarthModelBinned::LonBinIndex</a></div><div class="ttdeci">virtual int LonBinIndex(double longitude)</div><div class="ttdoc">Find lon bin index containing longitude.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00630">EarthModelBinned.cxx:630</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ad7d10c0efa1f34b49eebe3562336d377"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ad7d10c0efa1f34b49eebe3562336d377">OscProb::EarthModelBinned::DetDistForNextLatBin</a></div><div class="ttdeci">virtual double DetDistForNextLatBin(int cur_index, LatBinInfo &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00431">EarthModelBinned.cxx:431</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a2be346fc4bf3514317e1092b7c56cced"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a2be346fc4bf3514317e1092b7c56cced">OscProb::TrajConstants::beta</a></div><div class="ttdeci">double beta</div><div class="ttdoc">sin(T)*sin(DetLat)-cos(phi)*cosT*cos(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00141">EarthModelBinned.h:141</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a52d7f7f81e8ce3bc99e7447a4dcd8a64"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a52d7f7f81e8ce3bc99e7447a4dcd8a64">OscProb::TrajConstants::cosA</a></div><div class="ttdeci">double cosA</div><div class="ttdoc">cos(phi)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00116">EarthModelBinned.h:116</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a9e2d2f88f27cbfec6f2a812dee43479e"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a9e2d2f88f27cbfec6f2a812dee43479e">OscProb::TrajConstants::UpdateNuAngles</a></div><div class="ttdeci">void UpdateNuAngles(double cosTheta, double phi)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00027">EarthModelBinned.cxx:27</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_aaf9b5ba81db2f3ed91fefbf8c555fb46"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#aaf9b5ba81db2f3ed91fefbf8c555fb46">OscProb::TrajConstants::cosDetLat</a></div><div class="ttdeci">double cosDetLat</div><div class="ttdoc">cos(DetLat)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00130">EarthModelBinned.h:130</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_ab4892bf4a9c5bacae35e1caf4e58ad78"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#ab4892bf4a9c5bacae35e1caf4e58ad78">OscProb::TrajConstants::sinT</a></div><div class="ttdeci">double sinT</div><div class="ttdoc">sin(T) = sqrt(sinSqT)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00125">EarthModelBinned.h:125</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_acf93c97174b03dfc682d17636a4320a3"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#acf93c97174b03dfc682d17636a4320a3">OscProb::TrajConstants::sinA</a></div><div class="ttdeci">double sinA</div><div class="ttdoc">sin(phi)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00117">EarthModelBinned.h:117</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_aea9fd40eb64ccf33dd796f46261dc596"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#aea9fd40eb64ccf33dd796f46261dc596">OscProb::TrajConstants::Recalculate</a></div><div class="ttdeci">void Recalculate()</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00066">EarthModelBinned.cxx:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8cxx_source.html#l00408">AddPath()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00140">OscProb::TrajConstants::alpha</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00141">OscProb::TrajConstants::beta</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00246">OscProb::EarthModelBinned::LatBinInfo::bin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00268">OscProb::EarthModelBinned::LonBinInfo::bin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00116">OscProb::TrajConstants::cosA</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00130">OscProb::TrajConstants::cosDetLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00119">OscProb::TrajConstants::cosDetLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00248">OscProb::EarthModelBinned::LatBinInfo::detDist_nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00270">OscProb::EarthModelBinned::LonBinInfo::detDist_nextBin</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00431">DetDistForNextLatBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00501">DetDistForNextLonBin()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00258">OscProb::EarthModelBinned::LatBinInfo::dLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00276">OscProb::EarthModelBinned::LonBinInfo::dLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00285">OscProb::EarthModelBinned::LonBinInfo::err_message</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00282">OscProb::EarthModelBinned::LonBinInfo::error</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00320">fC</a>, <a class="el" href="EarthModelBase_8h_source.html#l00078">OscProb::EarthModelBase::fDetLat</a>, <a class="el" href="EarthModelBase_8h_source.html#l00079">OscProb::EarthModelBase::fDetLon</a>, <a class="el" href="EarthModelBase_8h_source.html#l00077">OscProb::EarthModelBase::fDetRadius</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00329">fHalfLatBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00328">fHalfLonBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00327">fInvLatBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00323">fnDepthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00325">fnLatBins</a>, <a class="el" href="EarthModelBase_8h_source.html#l00074">OscProb::EarthModelBase::fNuPath</a>, <a class="el" href="EarthModelBase_8h_source.html#l00076">OscProb::EarthModelBase::fRadiusMax</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00142">OscProb::TrajConstants::gamma</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00630">LonBinIndex()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00281">OscProb::EarthModelBinned::LonBinInfo::max</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00262">OscProb::EarthModelBinned::LatBinInfo::maxreached</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00280">OscProb::EarthModelBinned::LonBinInfo::min</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00247">OscProb::EarthModelBinned::LatBinInfo::nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00269">OscProb::EarthModelBinned::LonBinInfo::nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00132">OscProb::TrajConstants::rDetCosDetLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00138">OscProb::TrajConstants::rDetCosT</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00139">OscProb::TrajConstants::rDetSinT</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00066">OscProb::TrajConstants::Recalculate()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00254">OscProb::EarthModelBinned::LatBinInfo::sign</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00117">OscProb::TrajConstants::sinA</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00120">OscProb::TrajConstants::sinDetLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00125">OscProb::TrajConstants::sinT</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00136">OscProb::TrajConstants::sinTsinAcosDetLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00135">OscProb::TrajConstants::sinTsinAsinDetLon</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00027">OscProb::TrajConstants::UpdateNuAngles()</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00148">OscProb::TrajConstants::xlatextreme</a>.</p>

</div>
</div>
<a id="a7e7fd7dc94d2749ddc1af8db11bda962" name="a7e7fd7dc94d2749ddc1af8db11bda962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e7fd7dc94d2749ddc1af8db11bda962">&#9670;&nbsp;</a></span>GetCosT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EarthModelBase::GetCosT </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the cosTheta for a given total baseline.</p>
<p >Given a baseline, find the direction of the neutrino. This could be useful for experiments with fixed baselines for example.</p>
<p >The baseline must be within the range of possible values in this earth model. Will return vertical neutrinos otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>- The total baseline of the neutrino </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00099">99</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordflow">if</span> (L &lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> - <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a>) <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">if</span> (L &gt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> + <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">return</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> - <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> - L * L) /</div>
<div class="line"><span class="lineno">  105</span>         (2 * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> * L);</div>
<div class="line"><span class="lineno">  106</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00077">OscProb::EarthModelBase::fDetRadius</a>, and <a class="el" href="EarthModelBase_8h_source.html#l00076">OscProb::EarthModelBase::fRadiusMax</a>.</p>

</div>
</div>
<a id="a35e123ebaa3ee3a86259be16bcf22343" name="a35e123ebaa3ee3a86259be16bcf22343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35e123ebaa3ee3a86259be16bcf22343">&#9670;&nbsp;</a></span>GetEarthBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a> &gt; EarthModelBinned::GetEarthBins </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the set of earth layers</p>
<p >Get the set of Earth bins</p>
<p >This returns the set of bins for this Earth model. </p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00116">116</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>.</p>

</div>
</div>
<a id="a78f0fafc9dbdd01fb9fc6dbadf69fb4e" name="a78f0fafc9dbdd01fb9fc6dbadf69fb4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78f0fafc9dbdd01fb9fc6dbadf69fb4e">&#9670;&nbsp;</a></span>GetMergedPaths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt; EarthModelBase::GetMergedPaths </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prec</em> = <code>0.25</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Merge similar paths to reduce number of steps</p>
<p >This method will merge consecutive paths and take their averages until it finds a large enough gap to start a new merged path.</p>
<p >The merged paths will be returned, and the original detailed path will not be changed and will stay stored as an attribute.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prec</td><td>- The precision to merge paths in g/cm^3 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The vector of merged path segments </dd></dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00121">121</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  122</span>{</div>
<div class="line"><span class="lineno">  123</span>  <span class="comment">// The output vector</span></div>
<div class="line"><span class="lineno">  124</span>  vector&lt;NuPath&gt; mergedPath;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  <span class="comment">// Start with the first path</span></div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_struct" href="structOscProb_1_1NuPath.html">NuPath</a> path = <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[0];</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="comment">// Track the total length</span></div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordtype">double</span> totL = 0;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  <span class="comment">// Loop over all paths starting from second</span></div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// If this path electron density is beyond the tolerance</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> (fabs(path.<a class="code hl_variable" href="structOscProb_1_1NuPath.html#a54ddd451db69bc54434de3cf18a117ca">density</a> * path.<a class="code hl_variable" href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">zoa</a> - <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[i].density * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[i].zoa) &gt;</div>
<div class="line"><span class="lineno">  136</span>        prec * path.<a class="code hl_variable" href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">zoa</a>) {</div>
<div class="line"><span class="lineno">  137</span>      <span class="comment">// Add merged path to vector</span></div>
<div class="line"><span class="lineno">  138</span>      mergedPath.push_back(path);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>      <span class="comment">// Set this path as new merged path</span></div>
<div class="line"><span class="lineno">  141</span>      path = <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[i];</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">else</span> { <span class="comment">// If path is within tolerance</span></div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>      <span class="comment">// Merge the path with current merged path</span></div>
<div class="line"><span class="lineno">  146</span>      path = <a class="code hl_function" href="namespaceOscProb.html#ac4f1bdf84ce6aa7a16b6d3c91272d428">AvgPath</a>(path, <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[i]);</div>
<div class="line"><span class="lineno">  147</span>    }</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="comment">// Increment total length</span></div>
<div class="line"><span class="lineno">  150</span>    totL += <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>[i].length;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  } <span class="comment">// End of loop over paths</span></div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">// Add the final merged path to vector</span></div>
<div class="line"><span class="lineno">  155</span>  mergedPath.push_back(path);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">// If tag is true, remove small paths</span></div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a4176958be65c82a111e03c38aeadbe4e">fRemoveSmallPaths</a>) {</div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">// Start at first path</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordtype">int</span> k = 0;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">// While not at the end of vector</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">while</span> (k + 1 &lt; mergedPath.size()) {</div>
<div class="line"><span class="lineno">  164</span>      <span class="comment">// If length is less than 1% of total</span></div>
<div class="line"><span class="lineno">  165</span>      <span class="keywordflow">if</span> (mergedPath[k].length &lt; 0.01 * totL) {</div>
<div class="line"><span class="lineno">  166</span>        <span class="comment">// Merge path with following path</span></div>
<div class="line"><span class="lineno">  167</span>        mergedPath = <a class="code hl_function" href="namespaceOscProb.html#a21f576551c47cf787c2df50a4f4b5c83">MergePaths</a>(mergedPath, k, k + 1);</div>
<div class="line"><span class="lineno">  168</span>      }</div>
<div class="line"><span class="lineno">  169</span>      <span class="comment">// If path is long enough skip it</span></div>
<div class="line"><span class="lineno">  170</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  171</span>        k++;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    } <span class="comment">// End of while loop</span></div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  } <span class="comment">// End of if statement</span></div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <span class="comment">// return the merged vector</span></div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">return</span> mergedPath;</div>
<div class="line"><span class="lineno">  179</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_a4176958be65c82a111e03c38aeadbe4e"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#a4176958be65c82a111e03c38aeadbe4e">OscProb::EarthModelBase::fRemoveSmallPaths</a></div><div class="ttdeci">bool fRemoveSmallPaths</div><div class="ttdoc">Tag whether to merge small paths.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8h_source.html#l00081">EarthModelBase.h:81</a></div></div>
<div class="ttc" id="anamespaceOscProb_html_a21f576551c47cf787c2df50a4f4b5c83"><div class="ttname"><a href="namespaceOscProb.html#a21f576551c47cf787c2df50a4f4b5c83">OscProb::MergePaths</a></div><div class="ttdeci">std::vector&lt; NuPath &gt; MergePaths(std::vector&lt; NuPath &gt; &amp;inputPath, int j, int k)</div><div class="ttdoc">Merge paths j and k in vector.</div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8cxx_source.html#l00089">NuPath.cxx:89</a></div></div>
<div class="ttc" id="anamespaceOscProb_html_ac4f1bdf84ce6aa7a16b6d3c91272d428"><div class="ttname"><a href="namespaceOscProb.html#ac4f1bdf84ce6aa7a16b6d3c91272d428">OscProb::AvgPath</a></div><div class="ttdeci">NuPath AvgPath(NuPath &amp;p1, NuPath &amp;p2)</div><div class="ttdoc">Get the average of two paths.</div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8cxx_source.html#l00027">NuPath.cxx:27</a></div></div>
<div class="ttc" id="astructOscProb_1_1NuPath_html_a54ddd451db69bc54434de3cf18a117ca"><div class="ttname"><a href="structOscProb_1_1NuPath.html#a54ddd451db69bc54434de3cf18a117ca">OscProb::NuPath::density</a></div><div class="ttdeci">double density</div><div class="ttdoc">The density of the path segment in g/cm^3.</div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00079">NuPath.h:79</a></div></div>
<div class="ttc" id="astructOscProb_1_1NuPath_html_af3213f3691ba83c6bc05f4a3490f6b31"><div class="ttname"><a href="structOscProb_1_1NuPath.html#af3213f3691ba83c6bc05f4a3490f6b31">OscProb::NuPath::zoa</a></div><div class="ttdeci">double zoa</div><div class="ttdoc">The effective Z/A value of the path segment.</div><div class="ttdef"><b>Definition:</b> <a href="NuPath_8h_source.html#l00080">NuPath.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="NuPath_8cxx_source.html#l00027">OscProb::AvgPath()</a>, <a class="el" href="NuPath_8h_source.html#l00079">OscProb::NuPath::density</a>, <a class="el" href="EarthModelBase_8h_source.html#l00074">OscProb::EarthModelBase::fNuPath</a>, <a class="el" href="EarthModelBase_8h_source.html#l00081">OscProb::EarthModelBase::fRemoveSmallPaths</a>, <a class="el" href="NuPath_8cxx_source.html#l00089">OscProb::MergePaths()</a>, and <a class="el" href="NuPath_8h_source.html#l00080">OscProb::NuPath::zoa</a>.</p>

</div>
</div>
<a id="aad8f4560e43656b5ea964151b864c99f" name="aad8f4560e43656b5ea964151b864c99f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8f4560e43656b5ea964151b864c99f">&#9670;&nbsp;</a></span>GetNuPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="structOscProb_1_1NuPath.html">NuPath</a> &gt; EarthModelBase::GetNuPath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the current neutrino path sequence</p>
<p >Get the current neutrino path sequence</p>
<p >The path needs to be filled for a given cosTheta before calling this function. </p>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00052">52</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#ae40eaf3d8b666cfd4fe9242decf78121">fNuPath</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00074">OscProb::EarthModelBase::fNuPath</a>.</p>

</div>
</div>
<a id="a019bd087769bbd2958cf8bd6ef5b2092" name="a019bd087769bbd2958cf8bd6ef5b2092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a019bd087769bbd2958cf8bd6ef5b2092">&#9670;&nbsp;</a></span>GetRegionZoA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EarthModelBinned::GetRegionZoA </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the effective Z/A value for all bins in region specified by index, e.g. all outer-core layers. (Assumes that all bins of given index have same Z/A value)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>- The region index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Z/A corresponding to index </dd></dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00347">347</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  348</span>{</div>
<div class="line"><span class="lineno">  349</span>  <span class="keywordflow">if</span> (index &gt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a>) {</div>
<div class="line"><span class="lineno">  350</span>    cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; does not exist in model &quot;</span></div>
<div class="line"><span class="lineno">  351</span>         &lt;&lt; <span class="stringliteral">&quot;(max index = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a> &lt;&lt; <span class="stringliteral">&quot;). Returning 0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  353</span>  }</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  <span class="keywordtype">int</span> nbins = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size();</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbins; i++) {</div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].index != index)</div>
<div class="line"><span class="lineno">  359</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  362</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].zoa;</div>
<div class="line"><span class="lineno">  363</span>  }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>  <span class="comment">// End of vector reached without finding index</span></div>
<div class="line"><span class="lineno">  366</span>  cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; not found! Returning 0&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  367</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  368</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_ac58d53ccb36e3bb4e250af0fa914cc09"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">OscProb::EarthModelBinned::fmaxRegIndex</a></div><div class="ttdeci">int fmaxRegIndex</div><div class="ttdoc">Largest region index in model.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00331">EarthModelBinned.h:331</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00331">fmaxRegIndex</a>.</p>

</div>
</div>
<a id="a3a83f69ca6cb7438917d16afaa376c97" name="a3a83f69ca6cb7438917d16afaa376c97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a83f69ca6cb7438917d16afaa376c97">&#9670;&nbsp;</a></span>GetTotalL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EarthModelBase::GetTotalL </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the total baseline for a given cosTheta.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cosT</td><td>- The cosine of the neutrino direction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00077">77</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">if</span> (fabs(cosT) &gt; 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordtype">double</span> sinsqrT = 1 - cosT * cosT;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">return</span> -<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> * cosT +</div>
<div class="line"><span class="lineno">   84</span>         sqrt(<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> - <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> * sinsqrT);</div>
<div class="line"><span class="lineno">   85</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00077">OscProb::EarthModelBase::fDetRadius</a>, and <a class="el" href="EarthModelBase_8h_source.html#l00076">OscProb::EarthModelBase::fRadiusMax</a>.</p>

</div>
</div>
<a id="a456945c25af7160616ed421228af41e9" name="a456945c25af7160616ed421228af41e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a456945c25af7160616ed421228af41e9">&#9670;&nbsp;</a></span>LoadModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::LoadModel </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Load an earth model from a file.</p>
<p >By default it loads the model stored in EarthTables/earth_binned_default.txt</p>
<p >The row format for the model table needs to be: longitude (deg) latitude (deg) outer depth (km) density (g/cm^3?) Z/A region_index The data in the table must be in order of decreasing depth, followed by increasing longitude, and then increasing latitude. Latitude bin widths and longitude bin widths must each be constant. In each bin of one coordinate, the bins centers for the other coordinates must be the same. This assumes that the center of the Earth is at a depth of 6371km.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>- The txt file containing a table of earth layers </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">189</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  190</span>{</div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">// Clear the current model</span></div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a>();</div>
<div class="line"><span class="lineno">  193</span>  <span class="keywordtype">double</span> EarthRadius = 6371.0;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>  <span class="comment">// Use default if no file provided</span></div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordflow">if</span> (filename == <span class="stringliteral">&quot;&quot;</span>) { filename = PREM3D_DEFAULT; }</div>
<div class="line"><span class="lineno">  197</span>  cout &lt;&lt; <span class="stringliteral">&quot;Loading Earth model table from &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>  <span class="comment">// Open the file</span></div>
<div class="line"><span class="lineno">  200</span>  ifstream fin;</div>
<div class="line"><span class="lineno">  201</span>  fin.open(filename.c_str());</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordflow">if</span> (!fin) {</div>
<div class="line"><span class="lineno">  203</span>    cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: File &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  205</span>  }</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">// Variables for storing table rows</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordtype">float</span> depth, latitude, longitude, density, zoa, index;</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// Keep track of previous depth/latitude/longitude</span></div>
<div class="line"><span class="lineno">  211</span>  <span class="keywordtype">double</span> radius_prev = 0;</div>
<div class="line"><span class="lineno">  212</span>  <span class="keywordtype">double</span> lat_prev    = -90.0;</div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordtype">double</span> lon_prev    = 0;</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">// Hold onto previous different depth, so we have depth maximum for bin</span></div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordtype">double</span> radius_min = radius_prev;</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  <span class="comment">// Initialize max region index</span></div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a> = -1;</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <span class="comment">// Loop over table rows</span></div>
<div class="line"><span class="lineno">  222</span>  <span class="keywordflow">while</span> (fin &gt;&gt; longitude &gt;&gt; latitude &gt;&gt; depth &gt;&gt; density &gt;&gt; zoa &gt;&gt; index) {</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordtype">double</span> outer_radius = EarthRadius - depth;</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="comment">// Move minimum depth (and reset latitude/longitude) if depth has changed</span></div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">// from previous one</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> (outer_radius &gt; radius_prev) {</div>
<div class="line"><span class="lineno">  228</span>      radius_min = radius_prev;</div>
<div class="line"><span class="lineno">  229</span>      lat_prev   = -90.0;</div>
<div class="line"><span class="lineno">  230</span>      lon_prev   = 0.0;</div>
<div class="line"><span class="lineno">  231</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a>++;</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (outer_radius &lt;</div>
<div class="line"><span class="lineno">  234</span>             radius_prev) { <span class="comment">// Depths must be ordered in model file</span></div>
<div class="line"><span class="lineno">  235</span>      cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Depths are not sorted in decreasing order in the model &quot;</span></div>
<div class="line"><span class="lineno">  236</span>              <span class="stringliteral">&quot;file &quot;</span></div>
<div class="line"><span class="lineno">  237</span>           &lt;&lt; <span class="stringliteral">&quot;(or depth is greater than &quot;</span> &lt;&lt; EarthRadius &lt;&lt; <span class="stringliteral">&quot; km).&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  238</span>      <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a>();</div>
<div class="line"><span class="lineno">  239</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  240</span>    }</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (longitude &gt; lon_prev) { <span class="comment">// Reset latitude if longitude has changed</span></div>
<div class="line"><span class="lineno">  242</span>                                     <span class="comment">// from previous one</span></div>
<div class="line"><span class="lineno">  243</span>      lat_prev = -90.0;</div>
<div class="line"><span class="lineno">  244</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a>++;</div>
<div class="line"><span class="lineno">  245</span>    }</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (longitude &lt; lon_prev) { <span class="comment">// Longitudes must be ordered in model file</span></div>
<div class="line"><span class="lineno">  247</span>                                     <span class="comment">// (after depths)</span></div>
<div class="line"><span class="lineno">  248</span>      cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Longitudes are not sorted in increasing order (after &quot;</span></div>
<div class="line"><span class="lineno">  249</span>              <span class="stringliteral">&quot;depths) in the model file.&quot;</span></div>
<div class="line"><span class="lineno">  250</span>           &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  251</span>      <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a>();</div>
<div class="line"><span class="lineno">  252</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (latitude &lt; lat_prev) { <span class="comment">// Latitudes must be ordered in model file</span></div>
<div class="line"><span class="lineno">  255</span>                                    <span class="comment">// (after longitudes)</span></div>
<div class="line"><span class="lineno">  256</span>      cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Latitudes are not sorted in increasing order (after &quot;</span></div>
<div class="line"><span class="lineno">  257</span>              <span class="stringliteral">&quot;longitudes) in the model file.&quot;</span></div>
<div class="line"><span class="lineno">  258</span>           &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  259</span>      <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a>();</div>
<div class="line"><span class="lineno">  260</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  261</span>    }</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <span class="comment">// Add this bin to the model</span></div>
<div class="line"><span class="lineno">  264</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a7fff4e60498ca07cda7becc2c98b9cd6">AddBin</a>(outer_radius, radius_min, latitude, longitude, density, zoa, index);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="comment">// Check region index</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">if</span> (index &gt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a>) { <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a> = index; }</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="comment">// Set previous coordinates for next bin</span></div>
<div class="line"><span class="lineno">  270</span>    radius_prev = outer_radius;</div>
<div class="line"><span class="lineno">  271</span>    lat_prev    = latitude;</div>
<div class="line"><span class="lineno">  272</span>    lon_prev    = longitude;</div>
<div class="line"><span class="lineno">  273</span>  }</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  <span class="comment">// Set Outermost Radius</span></div>
<div class="line"><span class="lineno">  276</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a3cbe53a328039a65b25736151dc6d586">fRadiusMax</a> = radius_prev;</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>  <span class="comment">// Modify number of longitude bins to how many there actually are (instead of</span></div>
<div class="line"><span class="lineno">  279</span>  <span class="comment">// how many times we changed the longitude bin without changing the depth bin</span></div>
<div class="line"><span class="lineno">  280</span>  <span class="comment">// = nLonBins-1 times per depth bin)</span></div>
<div class="line"><span class="lineno">  281</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a>        = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a> / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a> + 1;</div>
<div class="line"><span class="lineno">  282</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a104ef294d4ac7099ebb4a8531f45ddae">fInvLonBinWidth</a>  = 0.5 * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a> / M_PI; <span class="comment">// in radians^(-1)</span></div>
<div class="line"><span class="lineno">  283</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">fHalfLonBinWidth</a> = M_PI / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a>;       <span class="comment">// in radians</span></div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>  <span class="comment">// Calculate number of latitude bins</span></div>
<div class="line"><span class="lineno">  286</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a>        = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size() / (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a> * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a>);</div>
<div class="line"><span class="lineno">  287</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ab84542bc6b02f9197f79276b1a809339">fInvLatBinWidth</a>  = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a> / M_PI;       <span class="comment">// in radians^(-1)</span></div>
<div class="line"><span class="lineno">  288</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a> = 0.5 * M_PI / <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a>; <span class="comment">// in radians</span></div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">// Error if first latitude bin center deviates from about half of the</span></div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// calculated latitude bin width</span></div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordflow">if</span> (abs(<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a> - (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[0].latitude + 0.5 * M_PI)) &gt;</div>
<div class="line"><span class="lineno">  293</span>      <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a> * 0.01) { <span class="comment">// Warn if first latitude bin center isn&#39;t</span></div>
<div class="line"><span class="lineno">  294</span>                                 <span class="comment">// about half of the latitude bin width</span></div>
<div class="line"><span class="lineno">  295</span>    cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Latitude of 1st bin center (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[0].latitude</div>
<div class="line"><span class="lineno">  296</span>         &lt;&lt; <span class="stringliteral">&quot;) is not in the middle of the first bin, whose size should be &quot;</span></div>
<div class="line"><span class="lineno">  297</span>         &lt;&lt; 2 * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#aa3f56eafc1d45fc28e70ff92e18c632a">fHalfLatBinWidth</a> &lt;&lt; <span class="stringliteral">&quot; rad, as calculated from having &quot;</span></div>
<div class="line"><span class="lineno">  298</span>         &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a> &lt;&lt; <span class="stringliteral">&quot; latitude bins.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">ClearModel</a>();</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  301</span>  }</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  cout &lt;&lt; <span class="stringliteral">&quot;\t...done (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size() &lt;&lt; <span class="stringliteral">&quot; bins: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a269a23478b10150833e98908e177f584">fnDepthBins</a></div>
<div class="line"><span class="lineno">  304</span>       &lt;&lt; <span class="stringliteral">&quot; depth, &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a> &lt;&lt; <span class="stringliteral">&quot; latitude, and &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ade362672b6324e8a619a584690f8321c">fnLonBins</a></div>
<div class="line"><span class="lineno">  305</span>       &lt;&lt; <span class="stringliteral">&quot; longitude).&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  306</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a0cd434f08ca3d4d48ee339b9c16446e8"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a0cd434f08ca3d4d48ee339b9c16446e8">OscProb::EarthModelBinned::ClearModel</a></div><div class="ttdeci">virtual void ClearModel()</div><div class="ttdoc">Clear the earth model information.</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00122">EarthModelBinned.cxx:122</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a104ef294d4ac7099ebb4a8531f45ddae"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a104ef294d4ac7099ebb4a8531f45ddae">OscProb::EarthModelBinned::fInvLonBinWidth</a></div><div class="ttdeci">double fInvLonBinWidth</div><div class="ttdoc">1/binwidth for each longitude bin</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8h_source.html#l00326">EarthModelBinned.h:326</a></div></div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBinned_html_a7fff4e60498ca07cda7becc2c98b9cd6"><div class="ttname"><a href="classOscProb_1_1EarthModelBinned.html#a7fff4e60498ca07cda7becc2c98b9cd6">OscProb::EarthModelBinned::AddBin</a></div><div class="ttdeci">virtual void AddBin(double radius_out, double radius_in, double latitude, double longitude, double density, double zoa, double layer)</div><div class="ttdoc">Add a bin to the model (angles in degrees)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00162">EarthModelBinned.cxx:162</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8cxx_source.html#l00162">AddBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">ClearModel()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00329">fHalfLatBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00328">fHalfLonBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00327">fInvLatBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00326">fInvLonBinWidth</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00331">fmaxRegIndex</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00323">fnDepthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00325">fnLatBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00324">fnLonBins</a>, and <a class="el" href="EarthModelBase_8h_source.html#l00076">OscProb::EarthModelBase::fRadiusMax</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00096">EarthModelBinned()</a>.</p>

</div>
</div>
<a id="ab87bc7e45352b116395fe0ae04f2bd03" name="ab87bc7e45352b116395fe0ae04f2bd03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87bc7e45352b116395fe0ae04f2bd03">&#9670;&nbsp;</a></span>LonBinIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EarthModelBinned::LonBinIndex </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>longitude</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Find and return longitude bin index that contains longitude.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">longitude</td><td>- longitude for which bin is found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00630">630</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  631</span>{</div>
<div class="line"><span class="lineno">  632</span>  <span class="comment">// Find difference between longitude and beginning of first lon bin</span></div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordtype">double</span> londiff = longitude - (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[0].longitude - <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a50d7e03565438b0f1aa96a69bddb7d55">fHalfLonBinWidth</a>);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="comment">// Shift londiff to be between 0 and 2pi</span></div>
<div class="line"><span class="lineno">  636</span>  <span class="keywordflow">if</span> (londiff &lt; 0 || londiff &gt;= 2 * M_PI)</div>
<div class="line"><span class="lineno">  637</span>    londiff -= floor(londiff / (2 * M_PI));</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>  <span class="comment">// Number of binwidths after from first lon bin</span></div>
<div class="line"><span class="lineno">  640</span>  <span class="keywordflow">return</span> floor(londiff * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a104ef294d4ac7099ebb4a8531f45ddae">fInvLonBinWidth</a>);</div>
<div class="line"><span class="lineno">  641</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00328">fHalfLonBinWidth</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00326">fInvLonBinWidth</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>.</p>

</div>
</div>
<a id="a4d35fc1df9d15f0c4c85b08bb7ab597f" name="a4d35fc1df9d15f0c4c85b08bb7ab597f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d35fc1df9d15f0c4c85b08bb7ab597f">&#9670;&nbsp;</a></span>RecordLatLonBinCrossings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::RecordLatLonBinCrossings </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>detDist_nextDbin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>DetDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LatBinInfo.html">LatBinInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>latI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structOscProb_1_1EarthModelBinned_1_1LonBinInfo.html">LonBinInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>lonI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Record path segments for each latitude/longitude bin crossed before reaching detDist_nextDbin</p>
<p >Record all the path segments as the neutrino crosses into new latitude and longitude bins until it reaches the next depth bin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">detDist_nextDbin</td><td>- Distance from the detector at which neutrino passes into next depth bin </td></tr>
    <tr><td class="paramname">DetDist</td><td>- Current distance from the detector </td></tr>
    <tr><td class="paramname">index</td><td>- Index of current Earth bin </td></tr>
    <tr><td class="paramname">latI</td><td>- Information about lat bin crossings </td></tr>
    <tr><td class="paramname">lonI</td><td>- Information about lon bin crossings </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">561</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>{</div>
<div class="line"><span class="lineno">  566</span>  <span class="comment">// Keep going as long as there is a lat or lon bin crossing before</span></div>
<div class="line"><span class="lineno">  567</span>  <span class="comment">// the next depth bin crossing</span></div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordflow">while</span> (detDist_nextDbin &lt; latI.detDist_nextBin ||</div>
<div class="line"><span class="lineno">  569</span>         detDist_nextDbin &lt; lonI.detDist_nextBin) {</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">if</span> (latI.detDist_nextBin &gt;</div>
<div class="line"><span class="lineno">  571</span>        lonI.detDist_nextBin) { <span class="comment">// if next lat bin crossing is before next lon</span></div>
<div class="line"><span class="lineno">  572</span>                                <span class="comment">// bin crossing</span></div>
<div class="line"><span class="lineno">  573</span>      <span class="comment">// Add segment to next lat bin to path</span></div>
<div class="line"><span class="lineno">  574</span>      <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a>(DetDist - latI.detDist_nextBin, <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index]);</div>
<div class="line"><span class="lineno">  575</span>      <span class="keywordtype">double</span> latitude_crossing =</div>
<div class="line"><span class="lineno">  576</span>          <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index].latitude + latI.sign * latI.dLat;</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>      <span class="comment">// Move lat bins</span></div>
<div class="line"><span class="lineno">  579</span>      DetDist = latI.detDist_nextBin;</div>
<div class="line"><span class="lineno">  580</span>      index += latI.nextBin - latI.bin;</div>
<div class="line"><span class="lineno">  581</span>      latI.bin = latI.nextBin;</div>
<div class="line"><span class="lineno">  582</span>      <span class="comment">//      cout &lt;&lt; &quot;Latitude bin crossing at x=&quot; &lt;&lt; DetDist &lt;&lt; &quot;km,lat=&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  583</span>      <span class="comment">//      latitude_crossing &lt;&lt; &quot;rad...now in Earth bin &quot; &lt;&lt; index &lt;&lt; &quot; = (r&quot;</span></div>
<div class="line"><span class="lineno">  584</span>      <span class="comment">//      &lt;&lt; floor(index/(fnLonBins*fnLatBins)) &lt;&lt; &quot;, lon&quot; &lt;&lt; lonI.bin &lt;&lt; &quot;,</span></div>
<div class="line"><span class="lineno">  585</span>      <span class="comment">//      lat&quot; &lt;&lt; latI.bin &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>      <span class="comment">// Find next lat bin</span></div>
<div class="line"><span class="lineno">  588</span>      <span class="keywordflow">if</span> (latI.dLat ==</div>
<div class="line"><span class="lineno">  589</span>          0) { <span class="comment">// Only 1 lat bin crossing along entire neutrino trajectory</span></div>
<div class="line"><span class="lineno">  590</span>        latI.detDist_nextBin = -1;</div>
<div class="line"><span class="lineno">  591</span>      }</div>
<div class="line"><span class="lineno">  592</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  593</span>        latI.detDist_nextBin = <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#ad7d10c0efa1f34b49eebe3562336d377">DetDistForNextLatBin</a>(index, latI);</div>
<div class="line"><span class="lineno">  594</span>        latI.nextBin         = latI.bin + latI.sign;</div>
<div class="line"><span class="lineno">  595</span>      }</div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>    <span class="keywordflow">else</span> { <span class="comment">// if next lon bin crossing is before (or simultaneous with) next lat</span></div>
<div class="line"><span class="lineno">  598</span>           <span class="comment">// bin corssing</span></div>
<div class="line"><span class="lineno">  599</span>      <span class="comment">// Add segment to next lon bin to path</span></div>
<div class="line"><span class="lineno">  600</span>      <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a1e3ae04b5d494c60924f817dcb1b3be2">AddPath</a>(DetDist - lonI.detDist_nextBin, <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index]);</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>      <span class="comment">// Move lon bins</span></div>
<div class="line"><span class="lineno">  603</span>      DetDist = lonI.detDist_nextBin;</div>
<div class="line"><span class="lineno">  604</span>      index += (lonI.nextBin - lonI.bin) * <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a70d55291b081a7e3e0ad785d13419506">fnLatBins</a>;</div>
<div class="line"><span class="lineno">  605</span>      lonI.bin = lonI.nextBin;</div>
<div class="line"><span class="lineno">  606</span>      <span class="comment">//      cout &lt;&lt; &quot;Longitude bin crossing at x=&quot; &lt;&lt; DetDist &lt;&lt; &quot;km...now in</span></div>
<div class="line"><span class="lineno">  607</span>      <span class="comment">//      Earth bin &quot; &lt;&lt; index &lt;&lt; &quot; = (r&quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno">  608</span>      <span class="comment">//      floor(index/(fnLonBins*fnLatBins)) &lt;&lt; &quot;, lon&quot; &lt;&lt; lonI.bin &lt;&lt; &quot;,</span></div>
<div class="line"><span class="lineno">  609</span>      <span class="comment">//      lat&quot; &lt;&lt; latI.bin &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>      <span class="comment">// Find next lon bin</span></div>
<div class="line"><span class="lineno">  612</span>      <span class="keywordflow">if</span> (lonI.dLon ==</div>
<div class="line"><span class="lineno">  613</span>          0) { <span class="comment">// Only 1 lon bin crossing along entire neutrino trajectory</span></div>
<div class="line"><span class="lineno">  614</span>        lonI.detDist_nextBin = -1;</div>
<div class="line"><span class="lineno">  615</span>      }</div>
<div class="line"><span class="lineno">  616</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  617</span>        lonI.detDist_nextBin =</div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_function" href="classOscProb_1_1EarthModelBinned.html#a03fd9f0aa5eeeaba5da75706fd1b4556">DetDistForNextLonBin</a>(<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[index].longitude, lonI);</div>
<div class="line"><span class="lineno">  619</span>      }</div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span>  }</div>
<div class="line"><span class="lineno">  622</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8cxx_source.html#l00408">AddPath()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00246">OscProb::EarthModelBinned::LatBinInfo::bin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00268">OscProb::EarthModelBinned::LonBinInfo::bin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00248">OscProb::EarthModelBinned::LatBinInfo::detDist_nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00270">OscProb::EarthModelBinned::LonBinInfo::detDist_nextBin</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00431">DetDistForNextLatBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00501">DetDistForNextLonBin()</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00258">OscProb::EarthModelBinned::LatBinInfo::dLat</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00276">OscProb::EarthModelBinned::LonBinInfo::dLon</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00325">fnLatBins</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00247">OscProb::EarthModelBinned::LatBinInfo::nextBin</a>, <a class="el" href="EarthModelBinned_8h_source.html#l00269">OscProb::EarthModelBinned::LonBinInfo::nextBin</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00254">OscProb::EarthModelBinned::LatBinInfo::sign</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>.</p>

</div>
</div>
<a id="ad5e7b25114c4f0d8c3fd998c1e6bf559" name="ad5e7b25114c4f0d8c3fd998c1e6bf559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e7b25114c4f0d8c3fd998c1e6bf559">&#9670;&nbsp;</a></span>ScaleRegionDensity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::ScaleRegionDensity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set Z/A of all bins with specified region index</p>
<p >Scale density by scaling factor for all bins in region specified by given index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>- The region index </td></tr>
    <tr><td class="paramname">factor</td><td>- The scaling factor for changing the density </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00378">378</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  379</span>{</div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordflow">if</span> (index &gt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a>) {</div>
<div class="line"><span class="lineno">  381</span>    cerr &lt;&lt; <span class="stringliteral">&quot;WARNING: Index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; does not exist in model &quot;</span></div>
<div class="line"><span class="lineno">  382</span>         &lt;&lt; <span class="stringliteral">&quot;(max index = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a> &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  383</span>         &lt;&lt; <span class="stringliteral">&quot;Doing nothing.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  385</span>  }</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>  <span class="keywordtype">int</span> nbins = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size();</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>  <span class="comment">// Loop over all bins and change the ones</span></div>
<div class="line"><span class="lineno">  390</span>  <span class="comment">// with the given index</span></div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbins; i++) {</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].index != index) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordtype">double</span> density_init   = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].density;</div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].density = factor * density_init;</div>
<div class="line"><span class="lineno">  396</span>  }</div>
<div class="line"><span class="lineno">  397</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00331">fmaxRegIndex</a>.</p>

</div>
</div>
<a id="af7f17dd5f4b429897b5f3d027bdb37fe" name="af7f17dd5f4b429897b5f3d027bdb37fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f17dd5f4b429897b5f3d027bdb37fe">&#9670;&nbsp;</a></span>SetDetectorCoordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBase::SetDetectorCoordinates </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set the coordinates of the detector (rad = radius in km, lat/lon in deg)</p>
<p >Set the coordinates of the detector: radius in km, latitude in degrees, longitude in degrees</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rad</td><td>- The distance from the detector to the Earth's center in km </td></tr>
    <tr><td class="paramname">lat</td><td>- The latitude of the detector in deg N (between -90 and 90) </td></tr>
    <tr><td class="paramname">lon</td><td>- The longitude of the detector in deg E (between 0 and 360) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00025">25</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>  <span class="comment">// Force radius to be non-negative</span></div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordflow">if</span> (rad &lt; 0) {</div>
<div class="line"><span class="lineno">   29</span>    cerr &lt;&lt; <span class="stringliteral">&quot;WARNING: Negative radius detected. Setting to absolute value.&quot;</span></div>
<div class="line"><span class="lineno">   30</span>         &lt;&lt; endl;</div>
<div class="line"><span class="lineno">   31</span>    rad = -rad;</div>
<div class="line"><span class="lineno">   32</span>  }</div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a> = rad;</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">// Force latitude to be between -90 and 90 deg</span></div>
<div class="line"><span class="lineno">   36</span>  lat -= floor((lat + 90.0) / 360.0) * 360.0;</div>
<div class="line"><span class="lineno">   37</span>  <span class="keywordflow">if</span> (lat &gt; 90) { lat = 180.0 - lat; }</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">fDetLat</a> = lat / 180.0 * M_PI; <span class="comment">// convert to radians</span></div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="comment">// Force longitude to be between 0 and 360 deg</span></div>
<div class="line"><span class="lineno">   41</span>  lon -= floor(lon / 360.0) * 360.0;</div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a> = lon / 180.0 * M_PI; <span class="comment">// convert to radians</span></div>
<div class="line"><span class="lineno">   43</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00078">OscProb::EarthModelBase::fDetLat</a>, <a class="el" href="EarthModelBase_8h_source.html#l00079">OscProb::EarthModelBase::fDetLon</a>, and <a class="el" href="EarthModelBase_8h_source.html#l00077">OscProb::EarthModelBase::fDetRadius</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00131">OscProb::PremModel::SetDetPos()</a>.</p>

</div>
</div>
<a id="a63c15aa64deadcd3e792c182d7ebd133" name="a63c15aa64deadcd3e792c182d7ebd133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c15aa64deadcd3e792c182d7ebd133">&#9670;&nbsp;</a></span>SetDetPos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::SetDetPos </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lon</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set the detector position (rad = radius in km, lat/lon in deg)</p>
<p >Set the coordinates of the detector: radius in km, latitude in degrees, longitude in degrees Also, updates the detector-coordinate-dependent parts of the trajectory constants.</p>
<p >Note: If lat = -90 (or 90), lon (or -lon) defines where the azimuthal angle for the neutrino's trajectory is 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rad</td><td>- The distance from the detector to the Earth's center in km </td></tr>
    <tr><td class="paramname">lat</td><td>- The latitude of the detector in deg N (between -90 and 90) </td></tr>
    <tr><td class="paramname">lon</td><td>- The longitude of the detector in deg E (between 0 and 360) </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classOscProb_1_1EarthModelBase.html#ac5fb0679e8095f3e1502dd1876eacae8">OscProb::EarthModelBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">144</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>{</div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_function" href="classOscProb_1_1EarthModelBase.html#af7f17dd5f4b429897b5f3d027bdb37fe">SetDetectorCoordinates</a>(rad, lat, lon);</div>
<div class="line"><span class="lineno">  147</span>  <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac1048e55f7edf48d192c119805deca8d">fC</a>.<a class="code hl_function" href="structOscProb_1_1TrajConstants.html#a926dabbc669d99deb962faeb0b0f798e">UpdateDetPos</a>(<a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#af11bb0a5e0d6348513e46ede9ff16cda">fDetRadius</a>, <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a5c1e80b6c99f58dcbb4eec872f013fdd">fDetLat</a>, <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a9fc2d1736dd6ebdb38cc2da60a44a4de">fDetLon</a>);</div>
<div class="line"><span class="lineno">  148</span>}</div>
<div class="ttc" id="aclassOscProb_1_1EarthModelBase_html_af7f17dd5f4b429897b5f3d027bdb37fe"><div class="ttname"><a href="classOscProb_1_1EarthModelBase.html#af7f17dd5f4b429897b5f3d027bdb37fe">OscProb::EarthModelBase::SetDetectorCoordinates</a></div><div class="ttdeci">virtual void SetDetectorCoordinates(double rad, double lat, double lon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBase_8cxx_source.html#l00025">EarthModelBase.cxx:25</a></div></div>
<div class="ttc" id="astructOscProb_1_1TrajConstants_html_a926dabbc669d99deb962faeb0b0f798e"><div class="ttname"><a href="structOscProb_1_1TrajConstants.html#a926dabbc669d99deb962faeb0b0f798e">OscProb::TrajConstants::UpdateDetPos</a></div><div class="ttdeci">void UpdateDetPos(double rDet, double DetLat, double DetLon)</div><div class="ttdef"><b>Definition:</b> <a href="EarthModelBinned_8cxx_source.html#l00049">EarthModelBinned.cxx:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00320">fC</a>, <a class="el" href="EarthModelBase_8h_source.html#l00078">OscProb::EarthModelBase::fDetLat</a>, <a class="el" href="EarthModelBase_8h_source.html#l00079">OscProb::EarthModelBase::fDetLon</a>, <a class="el" href="EarthModelBase_8h_source.html#l00077">OscProb::EarthModelBase::fDetRadius</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00025">OscProb::EarthModelBase::SetDetectorCoordinates()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00049">OscProb::TrajConstants::UpdateDetPos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00096">EarthModelBinned()</a>.</p>

</div>
</div>
<a id="a6576633bae966613e9eb07305c1c3aae" name="a6576633bae966613e9eb07305c1c3aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6576633bae966613e9eb07305c1c3aae">&#9670;&nbsp;</a></span>SetRegionZoA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBinned::SetRegionZoA </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set the effective Z/A value for all bins with given region index.</p>
<p >Use this to change the Z/A of indexed bin, e.g. all outer-core layers</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>- The region index </td></tr>
    <tr><td class="paramname">zoa</td><td>- The effective Z/A value to use </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8cxx_source.html#l00318">318</a> of file <a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span>{</div>
<div class="line"><span class="lineno">  320</span>  <span class="keywordflow">if</span> (index &gt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a>) {</div>
<div class="line"><span class="lineno">  321</span>    cerr &lt;&lt; <span class="stringliteral">&quot;WARNING: Index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; does not exist in model &quot;</span></div>
<div class="line"><span class="lineno">  322</span>         &lt;&lt; <span class="stringliteral">&quot;(max index = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#ac58d53ccb36e3bb4e250af0fa914cc09">fmaxRegIndex</a> &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; endl</div>
<div class="line"><span class="lineno">  323</span>         &lt;&lt; <span class="stringliteral">&quot;Doing nothing.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  325</span>  }</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordtype">int</span> nbins = <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>.size();</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">// Loop over all bins and change the ones</span></div>
<div class="line"><span class="lineno">  330</span>  <span class="comment">// with the given index</span></div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbins; i++) {</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].index != index) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <a class="code hl_variable" href="classOscProb_1_1EarthModelBinned.html#a0ccb848f9c2f2b461ec1a887edf86d48">fEarthBins</a>[i].zoa = zoa;</div>
<div class="line"><span class="lineno">  335</span>  }</div>
<div class="line"><span class="lineno">  336</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBinned_8h_source.html#l00322">fEarthBins</a>, and <a class="el" href="EarthModelBinned_8h_source.html#l00331">fmaxRegIndex</a>.</p>

</div>
</div>
<a id="abc6399e4d3ec17a360f2fe3f7d39576c" name="abc6399e4d3ec17a360f2fe3f7d39576c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6399e4d3ec17a360f2fe3f7d39576c">&#9670;&nbsp;</a></span>SetRemoveSmallPaths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EarthModelBase::SetRemoveSmallPaths </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rp</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set the boolean to tag whether to remove small paths when merging Small is defined as &lt;1% of the total baseline</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rp</td><td>- Boolean value to set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8cxx_source.html#l00188">188</a> of file <a class="el" href="EarthModelBase_8cxx_source.html">EarthModelBase.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>{ <a class="code hl_variable" href="classOscProb_1_1EarthModelBase.html#a4176958be65c82a111e03c38aeadbe4e">fRemoveSmallPaths</a> = rp; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EarthModelBase_8h_source.html#l00081">OscProb::EarthModelBase::fRemoveSmallPaths</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00096">EarthModelBinned()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00035">OscProb::PremModel::PremModel()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac1048e55f7edf48d192c119805deca8d" name="ac1048e55f7edf48d192c119805deca8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1048e55f7edf48d192c119805deca8d">&#9670;&nbsp;</a></span>fC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOscProb_1_1TrajConstants.html">TrajConstants</a> OscProb::EarthModelBinned::fC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00320">320</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00431">DetDistForNextLatBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00501">DetDistForNextLonBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>.</p>

</div>
</div>
<a id="a5c1e80b6c99f58dcbb4eec872f013fdd" name="a5c1e80b6c99f58dcbb4eec872f013fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c1e80b6c99f58dcbb4eec872f013fdd">&#9670;&nbsp;</a></span>fDetLat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBase::fDetLat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00078">78</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00025">OscProb::EarthModelBase::SetDetectorCoordinates()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>.</p>

</div>
</div>
<a id="a9fc2d1736dd6ebdb38cc2da60a44a4de" name="a9fc2d1736dd6ebdb38cc2da60a44a4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc2d1736dd6ebdb38cc2da60a44a4de">&#9670;&nbsp;</a></span>fDetLon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBase::fDetLon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00079">79</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00025">OscProb::EarthModelBase::SetDetectorCoordinates()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>.</p>

</div>
</div>
<a id="af11bb0a5e0d6348513e46ede9ff16cda" name="af11bb0a5e0d6348513e46ede9ff16cda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af11bb0a5e0d6348513e46ede9ff16cda">&#9670;&nbsp;</a></span>fDetRadius</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBase::fDetRadius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00077">77</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PremModel_8cxx_source.html#l00073">OscProb::PremModel::AddDetLayer()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00347">OscProb::PremModel::FillPath()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00099">OscProb::EarthModelBase::GetCosT()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00077">OscProb::EarthModelBase::GetTotalL()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00025">OscProb::EarthModelBase::SetDetectorCoordinates()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00144">SetDetPos()</a>.</p>

</div>
</div>
<a id="a0ccb848f9c2f2b461ec1a887edf86d48" name="a0ccb848f9c2f2b461ec1a887edf86d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ccb848f9c2f2b461ec1a887edf86d48">&#9670;&nbsp;</a></span>fEarthBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structOscProb_1_1EarthBin.html">EarthBin</a>&gt; OscProb::EarthModelBinned::fEarthBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00322">322</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00162">AddBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">ClearModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00431">DetDistForNextLatBin()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00116">GetEarthBins()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00347">GetRegionZoA()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00630">LonBinIndex()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00378">ScaleRegionDensity()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00318">SetRegionZoA()</a>.</p>

</div>
</div>
<a id="ade89889b7f38d79dc273e6654691fdc3" name="ade89889b7f38d79dc273e6654691fdc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade89889b7f38d79dc273e6654691fdc3">&#9670;&nbsp;</a></span>fErrorMessage_LonInfo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string OscProb::EarthModelBinned::fErrorMessage_LonInfo</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Part of error message containing the longitude information </p>

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00334">334</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

</div>
</div>
<a id="aa3f56eafc1d45fc28e70ff92e18c632a" name="aa3f56eafc1d45fc28e70ff92e18c632a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f56eafc1d45fc28e70ff92e18c632a">&#9670;&nbsp;</a></span>fHalfLatBinWidth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBinned::fHalfLatBinWidth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00329">329</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="a50d7e03565438b0f1aa96a69bddb7d55" name="a50d7e03565438b0f1aa96a69bddb7d55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d7e03565438b0f1aa96a69bddb7d55">&#9670;&nbsp;</a></span>fHalfLonBinWidth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBinned::fHalfLonBinWidth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00328">328</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00630">LonBinIndex()</a>.</p>

</div>
</div>
<a id="ab84542bc6b02f9197f79276b1a809339" name="ab84542bc6b02f9197f79276b1a809339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84542bc6b02f9197f79276b1a809339">&#9670;&nbsp;</a></span>fInvLatBinWidth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBinned::fInvLatBinWidth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00327">327</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="a104ef294d4ac7099ebb4a8531f45ddae" name="a104ef294d4ac7099ebb4a8531f45ddae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a104ef294d4ac7099ebb4a8531f45ddae">&#9670;&nbsp;</a></span>fInvLonBinWidth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBinned::fInvLonBinWidth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00326">326</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00630">LonBinIndex()</a>.</p>

</div>
</div>
<a id="a326ad46fde69ecbe295cd41419eb868b" name="a326ad46fde69ecbe295cd41419eb868b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326ad46fde69ecbe295cd41419eb868b">&#9670;&nbsp;</a></span>fLonError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::EarthModelBinned::fLonError</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00336">336</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00096">EarthModelBinned()</a>.</p>

</div>
</div>
<a id="ac58d53ccb36e3bb4e250af0fa914cc09" name="ac58d53ccb36e3bb4e250af0fa914cc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac58d53ccb36e3bb4e250af0fa914cc09">&#9670;&nbsp;</a></span>fmaxRegIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::EarthModelBinned::fmaxRegIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00331">331</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00347">GetRegionZoA()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00378">ScaleRegionDensity()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00318">SetRegionZoA()</a>.</p>

</div>
</div>
<a id="a269a23478b10150833e98908e177f584" name="a269a23478b10150833e98908e177f584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a269a23478b10150833e98908e177f584">&#9670;&nbsp;</a></span>fnDepthBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::EarthModelBinned::fnDepthBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00323">323</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">ClearModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="a70d55291b081a7e3e0ad785d13419506" name="a70d55291b081a7e3e0ad785d13419506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d55291b081a7e3e0ad785d13419506">&#9670;&nbsp;</a></span>fnLatBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::EarthModelBinned::fnLatBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00325">325</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">ClearModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00561">RecordLatLonBinCrossings()</a>.</p>

</div>
</div>
<a id="ade362672b6324e8a619a584690f8321c" name="ade362672b6324e8a619a584690f8321c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade362672b6324e8a619a584690f8321c">&#9670;&nbsp;</a></span>fnLonBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int OscProb::EarthModelBinned::fnLonBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBinned_8h_source.html#l00324">324</a> of file <a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00122">ClearModel()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00501">DetDistForNextLonBin()</a>, and <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>.</p>

</div>
</div>
<a id="ae40eaf3d8b666cfd4fe9242decf78121" name="ae40eaf3d8b666cfd4fe9242decf78121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae40eaf3d8b666cfd4fe9242decf78121">&#9670;&nbsp;</a></span>fNuPath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structOscProb_1_1NuPath.html">NuPath</a>&gt; OscProb::EarthModelBase::fNuPath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00074">74</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBase_8cxx_source.html#l00065">OscProb::EarthModelBase::AddPathSegment()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="PremModel_8cxx_source.html#l00347">OscProb::PremModel::FillPath()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00121">OscProb::EarthModelBase::GetMergedPaths()</a>, and <a class="el" href="EarthModelBase_8cxx_source.html#l00052">OscProb::EarthModelBase::GetNuPath()</a>.</p>

</div>
</div>
<a id="a3cbe53a328039a65b25736151dc6d586" name="a3cbe53a328039a65b25736151dc6d586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cbe53a328039a65b25736151dc6d586">&#9670;&nbsp;</a></span>fRadiusMax</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double OscProb::EarthModelBase::fRadiusMax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00076">76</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBinned_8cxx_source.html#l00666">FillPath()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00099">OscProb::EarthModelBase::GetCosT()</a>, <a class="el" href="EarthModelBase_8cxx_source.html#l00077">OscProb::EarthModelBase::GetTotalL()</a>, <a class="el" href="EarthModelBinned_8cxx_source.html#l00189">LoadModel()</a>, <a class="el" href="PremModel_8cxx_source.html#l00181">OscProb::PremModel::LoadModel()</a>, and <a class="el" href="PremModel_8cxx_source.html#l00288">OscProb::PremModel::SetTopLayerSize()</a>.</p>

</div>
</div>
<a id="a4176958be65c82a111e03c38aeadbe4e" name="a4176958be65c82a111e03c38aeadbe4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4176958be65c82a111e03c38aeadbe4e">&#9670;&nbsp;</a></span>fRemoveSmallPaths</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool OscProb::EarthModelBase::fRemoveSmallPaths</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EarthModelBase_8h_source.html#l00081">81</a> of file <a class="el" href="EarthModelBase_8h_source.html">EarthModelBase.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EarthModelBase_8cxx_source.html#l00121">OscProb::EarthModelBase::GetMergedPaths()</a>, and <a class="el" href="EarthModelBase_8cxx_source.html#l00188">OscProb::EarthModelBase::SetRemoveSmallPaths()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>inc/<a class="el" href="EarthModelBinned_8h_source.html">EarthModelBinned.h</a></li>
<li>src/<a class="el" href="EarthModelBinned_8cxx_source.html">EarthModelBinned.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceOscProb.html">OscProb</a></li><li class="navelem"><a class="el" href="classOscProb_1_1EarthModelBinned.html">EarthModelBinned</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
